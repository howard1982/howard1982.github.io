[{"title":"go mod 模塊","url":"/2020-02/go-mod/","content":"<h2 id=\"设置\"><a href=\"#设置\" class=\"headerlink\" title=\"设置\"></a>设置</h2><p>建议直接设置 GO111MODULE=”on”</p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">go</span> env -w GO111MODULE=on</span><br></pre></td></tr></table></figure>\n<p>给go mod 设置代理， 并添加私有域名</p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">go</span> env -w GOPROXY=http:<span class=\"comment\">//goproxy.cn,direct</span></span><br><span class=\"line\"><span class=\"comment\">// or</span></span><br><span class=\"line\"><span class=\"keyword\">go</span> env -w GOPROXY=https:<span class=\"comment\">//mirrors.aliyun.com/goproxy/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">go</span> env -w GOPRIVATE=*.my-abc.net</span><br></pre></td></tr></table></figure>\n<h2 id=\"新建项目\"><a href=\"#新建项目\" class=\"headerlink\" title=\"新建项目\"></a>新建项目</h2><p>新建项目，或者是已有项目转为go mod 模式的 init 建议</p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">go</span> mod init  域名/组名/项目名</span><br></pre></td></tr></table></figure>\n<p>eg： code.my-abc.net/tools/pptp</p>\n","tags":["golang"]},{"title":"单独编译 php 扩展","url":"/2020-02/php-ext/","content":"<h2 id=\"编译\"><a href=\"#编译\" class=\"headerlink\" title=\"编译\"></a>编译</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">cd ext/mbstring/</span><br><span class=\"line\">/opt/php72/bin/phpize</span><br><span class=\"line\">./configure  --enable-my_module --with-php-config=/opt/php72/bin/php-config</span><br><span class=\"line\">make</span><br><span class=\"line\">make install</span><br></pre></td></tr></table></figure>\n<ol>\n<li><code>/opt/php72</code> 是已经存在的php 安装目录。</li>\n<li>单独编译 mbstring 模块</li>\n</ol>\n<h2 id=\"配置-amp-加载\"><a href=\"#配置-amp-加载\" class=\"headerlink\" title=\"配置&amp;加载\"></a>配置&amp;加载</h2><p>在文档中 <code>/opt/php72/lib/php.ini</code> 增加一下内容<br><code>`\nextension=/opt/php72/lib/php/extensions/no-debug-non-zts-20170718/mbstring.so</code></p>\n","tags":["php"]},{"title":"检查是是否手机访问","url":"/2020-01/check-mobile/","content":"<p>这里有很多方法 <a href=\"http://detectmobilebrowsers.com/\" target=\"_blank\" rel=\"noopener\">http://detectmobilebrowsers.com/</a>  <code>php</code> <code>apache</code> <code>js</code> 都有。</p>\n"},{"title":"logrotate 日期切割","url":"/2019-12/logrotate/","content":"<p>logrotate 是个十分有用的工具，它可以自动对日志进行截断（或轮循）、压缩以及删除旧的日志文件。</p>\n<h2 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h2><p><code>/etc/logrotate.d/cwp</code> 文档</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">/usr/local/apache/domlogs/*.log &#123;</span><br><span class=\"line\">    daily</span><br><span class=\"line\">    rotate 5</span><br><span class=\"line\">    compress</span><br><span class=\"line\">    missingok</span><br><span class=\"line\">    notifempty</span><br><span class=\"line\">    minsize 20M</span><br><span class=\"line\">    create 644 nobody root</span><br><span class=\"line\">    sharedscripts</span><br><span class=\"line\">    postrotate</span><br><span class=\"line\">        if [ -f /var/run/nginx.pid ]; then</span><br><span class=\"line\">            kill -USR1 `cat /var/run/nginx.pid`</span><br><span class=\"line\">        fi</span><br><span class=\"line\">        if [ -f /usr/local/apache/logs/httpd.pid ]; then</span><br><span class=\"line\">            /usr/local/apache/bin/apachectl graceful</span><br><span class=\"line\">        fi</span><br><span class=\"line\">    endscript</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"命令\"><a href=\"#命令\" class=\"headerlink\" title=\"命令\"></a>命令</h2><ol>\n<li>检测 <code>/usr/sbin/logrotate -dv /etc/logrotate.d/cwp</code></li>\n<li>强制执行 <code>/usr/sbin/logrotate -fv /etc/logrotate.d/cwp</code></li>\n</ol>\n<h2 id=\"重启信号\"><a href=\"#重启信号\" class=\"headerlink\" title=\"重启信号\"></a>重启信号</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">kill -USR1 `cat /var/run/nginx.pid`</span><br><span class=\"line\">kill -s HUP `cat /var/run/nginx.pid`</span><br></pre></td></tr></table></figure>","tags":["linux"]},{"title":"IBM Storage Api","url":"/2019-12/IBM-Storage-Api/","content":"<p>參考 <a href=\"https://cloud.ibm.com/docs/services/cloud-object-storage/cli?topic=cloud-object-storage-aws-cli\" target=\"_blank\" rel=\"noopener\">https://cloud.ibm.com/docs/services/cloud-object-storage/cli?topic=cloud-object-storage-aws-cli</a></p>\n<h1 id=\"AWS-CLI\"><a href=\"#AWS-CLI\" class=\"headerlink\" title=\"AWS CLI\"></a>AWS CLI</h1><p>AWS 的官方命令行界面与 IBM COS S3 API 兼容。</p>\n<h2 id=\"install\"><a href=\"#install\" class=\"headerlink\" title=\"install\"></a>install</h2><p><code>pip install awscli</code></p>\n<h2 id=\"參數\"><a href=\"#參數\" class=\"headerlink\" title=\"參數\"></a>參數</h2><p><code>{Access Key ID}</code> <code>{Secret Access Key}</code> 需要創建服務憑證 例如</p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><span class=\"line\">\"cos_hmac_keys\": &#123;</span><br><span class=\"line\">    \"access_key_id\": \"xxxx\",</span><br><span class=\"line\">    \"secret_access_key\": \"ddddd\"</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>{endpoint}</code> 在 <code>存储区 》 配置</code> 中有详细的记录。 </p>\n<h2 id=\"設定\"><a href=\"#設定\" class=\"headerlink\" title=\"設定\"></a>設定</h2><p><code>~/.aws/credentials</code></p>\n<figure class=\"highlight ini\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">[default]</span></span><br><span class=\"line\"><span class=\"attr\">aws_access_key_id</span> = &#123;Access Key ID&#125;</span><br><span class=\"line\"><span class=\"attr\">aws_secret_access_key</span> = &#123;Secret Access Key&#125;</span><br></pre></td></tr></table></figure>\n<p>Crontab 下自動執行 可以使用 全局變量覆蓋</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">export AWS_ACCESS_KEY_ID=\"&#123;Access Key ID&#125;\"</span><br><span class=\"line\">export AWS_SECRET_ACCESS_KEY=\"&#123;Secret Access Key&#125;\"</span><br></pre></td></tr></table></figure>\n<h2 id=\"预签名Url\"><a href=\"#预签名Url\" class=\"headerlink\" title=\"预签名Url\"></a>预签名Url</h2><p>参考 <a href=\"https://cloud.ibm.com/docs/services/cloud-object-storage/cli?topic=cloud-object-storage-presign-url\" target=\"_blank\" rel=\"noopener\">https://cloud.ibm.com/docs/services/cloud-object-storage/cli?topic=cloud-object-storage-presign-url</a></p>\n<p>使用 awscli 命令最为快捷</p>\n"},{"title":"jQuery.noConflict()","url":"/2019-10/jQuery-noConflict/","content":"<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><span class=\"line\">&lt;script src=<span class=\"string\">\"other_lib.js\"</span>&gt;<span class=\"xml\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br><span class=\"line\">&lt;script src=<span class=\"string\">\"jquery.js\"</span>&gt;<span class=\"xml\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">    $.noConflict();</span><br><span class=\"line\">    jQuery( <span class=\"built_in\">document</span> ).ready(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"> $ </span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Code that uses jQuery's $ can follow here.</span></span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"comment\">// Code that uses other library's $ can follow here.</span></span><br><span class=\"line\">&lt;<span class=\"regexp\">/script&gt;</span></span><br></pre></td></tr></table></figure>\n","tags":["jquery"]},{"title":"incremental back 增量备份","url":"/2019-10/incremental-back/","content":"<p>以文件为最小的单位。 利用 linux 的硬链接 (Hard link) 特性（多个link不会增加磁盘，删除某个不会影响其他的）空间来实现。</p>\n<h2 id=\"基本操作\"><a href=\"#基本操作\" class=\"headerlink\" title=\"基本操作\"></a>基本操作</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">0. 根据原始内容S0, 创建最初的备份内容  V1</span><br><span class=\"line\">-- 开始增量备份 --</span><br><span class=\"line\">1. 根据 V1 创建 V2 。 规则： 创建所有目录，ln 硬链接所有文档 。</span><br><span class=\"line\">2. 通过 rsync 命令。同步S0最新的内容到 V2</span><br><span class=\"line\">-- 结束 --</span><br></pre></td></tr></table></figure>\n<h2 id=\"说明\"><a href=\"#说明\" class=\"headerlink\" title=\"说明\"></a>说明</h2><ol>\n<li>通过 <code>ls -i</code> 命令  可以查看文件的编号。 如果编号一样则表示是 硬链接。或用 <code>stat [file]</code> 命令查看更详细的信息</li>\n<li>同步命令 <code>rsync -vzrtopg --delete dir_a dir_b</code></li>\n<li>删除某个硬链接文档，不影响其他的</li>\n</ol>\n","tags":["linux"]},{"title":"cpanle smtp 25端口 outlook无法发送mail","url":"/2019-08/cpanle-outlook-25port/","content":"<h2 id=\"问题，-0x800CCC80\"><a href=\"#问题，-0x800CCC80\" class=\"headerlink\" title=\"问题， 0x800CCC80\"></a>问题， 0x800CCC80</h2><p>outlook 提示 0x800CCC80 错误。<code>您的服务器不支持此客户端支持的任何验证方式</code></p>\n<h2 id=\"解决办法\"><a href=\"#解决办法\" class=\"headerlink\" title=\"解决办法\"></a>解决办法</h2><p>登录 whm 并打开 <code>WHM &gt; Exim Configuration Manager &gt; Basic Editor &gt; Security</code></p>\n<p>设定 <code>Require clients to connect with SSL or issue the STARTTLS command before they are allowed to authenticate with the server.</code> 为 <code>off</code></p>\n","tags":["cpanel"]},{"title":"Centos7安装Python3","url":"/2019-08/Centos7-Python3/","content":"<p>Centos7 默认的是python2.7 。 通过 epel 安装python3.4</p>\n<ul>\n<li>安装 epel <code>yum install epel-release</code></li>\n<li>安装 python3.4 <code>yum install python34</code></li>\n<li>检查 <code>ll /usr/bin/python*</code></li>\n</ul>\n","tags":["linux"]},{"title":"Centos EPEL","url":"/2019-08/Centos-EPEL/","content":"<h2 id=\"什么是EPEL\"><a href=\"#什么是EPEL\" class=\"headerlink\" title=\"什么是EPEL\"></a>什么是EPEL</h2><p>EPEL的全称叫 Extra Packages for Enterprise Linux 。EPEL是由 Fedora 社区打造，为 RHEL 及衍生发行版如 CentOS、Scientific Linux 等提供高质量软件包的项目。</p>\n<p>一些软件包 例如 <code>htop</code> <code>ufw</code>等。都在这里。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">yum install epel-release -y</span><br></pre></td></tr></table></figure>\n","tags":["linux"]},{"title":"pypi","url":"/2019-08/pypi/","content":"<h2 id=\"配置-pip-ini\"><a href=\"#配置-pip-ini\" class=\"headerlink\" title=\"配置 pip.ini\"></a>配置 pip.ini</h2><ul>\n<li>linux: <code>$HOME/.pip/pip.conf</code></li>\n<li>windows: <code>%HOME%\\pip\\pip.ini</code></li>\n</ul>\n<h2 id=\"使用镜像\"><a href=\"#使用镜像\" class=\"headerlink\" title=\"使用镜像\"></a>使用镜像</h2><p>aliyun镜像</p>\n<figure class=\"highlight ini\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">[global]</span></span><br><span class=\"line\"><span class=\"attr\">index-url</span> = https://mirrors.aliyun.com/pypi/simple/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">[install]</span></span><br><span class=\"line\"><span class=\"attr\">trusted-host</span>=mirrors.aliyun.com</span><br></pre></td></tr></table></figure>\n","tags":["python","pip"]},{"title":"golang package","url":"/2019-08/golang-package/","content":"<h2 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h2><p>go import 的包是由 包路径/包名 组合而成的。</p>\n<ul>\n<li>目录名称必须和包的名称一样</li>\n<li>统一个目录下只能定义一个包名</li>\n</ul>\n<h2 id=\"import-别名\"><a href=\"#import-别名\" class=\"headerlink\" title=\"import 别名\"></a>import 别名</h2><figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    myNet3 <span class=\"string\">\"t4/net3\"</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n<h2 id=\"import-特殊\"><a href=\"#import-特殊\" class=\"headerlink\" title=\"import 特殊\"></a>import 特殊</h2><h3 id=\"点操作\"><a href=\"#点操作\" class=\"headerlink\" title=\"点操作\"></a>点操作</h3><p>. 导入可以让包内的方法注册到当前包的上下文中，直接调用方法名即可，不需要再加包前缀。</p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    . <span class=\"string\">\"t4/net3\"</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n<h3 id=\"下划线操作\"><a href=\"#下划线操作\" class=\"headerlink\" title=\"下划线操作\"></a>下划线操作</h3><p>_ 是包引用操作，只会执行包下各模块中的 init 方法，并不会真正的导入包，所以不可以调用包内的其他方法。</p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">    _ <span class=\"string\">\"t4/net3\"</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n<p>每个包中可以在任意文档中定义 init 方法。 如果定义多个，则都会加载。</p>\n"},{"title":"php-fpm 配置说明","url":"/2019-07/php-fpm/","content":"<h2 id=\"设定说明\"><a href=\"#设定说明\" class=\"headerlink\" title=\"设定说明\"></a>设定说明</h2><ul>\n<li><code>pm.max_children = 120</code> 在同一时间最大的进程数</li>\n<li><code>pm.max_requests = 500</code> 每个进程处理多少个请求之后自动终止，可以有效防止内存溢出，</li>\n<li><code>pm.process_idle_timeout = 10</code> 空闲多少秒之后进程会被kill，默认为10s</li>\n</ul>\n<h2 id=\"运行模式\"><a href=\"#运行模式\" class=\"headerlink\" title=\"运行模式\"></a>运行模式</h2><ul>\n<li><code>pm = static</code> 静态，始终保持一个固定数量的子进程，这个数由（pm.max_children）定义</li>\n<li><code>pm = dynamic</code> 动态, 启动时，会产生固定数量的子进程（由pm.start_servers控制）可以理解成最小子进程数，而最大子进程数则由pm.max_children去控制。还可设定 空闲进程 pm.min_spare_servers和pm.max_spare_servers</li>\n<li><code>pm = ondemand</code> 进程在有需求时才产生, 这种模式把内存放在第一位</li>\n</ul>\n","tags":["php"]},{"title":"mysql CPU 负载高","url":"/2019-07/mysql-cpu-top/","content":"<h2 id=\"查询现在的进程\"><a href=\"#查询现在的进程\" class=\"headerlink\" title=\"查询现在的进程\"></a>查询现在的进程</h2><p>执行命令 <code>SHOW FULL PROCESSLIST\\G;</code> 命令</p>\n<p>参数：</p>\n<ul>\n<li>Time : The time in seconds that the thread has been in its current state.</li>\n<li>Info : sql 语句</li>\n</ul>\n<h2 id=\"分析-Select\"><a href=\"#分析-Select\" class=\"headerlink\" title=\"分析 Select\"></a>分析 Select</h2><p><code>explain select * from servers;</code></p>\n<p>参数：</p>\n<ul>\n<li>Key : The index actually chosen</li>\n</ul>\n<p>参考其他 <a href=\"/2016-12/Mysql\">Mysql</a> 设置</p>\n","tags":["mysql"]},{"title":"mail 没有設定 MX 記錄","url":"/2019-07/mail-mx/","content":"<p>今天發現一個奇怪的現象 某個二級域名（mail.xxx.com） 沒有設定 mx記錄 。但是 郵箱（<a href=\"mailto:abc@mail.xxx.com\" target=\"_blank\" rel=\"noopener\">abc@mail.xxx.com</a>）還可以收信。</p>\n<p>查詢 google 得到結果：如果沒有MX記錄，則讀取A記錄對應的內容</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">RFC 5321</span><br><span class=\"line\">if no MX record is present mail servers should fall back to the A record for the domain.</span><br></pre></td></tr></table></figure>\n","tags":["dns"]},{"title":"iptables","url":"/2019-07/iptables/","content":"<h2 id=\"简单操作\"><a href=\"#简单操作\" class=\"headerlink\" title=\"简单操作\"></a>简单操作</h2><ul>\n<li>Table 表</li>\n<li>Chain 链</li>\n<li>iptables -D chain rulenum 清除某条</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">Table  Chain            num   pkts bytes target     prot opt in     out     source               destination  </span><br><span class=\"line\">filter CXS_LF_CPANEL    12       0     0 DROP       all  --  *      *       203.195.218.49       0.0.0.0/0</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 查找</span></span><br><span class=\"line\">iptables -L CXS_LF_CPANEL --line-numbers | grep xxx.xxx.xxx</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 刪除， 157就是對應的number</span></span><br><span class=\"line\">iptables -D CXS_LF_CPANEL 157</span><br></pre></td></tr></table></figure>\n<h2 id=\"cxs\"><a href=\"#cxs\" class=\"headerlink\" title=\"cxs\"></a>cxs</h2><p>如果有類似 <code>CXS_LF_SSHD</code> <code>CXS_LF_CPANEL</code> 的防火墻規則。 需要先刪除 <code>/var/lib/csf/csf.block.CXS_LF_SSHD</code> 對應的ip 然後在重啟 csf <code>csf -ra</code></p>\n<p>[參考 cxs][/2019-05/cxs/]</p>\n<h2 id=\"快速刪除\"><a href=\"#快速刪除\" class=\"headerlink\" title=\"快速刪除\"></a>快速刪除</h2><p><code>iptables -S</code>。 因爲 <code>iptables -L</code> 在規則很多的時候很慢。找到了其他參數 <code>-S, --list-rules</code> 。例如 <code>iptables -S CXS_LF_SSHD</code> CXS_LF_SSHD 是 chain 的名稱</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 查找</span></span><br><span class=\"line\">iptables -S CXS_LF_SSHD | grep 51.77.213.181</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 得到結果</span></span><br><span class=\"line\">-A CXS_LF_SSHD -s 178.62.30.249/32 -j DROP</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 刪除， 157就是對應的number</span></span><br><span class=\"line\">iptables -D CXS_LF_SSHD -s 178.62.30.249/32 -j DROP</span><br></pre></td></tr></table></figure>\n<p><code>-s 178.62.30.249/32 -j DROP</code> 是 查詢結果中的規則</p>\n","tags":["linux"]},{"title":"ajax cors 跨域访问","url":"/2019-06/ajax-cors/","content":"<h2 id=\"页面浏览器端\"><a href=\"#页面浏览器端\" class=\"headerlink\" title=\"页面浏览器端\"></a>页面浏览器端</h2><p>不用变动</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">jQuery.ajax(&#123;</span><br><span class=\"line\">    url: &apos;https://api.abc.com/static/i.php&apos;,</span><br><span class=\"line\">    type: &apos;get&apos;,</span><br><span class=\"line\">    success:function(da)&#123; console.log(da) &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h2 id=\"服务器端\"><a href=\"#服务器端\" class=\"headerlink\" title=\"服务器端\"></a>服务器端</h2><p><code>https://api.abc.com/static/i.php</code> 对应的内容需要增加 header </p>\n<figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 只允许 https 域名 name.abc.com</span></span><br><span class=\"line\">header(<span class=\"string\">'Access-Control-Allow-Origin: https://name.abc.com'</span>);</span><br><span class=\"line\">header(<span class=\"string\">'Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># or 允许所有</span></span><br><span class=\"line\">header(<span class=\"string\">'Access-Control-Allow-Origin: *'</span>);</span><br><span class=\"line\">header(<span class=\"string\">'Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept'</span>);</span><br></pre></td></tr></table></figure>","tags":["javascript","jquery","html"]},{"title":"IE 仿真版本","url":"/2019-06/ie-compatible/","content":"<p>有些旧网站IE默认(仿真)使用的是 IE7或其他。 可以通过<code>MATE</code>标签声明强制使用哪种。<br><figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">\"X-UA-Compatible\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"IE=Edge\"</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n","tags":["html"]},{"title":"jQuery 版本查看","url":"/2019-06/jquery-version/","content":"<p>查看使用中的jQuery 的版本</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><span class=\"line\">jQuery.fn.jquery</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><span class=\"line\">jQuery().jquery</span><br></pre></td></tr></table></figure>\n","tags":["jquery"]},{"title":"CXS (ConfigServer eXploit Scanner)","url":"/2019-05/cxs/","content":"<h2 id=\"命令\"><a href=\"#命令\" class=\"headerlink\" title=\"命令\"></a>命令</h2><ul>\n<li>手动检查命令 ： <code>cxs .</code></li>\n<li>排除 <code>World writeable directory</code> 信息： <code>cxs --options mMOLfSGchexdnZDRru .</code> 去掉了 <code>w</code>。</li>\n</ul>\n<p>参考：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">--options [-/+][mMOLfuSGcChexdnwWTEDZRrPUI] Exploit scan options</span><br></pre></td></tr></table></figure>\n<p>详细说明<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">m = regex pattern match</span><br><span class=\"line\">M = fingerprint match</span><br><span class=\"line\">v = virus</span><br><span class=\"line\">O = socket</span><br><span class=\"line\">L = symlink</span><br><span class=\"line\">f = suspicious file</span><br><span class=\"line\">F = skipped directory with too many entries</span><br><span class=\"line\">S = SUID file</span><br><span class=\"line\">G = GUID file</span><br><span class=\"line\">c = core dump file</span><br><span class=\"line\">C = core dump file deleted</span><br><span class=\"line\">h = suspected exploit file</span><br><span class=\"line\">e = Linux binary or executable file</span><br><span class=\"line\">x = Windows binary or executable file</span><br><span class=\"line\">d = suspicious directory name</span><br><span class=\"line\">n = hidden directory owned by nobody user</span><br><span class=\"line\">w = world writable directory</span><br><span class=\"line\">W = world writable directory - chmod to 755</span><br><span class=\"line\">T = script file - identifies PHP, Perl, and other script files as suspicious</span><br><span class=\"line\">E = email script</span><br><span class=\"line\">D = Decoded PHP encoded (e.g. base64) file scan match</span><br><span class=\"line\">R = Match the PHP decode regex</span><br><span class=\"line\">P = Search D/B config files and attempt user login via FTP. Match on success</span><br><span class=\"line\">Z = compressed file - scan within zip, tar, tar.gz and tar.bz2 files</span><br><span class=\"line\">! = Scan timeout per file B&lt;--timemax&gt;</span><br><span class=\"line\">[Zzzzzzz] = sleeping for 60 seconds as load average is &gt; --throttle [num]</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h2><p>修改 <code>/etc/cxs/cxswatch.conf</code> 文檔中的 <code>options</code> 屬性</p>\n<h2 id=\"cxs-IP-Reputation-System\"><a href=\"#cxs-IP-Reputation-System\" class=\"headerlink\" title=\"cxs IP Reputation System\"></a>cxs IP Reputation System</h2><p>編輯 <code>cxs.blocklists</code> 設定哪些需要開啟</p>\n<p>如果有類似 <code>CXS_LF_SSHD</code> <code>CXS_LF_CPANEL</code> 的防火墻規則。 需要先刪除 <code>/var/lib/csf/csf.block.CXS_LF_SSHD</code> 對應的ip 然後在重啟 csf <code>csf -ra</code></p>\n","tags":["linux","cpanel"]},{"title":"cpanel ftp over TLS","url":"/2019-05/cpanel-ftp-over-tls/","content":"<h2 id=\"狀況\"><a href=\"#狀況\" class=\"headerlink\" title=\"狀況\"></a>狀況</h2><p>cpanel 設定的 ftp over tls 總是列表失敗。</p>\n<h2 id=\"原因\"><a href=\"#原因\" class=\"headerlink\" title=\"原因\"></a>原因</h2><p>原因是 ftp 的被動模式(Passive)沒有正常運行。防火墻(csf)攔截了。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">cat /etc/pure-ftpd.conf | grep PassivePortRange</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 可以看到</span></span><br><span class=\"line\">PassivePortRange 49152 65534</span><br></pre></td></tr></table></figure>\n<h2 id=\"解決辦法\"><a href=\"#解決辦法\" class=\"headerlink\" title=\"解決辦法\"></a>解決辦法</h2><p>csf 設定文檔 的 <code>TCP_IN</code> 增加 <code>49152:65534</code>。並重啟。</p>\n","tags":["linux","cpanel"]},{"title":"Git branch 分支","url":"/2019-03/git-branch/","content":"<h2 id=\"基本命令\"><a href=\"#基本命令\" class=\"headerlink\" title=\"基本命令\"></a>基本命令</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git branch # 查看本地分支</span><br><span class=\"line\">git branch &lt;name&gt; # 創建</span><br><span class=\"line\">git checkout -b dev # 創建並切換到 dev 分支</span><br><span class=\"line\">git checkout master # 切換分支</span><br><span class=\"line\"></span><br><span class=\"line\">git branch -d dev # 刪除本地分支</span><br></pre></td></tr></table></figure>\n<h2 id=\"遠程分支\"><a href=\"#遠程分支\" class=\"headerlink\" title=\"遠程分支\"></a>遠程分支</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git remote add origin https://github.com/xxx0/xxx.git # 關聯遠程分支</span><br><span class=\"line\">git branch -a # 查看所有分支</span><br><span class=\"line\">git push origin dev # 上傳本地分支到遠程</span><br><span class=\"line\"></span><br><span class=\"line\">git push origin --delete dev # 刪除遠程分支</span><br></pre></td></tr></table></figure>\n<h2 id=\"合併分支\"><a href=\"#合併分支\" class=\"headerlink\" title=\"合併分支\"></a>合併分支</h2><p>合併 <code>dev</code> 分支 到 <code>master</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git checkout master</span><br><span class=\"line\">git merge dev</span><br></pre></td></tr></table></figure>","tags":["git"]},{"title":"systemd 简单实例","url":"/2019-02/systemd/","content":"<p>systemd systemctl</p>\n<h2 id=\"systemctl-常用命令\"><a href=\"#systemctl-常用命令\" class=\"headerlink\" title=\"systemctl 常用命令\"></a>systemctl 常用命令</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">systemctl list-unit-files # 列出所有配置文件</span><br><span class=\"line\">systemctl list-unit-files --type=service # 列表所有 service</span><br><span class=\"line\">systemctl list-unit-files | grep php # 搜索 php</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl stauts httpd</span><br><span class=\"line\">systemctl restart httpd</span><br><span class=\"line\">systemctl stop httpd</span><br><span class=\"line\">systemctl start httpd</span><br></pre></td></tr></table></figure>\n<h2 id=\"准备\"><a href=\"#准备\" class=\"headerlink\" title=\"准备\"></a>准备</h2><p>安装基本python插件</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">pip install flask</span><br><span class=\"line\">pip install gunicorn</span><br></pre></td></tr></table></figure>\n<p>创建文档 <code>/root/bin/rot13.py</code></p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Flask</span><br><span class=\"line\"></span><br><span class=\"line\">app = Flask(__name__)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@app.route(\"/\")</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hello</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"Hello World!\"</span></span><br></pre></td></tr></table></figure>\n<p>测试以上程序<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">/usr/local/bin/gunicorn -w 4 -b 127.0.0.1:8080 rot13:app</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"配置-systemd\"><a href=\"#配置-systemd\" class=\"headerlink\" title=\"配置 systemd\"></a>配置 systemd</h2><p>创建文档<code>/etc/systemd/system/rot13.service</code></p>\n<figure class=\"highlight ini\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">[Unit]</span></span><br><span class=\"line\"><span class=\"attr\">Description</span>=ROT13 demo service</span><br><span class=\"line\"><span class=\"attr\">After</span>=network.target</span><br><span class=\"line\"><span class=\"attr\">After</span>=syslog.target</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">[Service]</span></span><br><span class=\"line\"><span class=\"attr\">Restart</span>=<span class=\"literal\">on</span>-failure</span><br><span class=\"line\"><span class=\"attr\">User</span>=root</span><br><span class=\"line\"><span class=\"attr\">WorkingDirectory</span>=/root/bin</span><br><span class=\"line\"><span class=\"attr\">ExecStart</span>=/usr/local/bin/gunicorn -w <span class=\"number\">4</span> -b <span class=\"number\">0.0</span>.<span class=\"number\">0.0</span>:<span class=\"number\">8080</span> rot13:app</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">[Install]</span></span><br><span class=\"line\"><span class=\"attr\">WantedBy</span>=multi-user.target</span><br></pre></td></tr></table></figure>\n<p>启动<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">systemctl start rot13.service</span><br></pre></td></tr></table></figure></p>\n<p>开机启动<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">systemctl enable rot13.service</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"配置防火墙\"><a href=\"#配置防火墙\" class=\"headerlink\" title=\"配置防火墙\"></a>配置防火墙</h2><p>Ubuntu 为例<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo ufw allow 8080</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"https://www.cnblogs.com/zwcry/p/9602756.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/zwcry/p/9602756.html</a></p>\n","tags":["linux","python"]},{"title":"php curl 返回String 解析Json失敗","url":"/2019-02/php-curl-json/","content":"<p>通過Curl獲取String，然後<code>json_decode</code>解析，失敗。肉眼看 沒有問題。</p>\n<p>通過<code>var_dump</code>查看，發現字符串長度不對。（應該是某些特殊的字符無法無法顯示，譬如對方某個php腳本用的utf8-bom）</p>\n<p>解決辦法：</p>\n<p><code>對方</code>的程序輸出的時候， 增加 <code>ob_clean()</code>。</p>\n","tags":["php"]},{"title":"apache_rewrite","url":"/2019-01/apache-rewrite/","content":"<p>url 跳转&amp;重新指向</p>\n<p>以下都是在 二级目录 <code>~/public_html/var/</code> 做的测试。</p>\n<h1 id=\"htaccess-层级优先\"><a href=\"#htaccess-层级优先\" class=\"headerlink\" title=\".htaccess 层级优先\"></a>.htaccess 层级优先</h1><p>譬如 在地址栏中 直接输入   <code>090.net/var</code> 。<br><code>~/public_html/.htaccess</code> <code>~/public_html/var/.htaccess</code> 这2个文档都存在，则优先调用 <code>~/public_html/var/.htaccess</code>。</p>\n<h1 id=\"RewriteRule\"><a href=\"#RewriteRule\" class=\"headerlink\" title=\"RewriteRule\"></a>RewriteRule</h1><p><code>RewriteRule ^abc.php$ i.php [R=302]</code> 针对 匹配的对象是 当前对应当前目录的内容。</p>\n<p>譬如在 <code>~/public_html/var/</code>目录  访问 <code>http://090.net/var/abc.php</code> 则匹配的是 <code>abc.php</code> 这部分，不是针对整个RequestUri（<code>var/abc.php</code>）</p>\n<h1 id=\"RewriteBase\"><a href=\"#RewriteBase\" class=\"headerlink\" title=\"RewriteBase\"></a>RewriteBase</h1><p><code>RewriteBase /</code> 只针对于 <code>R</code> 跳转， 如果不跳转不用定义。</p>\n<p>譬如 <code>RewriteRule ^abc.php$ i.php [L]</code> 这种情况就不用定义。 <code>RewriteBase</code></p>\n<h2 id=\"没定义-RewriteBase\"><a href=\"#没定义-RewriteBase\" class=\"headerlink\" title=\"没定义 RewriteBase\"></a>没定义 RewriteBase</h2><p>RewriteBase 默认为当前物理目录</p>\n<p>没有 <code>RewriteBase</code> 跳转到了 <code>http://090.net/home2/net090/public_html/var/i.php</code></p>\n<h3 id=\"正确方法\"><a href=\"#正确方法\" class=\"headerlink\" title=\"正确方法\"></a>正确方法</h3><p><code>RewriteRule ^abc.php$ /var/i.php [R=302]</code></p>\n<h2 id=\"有定义-RewriteBase\"><a href=\"#有定义-RewriteBase\" class=\"headerlink\" title=\"有定义 RewriteBase\"></a>有定义 RewriteBase</h2><p>有 <code>RewriteBase /</code> 跳转到了 <code>http://090.net/i.php</code> 跳转到了根目录。因为是二级目录，所以这里 定义的 <code>RewriteBase</code> 错误了</p>\n<h3 id=\"正确方法-1\"><a href=\"#正确方法-1\" class=\"headerlink\" title=\"正确方法\"></a>正确方法</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">RewriteBase /var</span><br><span class=\"line\"></span><br><span class=\"line\">RewriteRule ^abc.php$ i.php [R=302]</span><br></pre></td></tr></table></figure>","tags":["apache"]},{"title":"Outlook 2016 设定","url":"/2018-11/outlook2016/","content":"<p>很客户使用 Outlook。所以作为维护人员，一些设定比较难找，但也得知道。</p>\n<h2 id=\"查看-amp-修改SMTP等连接属性\"><a href=\"#查看-amp-修改SMTP等连接属性\" class=\"headerlink\" title=\"查看&amp;修改SMTP等连接属性\"></a>查看&amp;修改SMTP等连接属性</h2><p>这个隐藏的太深了 :( 。操作步骤如下：</p>\n<p>文件 》 选项 》 高级 》 发送和接收 》 编辑 》 “选择某个邮箱账号” 》 账号属性 》 高级</p>\n<h2 id=\"查看-Mail-header\"><a href=\"#查看-Mail-header\" class=\"headerlink\" title=\"查看 Mail header\"></a>查看 Mail header</h2><ul>\n<li>要双击邮件，在独立的窗口打开这个邮件。</li>\n<li>文件 》 属性 》 Internet 邮件头</li>\n</ul>\n","tags":["outlook"]},{"title":"cpanel-awstats","url":"/2018-11/cpanel-awstats/","content":"<p>目的：不登錄cpanel的情況下，讓客戶可以訪問awstats。</p>\n<p>以下先說操作步驟，最後在回復原因。</p>\n<h2 id=\"步驟\"><a href=\"#步驟\" class=\"headerlink\" title=\"步驟\"></a>步驟</h2><ol>\n<li>創建子域名設定獨立目錄 c.xxx.com</li>\n<li>下載awstats-7.7.tar.gz</li>\n<li>接下wwwroot目錄下的 <code>cgi-bin</code> <code>icon</code> 目錄 到 c.xxx.com 目錄下（根據實際情況 修改<code>icon</code>名稱）</li>\n<li>複製<code>~/tmp/awstats/ssl</code>下conf文檔到<code>~/c.xxx.com/cgi-bin/</code>。</li>\n<li>登錄到cpanel 在<code>目錄隱私權</code> 對 <code>c.xxx.com</code>目錄添加訪問用賬號密碼</li>\n</ol>\n<h2 id=\"FAQ\"><a href=\"#FAQ\" class=\"headerlink\" title=\"FAQ\"></a>FAQ</h2><h3 id=\"為什麼要新建子域名\"><a href=\"#為什麼要新建子域名\" class=\"headerlink\" title=\"為什麼要新建子域名\"></a>為什麼要新建子域名</h3><p>Cpanel 手動增加http-basic認證失敗，只能利用panel 的<code>目錄隱私權</code>功能。</p>\n<h3 id=\"為什麼不用cronb程序定期讀取log文檔\"><a href=\"#為什麼不用cronb程序定期讀取log文檔\" class=\"headerlink\" title=\"為什麼不用cronb程序定期讀取log文檔\"></a>為什麼不用cronb程序定期讀取log文檔</h3><p>這裡是直接讀取的cpanel的配置文檔，cpanel自動個讀取。</p>\n<h3 id=\"為什麼讀取-tmp-awstats-ssl-而不是-tmp-awstats-下的config-文檔\"><a href=\"#為什麼讀取-tmp-awstats-ssl-而不是-tmp-awstats-下的config-文檔\" class=\"headerlink\" title=\"為什麼讀取 ~/tmp/awstats/ssl 而不是 ~/tmp/awstats/ 下的config 文檔\"></a>為什麼讀取 <code>~/tmp/awstats/ssl</code> 而不是 <code>~/tmp/awstats/</code> 下的config 文檔</h3><p>已經設定了 http 自動跳轉到https</p>\n","tags":["cpanel"]},{"title":"cpanel 發送Mail 到 hinet信箱 失敗","url":"/2018-11/cpanel-hinet-mail/","content":"<p>最近出現一個問題。 cpanel發送Mail到hinet信箱會被列入垃圾信箱。</p>\n<p>比對了其他的Mail Server發送的信件。發現 Cpanel 的mail中多了很多<br><code>X-AntiAbuse</code>開頭的Mail Header。 </p>\n<h2 id=\"解決辦法-去掉-Mail-Header\"><a href=\"#解決辦法-去掉-Mail-Header\" class=\"headerlink\" title=\"解決辦法 去掉 Mail Header\"></a>解決辦法 去掉 Mail Header</h2><ul>\n<li>編輯 <code>/etc/exim.conf</code> 。 注釋掉所有 <code>headers_add = &quot;${perl{mailtrapheaders}}&quot;</code> 。</li>\n<li>重啟exim </li>\n</ul>\n","tags":["cpanel"]},{"title":"mysql sql-mode","url":"/2018-10/mysql-sql-mode/","content":"<p>Mysql執行Sql語句時出現不兼容的問題一般情況下是 默認的 <code>sql-mode</code> 不一樣了。</p>\n<p>只要修改<code>sql-mode</code>就可以了。 </p>\n<p><code>/etc/my.cnf</code> 中增加 <code>sql-mode=&quot;NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&quot;</code></p>\n<p><a href=\"https://dev.mysql.com/doc/refman/5.7/en/server-options.html#option_mysqld_sql-mode\" target=\"_blank\" rel=\"noopener\">詳見 mysqld_sql-mode</a></p>\n","tags":["mysql"]},{"title":"cpanel 设置 DKIM","url":"/2018-10/cpanel-dkim/","content":"<p>在Cpanel中 开启 DKIM 认证。 你会得到：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">default._domainkey\t14400\tIN\tTXT\t&quot;v=DKIM1; k=rsa; p=MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuEPKF+B2vVgcYXItl03aLOXJgBmQ6V3KzG/cnA4uc7IWkHpH1F3slXpSlUtR2jTqFCEUqKKJ3/0NExrsWoncANpLBtKNpi/xX9XGSLBpN1/Ukua5iLQtcdSnApuuyxY/8wpAQYBb5oB7TRAUVxp7XrDpv7eEfMOfe8m1kMjvOX+qEqugSyJ2qxH6n6JfOs9QE&quot; rjrBupqUkIt1Y4qB9pyzog7PF4ls3JsP7F6ZfrMY+kJbFlp1NTOF7Ws199K7hwcvb8NhZP60JGDwGHq8NZJHosvIaZoECfpdSLrqoJownCum80kgjSfCRBKboZ2TvD/q41CYyTVcV/ODcaWhhjG8wIDAQAB\\;</span><br></pre></td></tr></table></figure>\n<p>如果在其他 DNS 设定txt记录。 应该是</p>\n<p><code>default._domainkey</code> 对应：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">v=DKIM1; k=rsa; p=MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuEPKF+B2vVgcYXItl03aLOXJgBmQ6V3KzG/cnA4uc7IWkHpH1F3slXpSlUtR2jTqFCEUqKKJ3/0NExrsWoncANpLBtKNpi/xX9XGSLBpN1/Ukua5iLQtcdSnApuuyxY/8wpAQYBb5oB7TRAUVxp7XrDpv7eEfMOfe8m1kMjvOX+qEqugSyJ2qxH6n6JfOs9QErjrBupqUkIt1Y4qB9pyzog7PF4ls3JsP7F6ZfrMY+kJbFlp1NTOF7Ws199K7hwcvb8NhZP60JGDwGHq8NZJHosvIaZoECfpdSLrqoJownCum80kgjSfCRBKboZ2TvD/q41CYyTVcV/ODcaWhhjG8wIDAQAB</span><br></pre></td></tr></table></figure>\n<ul>\n<li>去除开头的 <code>&quot;</code> 双引号</li>\n<li>去除中间的 <code>&quot;</code> 双引号+空格</li>\n<li>去除结尾的 <code>\\;</code> 斜线+分号</li>\n</ul>\n","tags":["cpanel","mail"]},{"title":"mysql sql 語句","url":"/2018-10/mysql-sql/","content":"<h2 id=\"distinct-去除重複\"><a href=\"#distinct-去除重複\" class=\"headerlink\" title=\"distinct 去除重複\"></a>distinct 去除重複</h2><figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"keyword\">distinct</span> email <span class=\"keyword\">from</span> <span class=\"keyword\">member</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"HAVING-語句\"><a href=\"#HAVING-語句\" class=\"headerlink\" title=\"HAVING 語句\"></a>HAVING 語句</h2><p>配合 <code>GROUP BY</code> 使用。在<code>WHERE</code>語句執行完，把資料讀入內存后，再次過濾。</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> m.email, <span class=\"keyword\">COUNT</span>(m.email) <span class=\"keyword\">AS</span> cc <span class=\"keyword\">FROM</span> <span class=\"keyword\">member</span> <span class=\"keyword\">AS</span> m <span class=\"keyword\">WHERE</span> m.age &gt; <span class=\"number\">10</span> <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> m.email</span><br><span class=\"line\"><span class=\"keyword\">HAVING</span> cc &gt; <span class=\"number\">1</span></span><br></pre></td></tr></table></figure>\n<p>以上SQL可看為2步驟</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* 第一步 過濾數據并讀取到內容，并計算 count */</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> m.email, <span class=\"keyword\">COUNT</span>(m.email) <span class=\"keyword\">AS</span> cc <span class=\"keyword\">FROM</span> <span class=\"keyword\">member</span> <span class=\"keyword\">AS</span> m <span class=\"keyword\">WHERE</span> m.age &gt; <span class=\"number\">10</span> <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> m.email</span><br><span class=\"line\"><span class=\"comment\">/* 第二步 在以上結果的基礎上進行過濾*/</span></span><br><span class=\"line\"><span class=\"keyword\">HAVING</span> cc &gt; <span class=\"number\">1</span></span><br></pre></td></tr></table></figure>","tags":["mysql","sql"]},{"title":"apache log 日志回滚","url":"/2018-10/apache-log/","content":"<p>防止 apache log过大。 注： 該方法 必須要額外寫<code>定期刪除</code>文檔功能。推薦使用 系統 <code>logrotate</code> 功能。</p>\n<h2 id=\"安装-rotatelogs\"><a href=\"#安装-rotatelogs\" class=\"headerlink\" title=\"安装 rotatelogs\"></a>安装 rotatelogs</h2><p>如果 /usr/local/apache/bin/rotatelogs 不存在则安装。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> centos 7</span></span><br><span class=\"line\">yum install httpd-tools</span><br></pre></td></tr></table></figure>\n<h2 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">#ErrorLog &quot;logs/error_log&quot;</span><br><span class=\"line\">ErrorLog &quot;| /usr/local/apache/bin/rotatelogs logs/%Y_%m_%d_error_log 86400 480&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">#CustomLog &quot;logs/access_log&quot; common</span><br><span class=\"line\">CustomLog &quot;| /usr/local/apache/bin/rotatelogs logs/%Y_%m_%d_access_log 86400 480&quot; common</span><br></pre></td></tr></table></figure>\n<p><code>86400 480</code> 是指 每个文档先知86400秒（24小时）。480 单位是分钟，时间偏移8小时（对应时区）。</p>\n<p>注： 必須要額外寫<code>定期刪除</code>文檔功能</p>\n","tags":["linux","apache"]},{"title":"du 命令","url":"/2018-10/du/","content":"<p>查看目录站磁盘空间大小</p>\n<h2 id=\"例子\"><a href=\"#例子\" class=\"headerlink\" title=\"例子\"></a>例子</h2><p>查看某个目录下各个子目录所使用的空间。可以用在逐层查看磁盘空间。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">du -hd 1</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> or</span></span><br><span class=\"line\">du -h  --max-depth=1 ./</span><br></pre></td></tr></table></figure>\n<ul>\n<li>-h 显示K M G 为单位</li>\n<li>–max-depth=1 只查询一层</li>\n</ul>\n","tags":["linux"]},{"title":"xargs 命令","url":"/2018-10/xargs/","content":"<p>xargs可以将输入内容（通常通过命令行管道传递），转成后续命令的参数</p>\n<ul>\n<li>命令组合：尤其是一些命令不支持管道输入，比如<code>ls</code></li>\n<li>避免参数过长：<code>xargs</code>可以通过<code>-nx</code>来将参数分组，避免参数过长</li>\n</ul>\n<h2 id=\"例子\"><a href=\"#例子\" class=\"headerlink\" title=\"例子\"></a>例子</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">ls *.php | xargs -t -n3 ls -al</span><br></pre></td></tr></table></figure>\n<ul>\n<li>-t 在执行后面的命令前，先将命令打印出来</li>\n<li>nx 参数分组</li>\n</ul>\n<p>结果：<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">ls -al acc.php advhtml_new.php advhtml.php</span><br><span class=\"line\">-r-------- 1 dn dn   20 Jan  1  2018 acc.php</span><br><span class=\"line\">-r-------- 1 dn dn 1579 Jan  1  2018 advhtml_new.php</span><br><span class=\"line\">-r-------- 1 dn dn 1579 Jan  1  2018 advhtml.php</span><br><span class=\"line\">ls -al authimg.php bodyheader.php check_domain.php</span><br><span class=\"line\">-r-------- 1 dn dn   369 Jan  2  2018 authimg.php</span><br><span class=\"line\">-r-------- 1 dn dn 10970 Jan  2  2018 bodyheader.php</span><br><span class=\"line\">-r-------- 1 dn dn  7545 Jan  2  2018 check_domain.php</span><br><span class=\"line\">ls -al cooperate.php domain_click_counter.php emaildefense.php</span><br><span class=\"line\">-r-------- 1 dn dn 3342 Jan  2  2018 cooperate.php</span><br><span class=\"line\">-r-------- 1 dn dn  501 Jan  2  2018 domain_click_counter.php</span><br><span class=\"line\">-r-------- 1 dn dn 3674 Jan  2  2018 emaildefense.php</span><br><span class=\"line\">ls -al extend_domain.php feedback.php hc.php</span><br><span class=\"line\">-r-------- 1 dn dn 1062 Jan  2  2018 extend_domain.php</span><br><span class=\"line\">-r-------- 1 dn dn 1095 Jan  2  2018 feedback.php</span><br><span class=\"line\">-r-------- 1 dn dn 6348 Jan  2  2018 hc.php</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"替换\"><a href=\"#替换\" class=\"headerlink\" title=\"替换\"></a>替换</h2><p><code>-I &#39;{}&#39;</code>表示将后面命令行的<code>{}</code>替换成前面解析出来的参数。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">ls *.js | xargs -t -I '&#123;&#125;'  mv &#123;&#125; &#123;&#125;.backup</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 测试</span></span><br><span class=\"line\">ls *.js | xargs -t -I '&#123;&#125;' ls -al &#123;&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"特殊文件名\"><a href=\"#特殊文件名\" class=\"headerlink\" title=\"特殊文件名\"></a>特殊文件名</h2><p>有的时候，文件名可能存在特殊字符，比如文件名中存在空格。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">find . -name &apos;*.css&apos; -print0 | xargs -0 -t ls -al</span><br></pre></td></tr></table></figure>\n<ul>\n<li>-print0：告诉find命令，在输出文件名之后，跟上NULL字符，而不是换行符；</li>\n<li>-0：告诉xargs，以NULL作为参数分隔符；</li>\n</ul>\n","tags":["linux"]},{"title":"获取 centos ip","url":"/2018-10/get-centos-ip/","content":"<p>shell 脚本。获取当前server IP。 适用Centos6、Centos7 、Ubuntu</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\">ip=`/sbin/ifconfig eth0 | grep 'inet addr:' | cut -d: -f2 | awk '&#123; print $1&#125;'`</span><br><span class=\"line\">if [ \"$ip\" = \"\" ];then</span><br><span class=\"line\">    ip=`/sbin/ifconfig eth0 | grep 'inet ' | awk '&#123;print $2&#125;'`</span><br><span class=\"line\">fi</span><br><span class=\"line\">echo $re</span><br></pre></td></tr></table></figure>","tags":["linux"]},{"title":"python venv 创建虚拟环境","url":"/2018-10/python-venv/","content":"<p>python3.3 以後自帶 venv 虚拟环境</p>\n<h1 id=\"创建虚拟环境\"><a href=\"#创建虚拟环境\" class=\"headerlink\" title=\"创建虚拟环境\"></a>创建虚拟环境</h1><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">python -m venv venv</span><br></pre></td></tr></table></figure>\n<h1 id=\"激活虚拟环境\"><a href=\"#激活虚拟环境\" class=\"headerlink\" title=\"激活虚拟环境\"></a>激活虚拟环境</h1><ul>\n<li>linux  <code>source &lt;venv&gt;/bin/activate</code></li>\n<li>windows cmd <code>&lt;venv&gt;/Scripts/activate.bat</code></li>\n<li>windows powershell <code>&lt;venv&gt;/Scripts/Activate.ps1</code></li>\n</ul>\n<p>注： 在cmder+powershell環境下，會出現錯誤提示。忽略掉即可。</p>\n<h1 id=\"测试虚拟环境\"><a href=\"#测试虚拟环境\" class=\"headerlink\" title=\"测试虚拟环境\"></a>测试虚拟环境</h1><p>激活以後，就可以直接使用 <code>python</code> 或 <code>pip</code> </p>\n","tags":["python"]},{"title":"hexo 部署","url":"/2018-09/hexo-deploy/","content":"<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><p>部署到 github 需要安装 hexo-deployer-git</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>\n<h2 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h2><p>修改 _config.yml 文档</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">deploy:</span><br><span class=\"line\">  type: git</span><br><span class=\"line\">  repo: https://github.com/howard1982/howard1982.github.io.git</span><br><span class=\"line\">  branch: master</span><br></pre></td></tr></table></figure>\n<h2 id=\"取消输入账号密码\"><a href=\"#取消输入账号密码\" class=\"headerlink\" title=\"取消输入账号密码\"></a>取消输入账号密码</h2><p>需要改为 ssh 登录方式<br>同时要把 public_key 上传到github</p>\n<h3 id=\"配置-ssh\"><a href=\"#配置-ssh\" class=\"headerlink\" title=\"配置 ssh\"></a>配置 ssh</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">Host github.com</span><br><span class=\"line\">    HostName github.com</span><br><span class=\"line\">    User git</span><br><span class=\"line\">    IdentityFile ~/.ssh/howard_rsa</span><br><span class=\"line\">    IdentitiesOnly yes</span><br></pre></td></tr></table></figure>\n<p>测试</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">ssh -T git@github.com</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"comment\"># 或者</span></span></span><br><span class=\"line\">ssh -vT git@github.com</span><br></pre></td></tr></table></figure>\n<h3 id=\"配置-hexo\"><a href=\"#配置-hexo\" class=\"headerlink\" title=\"配置 hexo\"></a>配置 hexo</h3><p>修改 _config.yml 文档</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">deploy:</span><br><span class=\"line\">  type: git</span><br><span class=\"line\">  repo: git@github.com:howard1982/howard1982.github.io.git</span><br><span class=\"line\">  branch: master</span><br></pre></td></tr></table></figure>\n<h2 id=\"执行\"><a href=\"#执行\" class=\"headerlink\" title=\"执行\"></a>执行</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">hexo deploy</span><br><span class=\"line\"># or</span><br><span class=\"line\">hexo d</span><br></pre></td></tr></table></figure>\n<p>有時候必須先生成新的文檔，然後在發佈</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">hexo g</span><br><span class=\"line\">hexo d</span><br></pre></td></tr></table></figure>","tags":["ssh","hexo"]},{"title":"php http","url":"/2018-09/php-http/","content":"<p>参考 <a href=\"https://recca0120.github.io/2017/04/03/PHP-Psr7-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/\" target=\"_blank\" rel=\"noopener\">PHP-Psr7-使用方法</a></p>\n<p>使用 php-http 组件</p>\n<h2 id=\"说明\"><a href=\"#说明\" class=\"headerlink\" title=\"说明\"></a>说明</h2><p>在 PHP 有眾多的 Http Client 套件，每個使用方法都不一致</p>\n<p>像是我們最常使用的 GuzzleHttp 它從5版及升到6版</p>\n<p>結果連API都不一致，這確實造成了很大的困擾</p>\n<p>所以 PHP-FIG 就提出了 PSR-7 來定義 HTTP message interfaces，並由 httplug.io 實作它</p>\n<p>之後我們這可以利用 PSR-7 的標準來使用 cURL, Socket, Buzz, Guzzle5, Guzzle6, React，相關Adapter</p>\n<h2 id=\"install\"><a href=\"#install\" class=\"headerlink\" title=\"install\"></a>install</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 安裝 psr-7</span></span><br><span class=\"line\">composer require guzzlehttp/psr7 php-http/message</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 安裝所需的 adapter （示範 GuzzleHttp 6）</span></span><br><span class=\"line\">composer require php-http/guzzle6-adapter</span><br></pre></td></tr></table></figure>\n<h2 id=\"GET\"><a href=\"#GET\" class=\"headerlink\" title=\"GET\"></a>GET</h2><figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Http</span>\\<span class=\"title\">Adapter</span>\\<span class=\"title\">Guzzle6</span>\\<span class=\"title\">Client</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Http</span>\\<span class=\"title\">Message</span>\\<span class=\"title\">MessageFactory</span>\\<span class=\"title\">GuzzleMessageFactory</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">require</span> <span class=\"keyword\">__DIR__</span>.<span class=\"string\">'/vendor/autoload.php'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">$client = <span class=\"keyword\">new</span> Client();</span><br><span class=\"line\">$messageFactory = <span class=\"keyword\">new</span> GuzzleMessageFactory();</span><br><span class=\"line\">$request = $messageFactory-&gt;createRequest(<span class=\"string\">'GET'</span>, <span class=\"string\">'https://name.080.net/domain/faq'</span>);</span><br><span class=\"line\">$response = $client-&gt;sendRequest($request);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> $response-&gt;getBody()-&gt;getContents();</span><br></pre></td></tr></table></figure>\n<h2 id=\"POST-JSON\"><a href=\"#POST-JSON\" class=\"headerlink\" title=\"POST JSON\"></a>POST JSON</h2><p>替换 $request 变量</p>\n<figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">$request = $messageFactory-&gt;createRequest(<span class=\"string\">'POST'</span>,</span><br><span class=\"line\">    <span class=\"string\">'https://name.080.net/domain/one_off/ss/json'</span>,</span><br><span class=\"line\">    [<span class=\"string\">'Content-Type: application/json'</span>,<span class=\"string\">'Accept: application/json'</span>],</span><br><span class=\"line\">    json_encode([<span class=\"string\">'a1'</span>=&gt;<span class=\"string\">'22'</span>,<span class=\"string\">'sfe'</span>=&gt;<span class=\"string\">'fff'</span>])</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure>\n<h2 id=\"不使用Curl\"><a href=\"#不使用Curl\" class=\"headerlink\" title=\"不使用Curl\"></a>不使用Curl</h2><p>替换 $client 变量</p>\n<figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">$handler = <span class=\"keyword\">new</span> GuzzleHttp\\Handler\\StreamHandler;</span><br><span class=\"line\">$client = <span class=\"keyword\">new</span> GuzzleHttp\\Client([<span class=\"string\">'handler'</span> =&gt; $handler]);</span><br><span class=\"line\"></span><br><span class=\"line\">$client = <span class=\"keyword\">new</span> Client($client);</span><br></pre></td></tr></table></figure>\n<h2 id=\"Code\"><a href=\"#Code\" class=\"headerlink\" title=\"Code\"></a>Code</h2><figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">require</span> <span class=\"string\">\"vendor/autoload.php\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Http</span>\\<span class=\"title\">Adapter</span>\\<span class=\"title\">Guzzle6</span>\\<span class=\"title\">Client</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Http</span>\\<span class=\"title\">Message</span>\\<span class=\"title\">MessageFactory</span>\\<span class=\"title\">GuzzleMessageFactory</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">$handler = <span class=\"keyword\">new</span> GuzzleHttp\\Handler\\StreamHandler;</span><br><span class=\"line\">$client = <span class=\"keyword\">new</span> GuzzleHttp\\Client([<span class=\"string\">'handler'</span> =&gt; $handler]);</span><br><span class=\"line\"></span><br><span class=\"line\">$client = <span class=\"keyword\">new</span> Client($client);</span><br><span class=\"line\">$messageFactory = <span class=\"keyword\">new</span> GuzzleMessageFactory();</span><br><span class=\"line\"></span><br><span class=\"line\">$request = $messageFactory-&gt;createRequest(<span class=\"string\">'POST'</span>,</span><br><span class=\"line\">    <span class=\"string\">'https://name.080.net/domain/one_off/ss/json'</span>,</span><br><span class=\"line\">    [<span class=\"string\">'Content-Type: application/json'</span>,<span class=\"string\">'Accept: application/json'</span>],</span><br><span class=\"line\">    json_encode([<span class=\"string\">'a1'</span>=&gt;<span class=\"string\">'22'</span>,<span class=\"string\">'sfe'</span>=&gt;<span class=\"string\">'fff'</span>])</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\">$response = $client-&gt;sendRequest($request);</span><br><span class=\"line\"></span><br><span class=\"line\">$ss =  $response-&gt;getBody()-&gt;getContents();</span><br></pre></td></tr></table></figure>","tags":["php","http"]},{"title":"http header","url":"/2018-09/http-header/","content":"<h2 id=\"請求\"><a href=\"#請求\" class=\"headerlink\" title=\"請求\"></a>請求</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">POST /path HTTP/1.1</span><br><span class=\"line\">Host: example.com</span><br><span class=\"line\"></span><br><span class=\"line\">foo=bar&amp;baz=bat</span><br></pre></td></tr></table></figure>\n<h2 id=\"相應\"><a href=\"#相應\" class=\"headerlink\" title=\"相應\"></a>相應</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">HTTP/1.1 200 OK</span><br><span class=\"line\">Content-Type: text/plain</span><br><span class=\"line\"></span><br><span class=\"line\">这是返回的消息内容</span><br></pre></td></tr></table></figure>\n<h2 id=\"其他參考\"><a href=\"#其他參考\" class=\"headerlink\" title=\"其他參考\"></a>其他參考</h2><p><a href=\"./2016-12/php-curl/\">PHP curl</a></p>\n"},{"title":"socket","url":"/2018-09/socket/","content":"<p>TCP/IP是个协议组，可分为四个层次：网络接口层、网络层、传输层和应用层。</p>\n<ol>\n<li>网络接口层 –</li>\n<li>网络层 – IP协议、ICMP协议、ARP协议、RARP协议和BOOTP协议</li>\n<li>传输层 – TCP协议与UDP协议</li>\n<li>应用层 – HTTP,FTP、TELNET、SMTP、DNS等协议</li>\n</ol>\n<h2 id=\"socket\"><a href=\"#socket\" class=\"headerlink\" title=\"socket\"></a>socket</h2><p>socket只是一种连接模式，不是协议，socket是对TCP/IP协议的封装，Socket本身并不是协议，而是一个调用接口（API），</p>\n","tags":["tcp","socket"]},{"title":"php://input","url":"/2018-08/php-input/","content":"<p><code>php://input</code> 用來接收數據。</p>\n<h2 id=\"form-表單\"><a href=\"#form-表單\" class=\"headerlink\" title=\"form 表單\"></a>form 表單</h2><p>一般情況下html form 表單提交的類型是 <code>application/x-www-form-urlencoded</code> 或者 <code>multipart/form-data</code>。用 <code>$_POST</code>就能直接獲取。</p>\n<h2 id=\"JSON\"><a href=\"#JSON\" class=\"headerlink\" title=\"JSON\"></a>JSON</h2><p>如果對方發送的數據是 <code>application/json</code></p>\n<figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">$data = file_get_contents(<span class=\"string\">'php://input'</span>);</span><br><span class=\"line\">$data = json_decode($data, <span class=\"keyword\">true</span>);</span><br></pre></td></tr></table></figure>\n<h2 id=\"php-發送JSON數據\"><a href=\"#php-發送JSON數據\" class=\"headerlink\" title=\"php 發送JSON數據\"></a>php 發送JSON數據</h2><p>參見 <a href=\"./2016-12/php-curl/\">PHP curl</a></p>\n","tags":["php"]},{"title":"google cloud 管理","url":"/2018-08/gcp/","content":"<h2 id=\"ssh-登錄\"><a href=\"#ssh-登錄\" class=\"headerlink\" title=\"ssh 登錄\"></a>ssh 登錄</h2><p>必須手動執行 不能用config配置， 奇怪~</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">ssh howard@104.199.168.248</span><br></pre></td></tr></table></figure>","tags":["google","gcp"]},{"title":"跳轉到 https","url":"/2018-08/goto-https/","content":"<p>修改 .htaccess 文件</p>\n<h2 id=\"跳轉到-www-域名\"><a href=\"#跳轉到-www-域名\" class=\"headerlink\" title=\"跳轉到 www 域名\"></a>跳轉到 www 域名</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">RewriteCond %&#123;HTTP_HOST&#125; !^www\\. [NC]</span><br><span class=\"line\">RewriteCond %&#123;REQUEST_URI&#125; !(\\.well\\-known) # 排除url</span><br><span class=\"line\">RewriteRule ^(.*)$ http://www.%&#123;HTTP_HOST&#125;/$1 [R=301,L]</span><br></pre></td></tr></table></figure>\n<h2 id=\"HTTPS-跳轉\"><a href=\"#HTTPS-跳轉\" class=\"headerlink\" title=\"HTTPS 跳轉\"></a>HTTPS 跳轉</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">RewriteCond %&#123;HTTPS&#125; off</span><br><span class=\"line\">RewriteRule ^(.*)$ https://%&#123;SERVER_NAME&#125;%&#123;REQUEST_URI&#125; [L,R=301]</span><br></pre></td></tr></table></figure>\n<p>不含某個url，例如不包含 payback 的url</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">RewriteCond %&#123;HTTPS&#125; off</span><br><span class=\"line\">RewriteCond %&#123;REQUEST_URI&#125; !(payback)</span><br><span class=\"line\">RewriteRule ^(.*)$ https://%&#123;SERVER_NAME&#125;%&#123;REQUEST_URI&#125; [L,R=301]</span><br></pre></td></tr></table></figure>","tags":["apache"]},{"title":"正則表達式","url":"/2018-07/regexp/","content":"<h2 id=\"密碼\"><a href=\"#密碼\" class=\"headerlink\" title=\"密碼\"></a>密碼</h2><p>必須含有數字，小寫字母、大寫字母</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><span class=\"line\">/^(?=.*[<span class=\"number\">0</span><span class=\"number\">-9</span>])(?=.*[a-z])(?=.*[A-Z])[<span class=\"number\">0</span><span class=\"number\">-9</span>a-zA-Z]&#123;<span class=\"number\">6</span>,&#125;$/</span><br></pre></td></tr></table></figure>\n"},{"title":"Python 常用模塊","url":"/2018-07/python-module/","content":"<h2 id=\"簡介\"><a href=\"#簡介\" class=\"headerlink\" title=\"簡介\"></a>簡介</h2><h3 id=\"模块\"><a href=\"#模块\" class=\"headerlink\" title=\"模块\"></a>模块</h3><p>模块，在Python可理解为对应于一个文件。例如有个 a1.py 文档 (如果不在包中)可以截止 <code>import a1</code> 来加载这个文档，并调用里面的函数</p>\n<h2 id=\"包\"><a href=\"#包\" class=\"headerlink\" title=\"包\"></a>包</h2><p>是一个包含<code>__init__.py</code>文件的目录，该目录下一定得有这个<code>__init__.py</code>文件和其它模块或子包。</p>\n<h2 id=\"调用\"><a href=\"#调用\" class=\"headerlink\" title=\"调用\"></a>调用</h2><ul>\n<li><code>import subpackage1.a</code> # 将模块subpackage.a导入全局命名空间，例如访问a中属性时用 <code>subpackage1.a.attr</code></li>\n<li><code>from subpackage1 import a</code> #　将模块a导入全局命名空间，例如访问a中属性时用a.attr_a</li>\n<li><code>from subpackage.a import attr_a</code> # 将模块a的属性直接导入到命名空间中，例如访问a中属性时直接用attr_a</li>\n</ul>\n<h2 id=\"常用模塊\"><a href=\"#常用模塊\" class=\"headerlink\" title=\"常用模塊\"></a>常用模塊</h2><h3 id=\"cryptography\"><a href=\"#cryptography\" class=\"headerlink\" title=\"cryptography\"></a>cryptography</h3><p>加密 Openssl 相關模塊， 用于 csr crt 等ssl相关</p>\n<h3 id=\"hashlib\"><a href=\"#hashlib\" class=\"headerlink\" title=\"hashlib\"></a>hashlib</h3><p>md5 \\ sha1 \\ sha256 等加密</p>\n","tags":["python"]},{"title":"php 操作 ssl","url":"/2018-07/php-openssl/","content":"<h2 id=\"生成csr-以及-private-key\"><a href=\"#生成csr-以及-private-key\" class=\"headerlink\" title=\"生成csr 以及 private key\"></a>生成csr 以及 private key</h2><figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">$dn = <span class=\"keyword\">array</span>(</span><br><span class=\"line\">    <span class=\"string\">\"countryName\"</span> =&gt; <span class=\"string\">\"TW\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"stateOrProvinceName\"</span> =&gt; <span class=\"string\">\"Taipei\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"organizationName\"</span> =&gt; <span class=\"string\">\"瑋德國際股份有限公司\"</span>, <span class=\"comment\">// 公司名稱</span></span><br><span class=\"line\">    <span class=\"string\">\"organizationalUnitName\"</span> =&gt; <span class=\"string\">\"資訊部\"</span>, <span class=\"comment\">// 部門</span></span><br><span class=\"line\">    <span class=\"string\">\"commonName\"</span> =&gt; <span class=\"string\">\"nealsyardremedies.com.tw\"</span>, <span class=\"comment\">// domain</span></span><br><span class=\"line\">    <span class=\"string\">\"emailAddress\"</span> =&gt; <span class=\"string\">\"itsupport@10over10.com.tw\"</span>,</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">// Generate a new private (and public) key pair</span></span><br><span class=\"line\">$privkey = openssl_pkey_new(<span class=\"keyword\">array</span>(</span><br><span class=\"line\">    <span class=\"string\">\"private_key_bits\"</span> =&gt; <span class=\"number\">2048</span>,</span><br><span class=\"line\">    <span class=\"string\">\"private_key_type\"</span> =&gt; OPENSSL_KEYTYPE_RSA,</span><br><span class=\"line\">));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Generate a certificate signing request</span></span><br><span class=\"line\">$csr = openssl_csr_new($dn, $privkey, <span class=\"keyword\">array</span>(<span class=\"string\">'digest_alg'</span> =&gt; <span class=\"string\">'sha512'</span>));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// openssl_csr_export($csr, $csrout) and var_dump($csrout);</span></span><br><span class=\"line\"><span class=\"comment\">// openssl_pkey_export($privkey, $pkeyout) and var_dump($pkeyout);</span></span><br><span class=\"line\"></span><br><span class=\"line\">openssl_csr_export_to_file($csr, <span class=\"string\">'nealsyardremedies_com_tw.csr'</span>);  <span class=\"comment\">// 保存到文檔</span></span><br><span class=\"line\">openssl_pkey_export_to_file($privkey, <span class=\"string\">'nealsyardremedies_com_tw.key'</span>);</span><br></pre></td></tr></table></figure>\n<h2 id=\"讀取-csr\"><a href=\"#讀取-csr\" class=\"headerlink\" title=\"讀取 csr\"></a>讀取 csr</h2><figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">header(<span class=\"string\">\"Content-Type: text/html; charset=UTF-8\"</span>);</span><br><span class=\"line\">$str = <span class=\"string\">'-----BEGIN CERTIFICATE REQUEST-----</span></span><br><span class=\"line\"><span class=\"string\">MIIC7jCCAdYCAQAwgagxCzAJBgNVBAYTAlRXMQ8wDQYDVQQIDAZUYWlwZWkxJzAl</span></span><br><span class=\"line\"><span class=\"string\">BgNVBAoMHueRi+W+t+Wci+mam+iCoeS7veaciemZkOWFrOWPuDESMBAGA1UECwwJ</span></span><br><span class=\"line\"><span class=\"string\">6LOH6KiK6YOoMSEwHwYDVQQDDBhuZWFsc3lhcmRyZW1lZGllcy5jb20udHcxKDAm</span></span><br><span class=\"line\"><span class=\"string\">BgkqhkiG9w0BCQEWGWl0c3VwcG9ydEAxMG92ZXIxMC5jb20udHcwggEiMA0GCSqG</span></span><br><span class=\"line\"><span class=\"string\">SIb3DQEBAQUAA4IBDwAwggEKAoIBAQDFYutxHda/r8O/fGwBjVTs3Kl97HROeFs9</span></span><br><span class=\"line\"><span class=\"string\">dhMXLvmaHrwU/DuHY9f+Wj94K0kZhFe21QtVC0DL9jgNrYTJ8Is7mVbVKmiN8sYH</span></span><br><span class=\"line\"><span class=\"string\">UwGeEqqHAXdJ/m/0f7aGlWjxd6myZzOIXmsf3SYwKwGKwowIMxSAP1jryOoFresp</span></span><br><span class=\"line\"><span class=\"string\">tk0BDMDavsJLhcdvUd3oximaMOvyOvWZN5uj2kYh7YYpTVAQZn3dJDb0B5kIl2dG</span></span><br><span class=\"line\"><span class=\"string\">GvpTKWgAw3oH8Ak9zMZT9y0/sAmjsxkPil6jgbRz6d40V9xgCixofpwYGnEF5hRO</span></span><br><span class=\"line\"><span class=\"string\">O1VhLZIcVDC0NaeyM8Tfgv/ODvU/xlHKfz3CbKG1KxXRXFeIAxbDAgMBAAGgADAN</span></span><br><span class=\"line\"><span class=\"string\">BgkqhkiG9w0BAQ0FAAOCAQEAMZOSVoZWQhvZ/g+cnSHmrxzK9JCUeKoD0wlFuiww</span></span><br><span class=\"line\"><span class=\"string\">KRmHaYFuZcStTj/52M65zXhtx6OXFjsoMJSf4OyGTYjfexH7Zqv2zfBuKQBuPSL7</span></span><br><span class=\"line\"><span class=\"string\">GfLy9zcNLabuSYlbfQ1PNvycXb4ZhJJ2TI62XGXnfg5zeW4tHN0Mvt+/UxWkNmVu</span></span><br><span class=\"line\"><span class=\"string\">CTGTdbd3bgjnnggJQZI6Z7AKsaeeqF5zgtkws+lwZoG3BbcXPWxoxI+Ms3JhxXzg</span></span><br><span class=\"line\"><span class=\"string\">Mx0Z1INiQM7rhvA5tB3HG+VsBcTya08QA4HASjHOTesInZvgUM2QbQqxAKldiJex</span></span><br><span class=\"line\"><span class=\"string\">ho4OnmOUhCPWiUoDTq2y7FvfjFwMzst06EkYsYj2Zw/oQQ==</span></span><br><span class=\"line\"><span class=\"string\">-----END CERTIFICATE REQUEST-----'</span>;</span><br><span class=\"line\">var_dump(openssl_csr_get_subject($str));</span><br></pre></td></tr></table></figure>\n<h2 id=\"ssl\"><a href=\"#ssl\" class=\"headerlink\" title=\"ssl\"></a>ssl</h2><p>普通的csr crt private-key 都好理解。</p>\n<h3 id=\"chain\"><a href=\"#chain\" class=\"headerlink\" title=\"chain\"></a>chain</h3><p>.chain 则对应的是 crt 中 Issuer 的 ssl证书（crt）</p>\n<h3 id=\"CA-amp-ca-bundle\"><a href=\"#CA-amp-ca-bundle\" class=\"headerlink\" title=\"CA &amp; ca-bundle\"></a>CA &amp; ca-bundle</h3><p>CA - 证书颁发机构英文简称为CA，负责签发、作废和保存证书，CA签发的证书称为CA证书</p>\n<p>abc-com.ca-bundle 是一組 CA证书。本质上也是一种crt (CERTIFICATE)。</p>\n<p>.ca-bundle 中有多个 crt (CERTIFICATE) 是逐层对应 Issuer 的 ssl证书（crt）。 </p>\n<p>第一个内容和 .chain 一样</p>\n","tags":["php","openssl"]},{"title":"Monolog","url":"/2018-06/monolog/","content":"<p>Monolog 注册为系统Error错误管理</p>\n<figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Monolog</span>\\<span class=\"title\">Logger</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Monolog</span>\\<span class=\"title\">Handler</span>\\<span class=\"title\">StreamHandler</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Monolog</span>\\<span class=\"title\">ErrorHandler</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Monolog</span>\\<span class=\"title\">Formatter</span>\\<span class=\"title\">LineFormatter</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">$handler = <span class=\"keyword\">new</span> StreamHandler(VARPATH.<span class=\"string\">'/log/'</span>.date(<span class=\"string\">\"Ym\"</span>).<span class=\"string\">'.log'</span>, Logger::WARNING);</span><br><span class=\"line\"></span><br><span class=\"line\">$lineFormatter = <span class=\"keyword\">new</span> LineFormatter();</span><br><span class=\"line\">$lineFormatter-&gt; includeStacktraces(); <span class=\"comment\">// 记录错误并追溯 debug_backtrace</span></span><br><span class=\"line\">$handler-&gt;setFormatter($lineFormatter);</span><br><span class=\"line\"></span><br><span class=\"line\">$logger = <span class=\"keyword\">new</span> Logger(<span class=\"string\">'system'</span>);</span><br><span class=\"line\">$logger-&gt;pushHandler($handler);</span><br><span class=\"line\"></span><br><span class=\"line\">ErrorHandler::register($logger); <span class=\"comment\">// 注册为系统Error管理</span></span><br></pre></td></tr></table></figure>","tags":["php"]},{"title":"安装Python3","url":"/2018-06/install-python/","content":"<ul>\n<li>WEB用PHP</li>\n<li>其他用Python</li>\n<li>特殊情况用Go</li>\n</ul>\n<h2 id=\"安装-Python3\"><a href=\"#安装-Python3\" class=\"headerlink\" title=\"安装 Python3\"></a>安装 Python3</h2><ul>\n<li>尽量用 yum 或 apt 利用现有资料安装python3</li>\n<li>其次在用编译的方式安装</li>\n</ul>\n<h3 id=\"Centos-安装-python3\"><a href=\"#Centos-安装-python3\" class=\"headerlink\" title=\"Centos 安装 python3\"></a>Centos 安装 python3</h3><ul>\n<li><code>yum install epel-release</code></li>\n<li><code>yum serach python3</code></li>\n<li><code>yum install python3</code></li>\n</ul>\n<h3 id=\"Ubuntu\"><a href=\"#Ubuntu\" class=\"headerlink\" title=\"Ubuntu\"></a>Ubuntu</h3><p>Ubunut 16 以后默认自带Python3 可以直接使用 <code>/usr/bin/python3</code></p>\n","tags":["linux","python"]},{"title":"PHP PDO 操作","url":"/2018-05/php-pdo/","content":"<h2 id=\"連接\"><a href=\"#連接\" class=\"headerlink\" title=\"連接\"></a>連接</h2><figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">$dbh = <span class=\"keyword\">new</span> PDO(<span class=\"string\">'mysql:dbname=db;host=localhost'</span>, <span class=\"string\">'root'</span>, <span class=\"string\">'password'</span>);</span><br></pre></td></tr></table></figure>\n<p>or</p>\n<figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">$dsn = <span class=\"string\">'mysql:dbname=db;host=localhost'</span>;</span><br><span class=\"line\">$user = <span class=\"string\">'root'</span>;</span><br><span class=\"line\">$password = <span class=\"string\">'password'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    $dbh = <span class=\"keyword\">new</span> PDO($dsn, $user, $password);</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (PDOException $e) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">'Connection failed: '</span> . $e-&gt;getMessage();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"设定只显示-key\"><a href=\"#设定只显示-key\" class=\"headerlink\" title=\"设定只显示 key\"></a>设定只显示 key</h2><figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">$dbh-&gt;setAttribute(PDO::ATTR_DEFAULT_FETCH_MODE, PDO::FETCH_ASSOC);</span><br></pre></td></tr></table></figure>\n<h2 id=\"query-和-prepare-区别\"><a href=\"#query-和-prepare-区别\" class=\"headerlink\" title=\"query 和 prepare 区别\"></a>query 和 prepare 区别</h2><figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">$sth = $dbh-&gt;query($sql);</span><br><span class=\"line\"><span class=\"comment\"># 等同于</span></span><br><span class=\"line\">$sth = $dbh-&gt;prepare($sql);</span><br><span class=\"line\">$sth-&gt;execute();</span><br></pre></td></tr></table></figure>\n<h2 id=\"获取结果\"><a href=\"#获取结果\" class=\"headerlink\" title=\"获取结果\"></a>获取结果</h2><figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span>($row = $sth-&gt;fetch()) &#123;</span><br><span class=\"line\">    print_r($row);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\"># or</span></span><br><span class=\"line\"><span class=\"keyword\">foreach</span>($sth-&gt;fetchAll() <span class=\"keyword\">as</span> $row) &#123;</span><br><span class=\"line\">    print_r($row);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"PDOStatement-execute\"><a href=\"#PDOStatement-execute\" class=\"headerlink\" title=\"PDOStatement::execute\"></a>PDOStatement::execute</h2><figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">$sth = $dbh-&gt;prepare(<span class=\"string\">\"update icrm_contact set email2 = ? where id = ?\"</span>);</span><br><span class=\"line\">$sth-&gt;execute(<span class=\"keyword\">array</span>($email, $id));</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">$sth = $dbh-&gt;prepare(<span class=\"string\">\"update icrm_contact set email2 = ? where id = ?\"</span>);</span><br><span class=\"line\">$sth-&gt;bindValue(<span class=\"number\">1</span>, <span class=\"string\">'howard@080.net'</span>);</span><br><span class=\"line\">$sth-&gt;bindValue(<span class=\"number\">2</span>, <span class=\"string\">'1'</span>);</span><br><span class=\"line\">$sth-&gt;execute();</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">$sth = $dbh-&gt;prepare(<span class=\"string\">\"update icrm_contact set email2 = :email where id = :id\"</span>);</span><br><span class=\"line\">$sth-&gt;bindValue(<span class=\"string\">':email'</span>, <span class=\"string\">'howard@080.net'</span>);</span><br><span class=\"line\">$sth-&gt;bindValue(<span class=\"string\">':id'</span>, <span class=\"string\">'1'</span>);</span><br><span class=\"line\">$sth-&gt;execute();</span><br></pre></td></tr></table></figure>\n<h2 id=\"PDOStatement-bindValue\"><a href=\"#PDOStatement-bindValue\" class=\"headerlink\" title=\"PDOStatement::bindValue\"></a>PDOStatement::bindValue</h2><p>把一个值绑定到一个参数， 例如 把 <a href=\"mailto:`howard@080.net\" target=\"_blank\" rel=\"noopener\">`howard@080.net</a><code>綁定到</code>:email`</p>\n<h2 id=\"PDOStatement-bindParam\"><a href=\"#PDOStatement-bindParam\" class=\"headerlink\" title=\"PDOStatement::bindParam\"></a>PDOStatement::bindParam</h2><p>绑定一个参数到指定的变量名，例如 把 <code>$email</code> 這個變量 綁定到 <code>:email</code>。<br>當保存多個的時候 直接修改 <code>$email</code> 對應的值。然後執行<code>$sth-&gt;execute()</code> 就可以了。</p>\n","tags":["php"]},{"title":"Openssl","url":"/2018-05/openssl/","content":"<h2 id=\"解析CRT文檔\"><a href=\"#解析CRT文檔\" class=\"headerlink\" title=\"解析CRT文檔\"></a>解析CRT文檔</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">openssl x509 -in my.cert -noout -text</span><br></pre></td></tr></table></figure>\n<h2 id=\"解析CSR文檔\"><a href=\"#解析CSR文檔\" class=\"headerlink\" title=\"解析CSR文檔\"></a>解析CSR文檔</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">openssl req -in mycsr.csr -noout -text</span><br></pre></td></tr></table></figure>\n<h2 id=\"檢查CSR、-Private-Key、-CRT-是否匹配\"><a href=\"#檢查CSR、-Private-Key、-CRT-是否匹配\" class=\"headerlink\" title=\"檢查CSR、 Private Key、 CRT 是否匹配\"></a>檢查CSR、 Private Key、 CRT 是否匹配</h2><p>通過命令查看 sha256 數值是否一致</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">openssl pkey -in example.key -pubout -outform pem | sha256sum</span><br><span class=\"line\">openssl x509 -in example.crt -pubkey -noout -outform pem | sha256sum</span><br><span class=\"line\">openssl req -in example.csr -pubkey -noout -outform pem | sha256sum</span><br></pre></td></tr></table></figure>\n<h2 id=\"生成-IIS-pfx-文檔\"><a href=\"#生成-IIS-pfx-文檔\" class=\"headerlink\" title=\"生成 IIS pfx 文檔\"></a>生成 IIS pfx 文檔</h2><p>以下命令 生成文檔 <code>iis.pfx</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">/usr/bin/openssl pkcs12 -export -out \"iis.pfx\" -in \"cert.pem\" -inkey \"private.pem\"  -certfile \"chain.pem\" -password pass:123456</span><br></pre></td></tr></table></figure>\n<h2 id=\"解析-IIS-pfx-文檔\"><a href=\"#解析-IIS-pfx-文檔\" class=\"headerlink\" title=\"解析 IIS pfx 文檔\"></a>解析 IIS pfx 文檔</h2><p>會詢問輸入密碼。</p>\n<p>一下命令 生成 <code>ex.pem</code>。 這個文檔裡面包含 <code>cert.pem</code> <code>chain.pem</code> <code>private.pem</code> 內容</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">openssl pkcs12 -in iis.pfx -out ex.pem -nodes</span><br></pre></td></tr></table></figure>\n<h2 id=\"生成-private-key-和-csr\"><a href=\"#生成-private-key-和-csr\" class=\"headerlink\" title=\"生成 private key 和 csr\"></a>生成 private key 和 csr</h2><h3 id=\"生成-private-key\"><a href=\"#生成-private-key\" class=\"headerlink\" title=\"生成 private key\"></a>生成 private key</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">openssl genrsa -out private_key.pem 2048</span><br></pre></td></tr></table></figure>\n<h3 id=\"生成-csr\"><a href=\"#生成-csr\" class=\"headerlink\" title=\"生成 csr\"></a>生成 csr</h3><p>根据生成的 private_key 生成 csr </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\"># openssl req -new -key private_key.pem -out req1.csr</span><br><span class=\"line\">You are about to be asked to enter information that will be incorporated</span><br><span class=\"line\">into your certificate request.</span><br><span class=\"line\">What you are about to enter is what is called a Distinguished Name or a DN.</span><br><span class=\"line\">There are quite a few fields but you can leave some blank</span><br><span class=\"line\">For some fields there will be a default value,</span><br><span class=\"line\">If you enter &apos;.&apos;, the field will be left blank.</span><br><span class=\"line\">-----</span><br><span class=\"line\">Country Name (2 letter code) [XX]:CN</span><br><span class=\"line\">State or Province Name (full name) []:.</span><br><span class=\"line\">Locality Name (eg, city) [Default City]:.</span><br><span class=\"line\">Organization Name (eg, company) [Default Company Ltd]:.</span><br><span class=\"line\">Organizational Unit Name (eg, section) []:.</span><br><span class=\"line\">Common Name (eg, your name or your server&apos;s hostname) []:www.abc.com</span><br><span class=\"line\">Email Address []:</span><br><span class=\"line\"> </span><br><span class=\"line\">Please enter the following &apos;extra&apos; attributes    # 下面两项几乎不用考虑，留空即可</span><br><span class=\"line\">to be sent with your certificate request</span><br><span class=\"line\">A challenge password []:.</span><br><span class=\"line\">An optional company name []:.</span><br></pre></td></tr></table></figure>\n","tags":["linux"]},{"title":"Cmder","url":"/2018-05/cmder/","content":"<p>使用PowerShell  </p>\n<p>安裝相關模塊</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">Install-Module -Name 'posh-git'</span><br><span class=\"line\">Install-Module -Name 'Get-ChildItemColor'</span><br></pre></td></tr></table></figure>\n<p>修改 <code>D:\\Program Files\\cmder\\config\\user-profile.ps1</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">Import-Module Get-ChildItemColor</span><br><span class=\"line\"></span><br><span class=\"line\">Set-Alias l Get-ChildItemColor -Option AllScope</span><br><span class=\"line\">Set-Alias ls Get-ChildItemColorFormatWide -Option AllScope</span><br><span class=\"line\">Set-Alias ll Get-ChildItemColor -Option AllScope</span><br><span class=\"line\">Set-Alias dns Resolve-DnsName</span><br><span class=\"line\"></span><br><span class=\"line\">Set-Alias md5sum &quot;C:\\Program Files\\Git\\usr\\bin\\md5sum.exe&quot;</span><br><span class=\"line\">Set-Alias gzip &quot;C:\\Program Files\\Git\\usr\\bin\\gzip.exe&quot;</span><br><span class=\"line\">Set-Alias bzip2 &quot;C:\\Program Files\\Git\\usr\\bin\\bzip2.exe&quot;</span><br><span class=\"line\">Set-Alias sha1sum &quot;C:\\Program Files\\Git\\usr\\bin\\sha1sum.exe&quot;</span><br><span class=\"line\">Set-Alias sha256sum &quot;C:\\Program Files\\Git\\usr\\bin\\sha256sum.exe&quot;</span><br><span class=\"line\">Set-Alias sha512sum &quot;C:\\Program Files\\Git\\usr\\bin\\sha512sum.exe&quot;</span><br><span class=\"line\">Set-Alias vim &quot;C:\\Program Files\\Git\\usr\\bin\\vim.exe&quot;</span><br><span class=\"line\">Set-Alias vscode &quot;C:\\Program Files\\Microsoft VS Code\\Code.exe&quot;</span><br></pre></td></tr></table></figure>","tags":["cmder"]},{"title":"Javascript 模块,知识点","url":"/2018-04/javascript/","content":"<h2 id=\"Lodash\"><a href=\"#Lodash\" class=\"headerlink\" title=\"Lodash\"></a>Lodash</h2><p>是一个一致性、模块化、高性能的 JavaScript 实用工具库。</p>\n<h2 id=\"Promise\"><a href=\"#Promise\" class=\"headerlink\" title=\"Promise\"></a>Promise</h2><p>Promise是专门为解决 js中回调而引起的各种问题，而产生的。</p>\n","tags":["javascript"]},{"title":"centos-webpanel","url":"/2018-02/centos-webpanel/","content":"<h2 id=\"auto-ssl-自动更新问题\"><a href=\"#auto-ssl-自动更新问题\" class=\"headerlink\" title=\"auto ssl 自动更新问题\"></a>auto ssl 自动更新问题</h2><p>取消掉多余的 apache 对应的https加载文档</p>\n","tags":["linux"]},{"title":"'vim'","url":"/2018-01/vim/","content":"<h2 id=\"显示行数\"><a href=\"#显示行数\" class=\"headerlink\" title=\"显示行数\"></a>显示行数</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">set nu</span><br></pre></td></tr></table></figure>\n<p>跳转到第4行<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">:4</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"搜索\"><a href=\"#搜索\" class=\"headerlink\" title=\"搜索\"></a>搜索</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">/super </span><br><span class=\"line\">?super</span><br></pre></td></tr></table></figure>\n<ul>\n<li>n 上一个的匹配</li>\n<li>N 下一个的匹配</li>\n</ul>\n","tags":["linux","vim"]},{"title":"php session 生命週期","url":"/2017-12/php-session/","content":"<p>需要注意的是2個數值</p>\n<ul>\n<li>session.gc_maxlifetime 指定过了多少秒之后数据就会被视为“垃圾”并被清除。</li>\n<li>session.cookie_lifetime 以秒数指定了发送到浏览器的 cookie 的生命周期。值为 0 表示“直到关闭浏览器”。</li>\n</ul>\n","tags":["php"]},{"title":"php 錯誤處理","url":"/2017-12/php-error/","content":"<h2 id=\"打印錯誤\"><a href=\"#打印錯誤\" class=\"headerlink\" title=\"打印錯誤\"></a>打印錯誤</h2><p>直接在頁面輸出錯誤報告</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">display_errors = On</span><br><span class=\"line\">error_reporting = E_ALL &amp; ~E_DEPRECATED</span><br></pre></td></tr></table></figure>\n<ul>\n<li>display_errors 是否打開顯示錯誤報告</li>\n<li>error_reporting 輸出錯誤等級</li>\n</ul>\n<h2 id=\"保存錯誤\"><a href=\"#保存錯誤\" class=\"headerlink\" title=\"保存錯誤\"></a>保存錯誤</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">log_errors = On</span><br><span class=\"line\">log_errors_max_len = 1024</span><br><span class=\"line\">error_log = error_log</span><br></pre></td></tr></table></figure>\n<ul>\n<li>log_errors 是否存儲</li>\n<li>log_errors_max_len 每個錯誤報告長度， 0 表示錯誤報告所有內容</li>\n<li>error_log 錯誤報告的位置， <code>error_log</code> 表示執行文檔的目錄下。 也可以是絕對路徑。例如 <code>/var/log/php_error_log</code></li>\n</ul>\n","tags":["php"]},{"title":"sar 常用命令 & 查看系統流量","url":"/2017-12/sar/","content":"<p><code>sar -n DEV  2 4</code></p>\n<p>显示网络接口信息 命令后面2 4 意思是：每2秒钟取1次值，取4次。</p>\n<ul>\n<li>IFACE：LAN接口</li>\n<li>rxpck/s:每秒钟收到数据包的数量.</li>\n<li>txpck/s:每秒钟发送数据包的数量.</li>\n<li>rxkB/s:每秒钟接收的字节(KB).</li>\n<li>txkB/s:每秒钟发送的字节(KB).</li>\n<li>rxcmp/s:每秒收到的压缩包的数量</li>\n<li>txcmp/s:每秒发出的压缩包的数量</li>\n<li>rxmcst/s:每秒收到的广播包的数量</li>\n</ul>\n<h2 id=\"常用命令\"><a href=\"#常用命令\" class=\"headerlink\" title=\"常用命令\"></a>常用命令</h2><ul>\n<li>sar 5 5  //  CPU和IOWAIT统计状态 </li>\n<li>sar -p 1 3 // cpu 狀態</li>\n<li>sar -n DEV 2 4  // 網絡</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">默认监控: sar 5 5     //  CPU和IOWAIT统计状态 </span><br><span class=\"line\">(1) sar -b 5 5        // IO传送速率</span><br><span class=\"line\">(2) sar -B 5 5        // 页交换速率</span><br><span class=\"line\">(3) sar -c 5 5        // 进程创建的速率</span><br><span class=\"line\">(4) sar -d 5 5        // 块设备的活跃信息</span><br><span class=\"line\">(5) sar -n DEV 5 5    // 网路设备的状态信息</span><br><span class=\"line\">(6) sar -n SOCK 5 5   // SOCK的使用情况</span><br><span class=\"line\">(7) sar -n ALL 5 5    // 所有的网络状态信息</span><br><span class=\"line\">(8) sar -P ALL 5 5    // 每颗CPU的使用状态信息和IOWAIT统计状态 </span><br><span class=\"line\">(9) sar -q 5 5        // 队列的长度（等待运行的进程数）和负载的状态</span><br><span class=\"line\">(10) sar -r 5 5       // 内存和swap空间使用情况</span><br><span class=\"line\">(11) sar -R 5 5       // 内存的统计信息（内存页的分配和释放、系统每秒作为BUFFER使用内存页、每秒被cache到的内存页）</span><br><span class=\"line\">(12) sar -u 5 5       // CPU的使用情况和IOWAIT信息（同默认监控）</span><br><span class=\"line\">(13) sar -v 5 5       // inode, file and other kernel tablesd的状态信息</span><br><span class=\"line\">(14) sar -w 5 5       // 每秒上下文交换的数目</span><br><span class=\"line\">(15) sar -W 5 5       // SWAP交换的统计信息(监控状态同iostat 的si so)</span><br><span class=\"line\">(16) sar -x 2906 5 5  // 显示指定进程(2906)的统计信息，信息包括：进程造成的错误、用户级和系统级用户CPU的占用情况、运行在哪颗CPU上</span><br><span class=\"line\">(17) sar -y 5 5       // TTY设备的活动状态</span><br><span class=\"line\">(18) 将输出到文件(-o)和读取记录信息(-f)</span><br></pre></td></tr></table></figure>","tags":["linux"]},{"title":"查看 linux 版本","url":"/2017-11/linux-issue/","content":"<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">cat /etc/issue</span><br><span class=\"line\">or</span><br><span class=\"line\">cat /etc/redhat-release</span><br></pre></td></tr></table></figure>\n<p><code>uname -a</code> 只能查看內核版本</p>\n","tags":["linux"]},{"title":"ufw 防火墙管理工具","url":"/2017-10/ufw/","content":"<p>ufw是一个主机端的iptables类防火墙配置工具</p>\n<h2 id=\"一般使用\"><a href=\"#一般使用\" class=\"headerlink\" title=\"一般使用\"></a>一般使用</h2><ul>\n<li>启用 <code>ufw enable</code></li>\n<li>关闭 <code>ufw disable</code></li>\n<li>查看防火墙状态 <code>fw status</code></li>\n</ul>\n<h2 id=\"开启-禁用相应端口或服务举例\"><a href=\"#开启-禁用相应端口或服务举例\" class=\"headerlink\" title=\"开启/禁用相应端口或服务举例\"></a>开启/禁用相应端口或服务举例</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">ufw allow 80 #允许外部访问80端口</span><br><span class=\"line\">ufw delete allow 80 #禁止外部访问80 端口</span><br><span class=\"line\">ufw allow from 192.168.1.1 #允许此IP访问所有的本机端口</span><br></pre></td></tr></table></figure>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><p>安装完成后记得 启动 <code>ufw enable</code>。 查看是否运行 <code>ufw status</code></p>\n<h3 id=\"Ubuntu\"><a href=\"#Ubuntu\" class=\"headerlink\" title=\"Ubuntu\"></a>Ubuntu</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo apt install ufw</span><br></pre></td></tr></table></figure>\n<h3 id=\"Centos\"><a href=\"#Centos\" class=\"headerlink\" title=\"Centos\"></a>Centos</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">yum install epel-release -y</span><br><span class=\"line\">yum install --enablerepo=\"epel\" ufw -y</span><br></pre></td></tr></table></figure>\n","tags":["ubuntu"]},{"title":"Flask","url":"/2017-10/flask-run/","content":"<h2 id=\"Flask\"><a href=\"#Flask\" class=\"headerlink\" title=\"Flask\"></a>Flask</h2><p>Python Web 框架</p>\n<h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">pip install flask</span><br></pre></td></tr></table></figure>\n<h3 id=\"创建文档\"><a href=\"#创建文档\" class=\"headerlink\" title=\"创建文档\"></a>创建文档</h3><p>创建 h1.py</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Flask</span><br><span class=\"line\"></span><br><span class=\"line\">app = Flask(__name__)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@app.route(\"/\")</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hello</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"Hello World!\"</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"Gunicorn\"><a href=\"#Gunicorn\" class=\"headerlink\" title=\"Gunicorn\"></a>Gunicorn</h2><p>作为一个HTTP Server</p>\n<h3 id=\"安装-1\"><a href=\"#安装-1\" class=\"headerlink\" title=\"安装\"></a>安装</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">pip install gunicorn</span><br></pre></td></tr></table></figure>\n<h3 id=\"运行\"><a href=\"#运行\" class=\"headerlink\" title=\"运行\"></a>运行</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">gunicorn -w 4 -b 127.0.0.1:8080 h1:app</span><br></pre></td></tr></table></figure>\n<ul>\n<li>h1 是文檔名稱</li>\n<li>app 是Flask實例</li>\n</ul>\n<h3 id=\"開機啟動\"><a href=\"#開機啟動\" class=\"headerlink\" title=\"開機啟動\"></a>開機啟動</h3><p>安裝 supervisor</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">apt-get install supervisor</span><br></pre></td></tr></table></figure>\n<p>創建<code>/etc/supervisor/conf.d/h1.conf</code>文檔（ubuntu）</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">[program:h1]</span><br><span class=\"line\">command=gunicorn -w 4 -b 0.0.0.0:8080 h1:app</span><br><span class=\"line\">directory=/root/bin</span><br><span class=\"line\">user=root</span><br><span class=\"line\">autostart=true</span><br><span class=\"line\">autorestart=true</span><br><span class=\"line\">redirect_stderr=true</span><br></pre></td></tr></table></figure>\n<p>注意 ip 0.0.0.0 對應所有ip。</p>\n<h4 id=\"简单的启动\"><a href=\"#简单的启动\" class=\"headerlink\" title=\"简单的启动\"></a>简单的启动</h4><p>修改 <code>/etc/rc.local</code> 文档</p>\n<p><code>nohup gunicorn -w 4 -b 0.0.0.0:8080 /root/bin/h1:app &amp;</code></p>\n","tags":["python","flask"]},{"title":"dompdf","url":"/2017-09/18-dompdf/","content":"<h2 id=\"安裝\"><a href=\"#安裝\" class=\"headerlink\" title=\"安裝\"></a>安裝</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">composer require dompdf/dompdf</span><br></pre></td></tr></table></figure>\n<h2 id=\"添加字體\"><a href=\"#添加字體\" class=\"headerlink\" title=\"添加字體\"></a>添加字體</h2><ul>\n<li>下載 load_font.php <a href=\"https://github.com/dompdf/utils\" target=\"_blank\" rel=\"noopener\">https://github.com/dompdf/utils</a></li>\n<li>複製到 ~\\vendor\\dompdf\\dompdf 目錄</li>\n<li>複製 php-font-lib 到 ~\\vendor\\dompdf\\dompdf\\lib (在 ~\\vendor\\phenx 目錄下)</li>\n</ul>\n<p>執行以下程序<br><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">php load_font.php \"Firefly Sung\" ./fireflysung.ttf</span><br></pre></td></tr></table></figure></p>\n","tags":["php","dompdf"]},{"title":"Python","url":"/2017-09/python/","content":"<h2 id=\"Import-VS-Import-from\"><a href=\"#Import-VS-Import-from\" class=\"headerlink\" title=\"Import VS Import..from\"></a>Import VS Import..from</h2><ul>\n<li><code>import subpackage1.a</code> # 将模块subpackage.a导入全局命名空间，例如访问a中属性时用 <code>subpackage1.a.attr</code></li>\n<li><code>from subpackage1 import a</code> #　将模块a导入全局命名空间，例如访问a中属性时用a.attr_a</li>\n<li><code>from subpackage.a import attr_a</code> # 将模块a的属性直接导入到命名空间中，例如访问a中属性时直接用attr_a</li>\n</ul>\n<h2 id=\"資料庫數據修改\"><a href=\"#資料庫數據修改\" class=\"headerlink\" title=\"資料庫數據修改\"></a>資料庫數據修改</h2><p>不手動該執行 commit 真個程序執行完才會更新到資料庫</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">conn = mysql.connector.connect(host=<span class=\"string\">'localhost'</span>,user=<span class=\"string\">'dn'</span>, password=<span class=\"string\">'xxx'</span>, database=<span class=\"string\">'dn'</span>,charset=<span class=\"string\">'utf8'</span>)</span><br><span class=\"line\">cursor = conn.cursor()</span><br><span class=\"line\"></span><br><span class=\"line\">update_sql = <span class=\"string\">\"update one_off_domain set has_ssl = %s where id = %s\"</span></span><br><span class=\"line\">cursor.execute(update_sql, (<span class=\"number\">-1</span>, id))</span><br><span class=\"line\">conn.commit()</span><br><span class=\"line\"></span><br><span class=\"line\">conn.close()</span><br></pre></td></tr></table></figure>\n<h2 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h2><p>文档测试或者执行</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    <span class=\"keyword\">print</span> __name__</span><br></pre></td></tr></table></figure>","tags":["python"]},{"title":"Postfix 配置","url":"/2017-09/postfix/","content":"<h2 id=\"基本配置\"><a href=\"#基本配置\" class=\"headerlink\" title=\"基本配置\"></a>基本配置</h2><p><code>vim /etc/postfix/main.cf</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">myhostname: smtp1.m2.com.tw #  设置系统的主机名</span><br><span class=\"line\"></span><br><span class=\"line\">mydomain: m2.com.tw # 设置域名（我们将让此处设置将成为E-mail地址“@”后面的部分）</span><br><span class=\"line\"></span><br><span class=\"line\">myorigin: $mydomain # 将发信地址“@”后面的部分设置为域名（非系统主机名）</span><br><span class=\"line\"></span><br><span class=\"line\">inet_interfaces: all # 接受来自所有网络的请求</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 指定发给本地邮件的域名</span></span><br><span class=\"line\">mydestination: $myhostname, localhost.$mydomain, localhost, $mydomain</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">mynetworks: 192.168.1.0/24, 127.0.0.0/8 #設定網路, 例如</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">home_mailbox:Maildir/ # 改成 Maildir風格 但是這種沒辦法用mail命令讀取</span><br></pre></td></tr></table></figure>\n<h3 id=\"更新-aliases\"><a href=\"#更新-aliases\" class=\"headerlink\" title=\"更新 aliases\"></a>更新 aliases</h3><p>重新指向 例如<br>jojo 的邮箱转寄到 root<br>root 转移到 <a href=\"mailto:howard@080.net\" target=\"_blank\" rel=\"noopener\">howard@080.net</a></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">vi /etc/aliases</span><br><span class=\"line\">newaliases</span><br></pre></td></tr></table></figure>\n<h2 id=\"log\"><a href=\"#log\" class=\"headerlink\" title=\"log\"></a>log</h2><p>log位置是：/var/log/maillog</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 查看一些注意內容</span></span><br><span class=\"line\">egrep '(reject|warning|error|fatal|panic):' /var/log/maillog</span><br><span class=\"line\">tail -f /var/log/maillog |grep -e \"Pass|LOGIN\"</span><br></pre></td></tr></table></figure>\n<h2 id=\"常用命令\"><a href=\"#常用命令\" class=\"headerlink\" title=\"常用命令\"></a>常用命令</h2><h3 id=\"查看邮件队列\"><a href=\"#查看邮件队列\" class=\"headerlink\" title=\"查看邮件队列\"></a>查看邮件队列</h3><ul>\n<li>mailq </li>\n<li>postqueue -p <figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">如果队列序号加了*号表示为活动队列</span><br><span class=\"line\">如果队列序号加了!号表示为延期队列</span><br><span class=\"line\">如果队列序号没有*与!号表示为等待队列</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"查看內容\"><a href=\"#查看內容\" class=\"headerlink\" title=\"查看內容\"></a>查看內容</h3><ul>\n<li>postcat -q DBA3F1A9</li>\n</ul>\n<h3 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h3><ul>\n<li>postsuper -d DBA3F1A9删除队列里的邮件</li>\n<li>postsuper -d ALL删除队列里所有的邮件</li>\n<li>postsuper -r ALL重新排队所有邮件</li>\n</ul>\n<h2 id=\"重啟\"><a href=\"#重啟\" class=\"headerlink\" title=\"重啟\"></a>重啟</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">systemctl restart  postfix.service</span><br></pre></td></tr></table></figure>\n<h2 id=\"telnet-測試\"><a href=\"#telnet-測試\" class=\"headerlink\" title=\"telnet 測試\"></a>telnet 測試</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">telnet m2.com.tw 25</span><br><span class=\"line\">ehlo m2.com.tw</span><br><span class=\"line\">mail from: root@m2.com.tw</span><br><span class=\"line\">rcpt to: root@m2.com.tw</span><br><span class=\"line\">data</span><br><span class=\"line\">Subject: My first mail on Postfix</span><br><span class=\"line\">Hi,</span><br><span class=\"line\">Are you there?</span><br><span class=\"line\">regards,</span><br><span class=\"line\">Admin</span><br><span class=\"line\">. (Type the .[dot] in a new Line and press Enter )</span><br><span class=\"line\">quit</span><br></pre></td></tr></table></figure>\n<h2 id=\"阅读\"><a href=\"#阅读\" class=\"headerlink\" title=\"阅读\"></a>阅读</h2><p><code>mail</code> 或 <code>mutt</code> 命令可以读取 /var/mail/root中的邮件内容。 </p>\n<p>推荐 <code>mutt</code></p>\n","tags":["linux","mail server"]},{"title":"golang 嵌入式资料库","url":"/2017-07/golang-database/","content":"<p>可以参考： </p>\n<ul>\n<li><a href=\"https://golanglibs.com/top?q=embedded+database\" target=\"_blank\" rel=\"noopener\">https://golanglibs.com/top?q=embedded+database</a></li>\n<li><a href=\"https://golanglibs.com/category/databases?sort=top\" target=\"_blank\" rel=\"noopener\">https://golanglibs.com/category/databases?sort=top</a></li>\n</ul>\n<h2 id=\"bolt\"><a href=\"#bolt\" class=\"headerlink\" title=\"bolt\"></a>bolt</h2><p><a href=\"https://github.com/boltdb/bolt\" target=\"_blank\" rel=\"noopener\">https://github.com/boltdb/bolt</a></p>\n","tags":["golang","database"]},{"title":"Postgres pgsql","url":"/2017-07/postgres/","content":"<h2 id=\"基本设定\"><a href=\"#基本设定\" class=\"headerlink\" title=\"基本设定\"></a>基本设定</h2><p><code>passwd postgres</code></p>\n<p>执行 <code>psql</code><br><figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">USER</span> postgres <span class=\"keyword\">WITH</span> <span class=\"keyword\">PASSWORD</span> <span class=\"string\">'16******pg'</span>;</span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">user</span> <span class=\"string\">\"whois_user\"</span> <span class=\"keyword\">with</span> <span class=\"keyword\">password</span> <span class=\"string\">'16******wh'</span> nocreatedb;</span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">database</span> <span class=\"string\">\"whois_db\"</span> <span class=\"keyword\">with</span> owner = <span class=\"string\">\"whois_user\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> employees (<span class=\"keyword\">id</span> <span class=\"built_in\">int</span>, first_name <span class=\"built_in\">varchar</span>, last_name <span class=\"built_in\">varchar</span>);</span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> employees <span class=\"keyword\">VALUES</span> (<span class=\"number\">1</span>, <span class=\"string\">'John'</span>, <span class=\"string\">'Doe'</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> employees;</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"psql-下一些命令\"><a href=\"#psql-下一些命令\" class=\"headerlink\" title=\"psql 下一些命令\"></a>psql 下一些命令</h2><ul>\n<li>\\l 查询所有数据库</li>\n<li>\\c 切換数据库</li>\n<li>\\d 查詢表</li>\n<li>\\q</li>\n</ul>\n<h2 id=\"其他操作\"><a href=\"#其他操作\" class=\"headerlink\" title=\"其他操作\"></a>其他操作</h2><h3 id=\"更改所有者\"><a href=\"#更改所有者\" class=\"headerlink\" title=\"更改所有者\"></a>更改所有者</h3><p><code>ALTER TABLE employees OWNER TO  whois_user</code></p>\n<h3 id=\"資料庫大小\"><a href=\"#資料庫大小\" class=\"headerlink\" title=\"資料庫大小\"></a>資料庫大小</h3><p><code>select pg_size_pretty(pg_database_size(&#39;whois_db&#39;));</code></p>\n<h3 id=\"表大小\"><a href=\"#表大小\" class=\"headerlink\" title=\"表大小\"></a>表大小</h3><p><code>select pg_size_pretty(pg_relation_size(&#39;employees&#39;));</code></p>\n<h2 id=\"配置远端连接\"><a href=\"#配置远端连接\" class=\"headerlink\" title=\"配置远端连接\"></a>配置远端连接</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">vi /etc/postgresql/9.5/main/postgresql.conf</span><br><span class=\"line\">---</span><br><span class=\"line\">#listen_addresses = &apos;localhost&apos;</span><br><span class=\"line\">listen_addresses = &apos;*&apos;</span><br><span class=\"line\"></span><br><span class=\"line\">vi /etc/postgresql/9.5/main/pg_hba.conf</span><br><span class=\"line\">---</span><br><span class=\"line\"># TYPE  DATABASE        USER            ADDRESS                 METHOD</span><br><span class=\"line\">host     whois_db       whois_user      0.0.0.0/0               md5</span><br><span class=\"line\">or</span><br><span class=\"line\">host    all     all        210.200.133.135/32            md5</span><br></pre></td></tr></table></figure>","tags":["database"]},{"title":"Redis","url":"/2017-07/redis/","content":"<h2 id=\"開發\"><a href=\"#開發\" class=\"headerlink\" title=\"開發\"></a>開發</h2><p>apt install build-essential</p>\n<h2 id=\"redis-可以存儲為-hash\"><a href=\"#redis-可以存儲為-hash\" class=\"headerlink\" title=\"redis  可以存儲為 hash\"></a>redis  可以存儲為 hash</h2><p><a href=\"http://www.redis.cn/topics/data-types-intro.html#hashes\" target=\"_blank\" rel=\"noopener\">http://www.redis.cn/topics/data-types-intro.html#hashes</a></p>\n<h2 id=\"自動計數\"><a href=\"#自動計數\" class=\"headerlink\" title=\"自動計數\"></a>自動計數</h2><p>set counter 100</p>\n<p>incr counter</p>\n<h1 id=\"存入磁盤\"><a href=\"#存入磁盤\" class=\"headerlink\" title=\"存入磁盤\"></a>存入磁盤</h1><p><a href=\"http://www.cnblogs.com/meitian/p/5209877.html\" target=\"_blank\" rel=\"noopener\">http://www.cnblogs.com/meitian/p/5209877.html</a></p>\n<h1 id=\"多實例（資料庫）\"><a href=\"#多實例（資料庫）\" class=\"headerlink\" title=\"多實例（資料庫）\"></a>多實例（資料庫）</h1><p><a href=\"http://www.cnblogs.com/super-d2/p/3855229.html\" target=\"_blank\" rel=\"noopener\">http://www.cnblogs.com/super-d2/p/3855229.html</a></p>\n<h1 id=\"更多配置\"><a href=\"#更多配置\" class=\"headerlink\" title=\"更多配置\"></a>更多配置</h1><p><a href=\"http://www.cnblogs.com/cxd4321/archive/2012/12/14/2817669.html\" target=\"_blank\" rel=\"noopener\">http://www.cnblogs.com/cxd4321/archive/2012/12/14/2817669.html</a></p>\n<h1 id=\"比較-MongoDB\"><a href=\"#比較-MongoDB\" class=\"headerlink\" title=\"比較 MongoDB\"></a>比較 MongoDB</h1><p><a href=\"http://blog.csdn.net/dodolzg/article/details/43865241\" target=\"_blank\" rel=\"noopener\">http://blog.csdn.net/dodolzg/article/details/43865241</a></p>\n","tags":["server"]},{"title":"Symfony","url":"/2017-07/Symfony/","content":"<h2 id=\"常用的包\"><a href=\"#常用的包\" class=\"headerlink\" title=\"常用的包\"></a>常用的包</h2><p>参照 <a href=\"http://knpbundles.com/\" target=\"_blank\" rel=\"noopener\">http://knpbundles.com/</a></p>\n<h2 id=\"信件\"><a href=\"#信件\" class=\"headerlink\" title=\"信件\"></a>信件</h2><p><a href=\"http://symfony.com/doc/2.8/logging/monolog_email.html\" target=\"_blank\" rel=\"noopener\">http://symfony.com/doc/2.8/logging/monolog_email.html</a><br><a href=\"https://github.com/symfony/monolog-bundle/blob/master/DependencyInjection/Configuration.php#L25\" target=\"_blank\" rel=\"noopener\">https://github.com/symfony/monolog-bundle/blob/master/DependencyInjection/Configuration.php#L25</a><br><a href=\"https://github.com/Seldaek/monolog/blob/master/doc/01-usage.md#log-levels\" target=\"_blank\" rel=\"noopener\">https://github.com/Seldaek/monolog/blob/master/doc/01-usage.md#log-levels</a></p>\n","tags":["php","symfony"]},{"title":"瀏覽器字符集 Charset","url":"/2017-07/Browser-Charset/","content":"<p>查看瀏覽器當前字符集的方法</p>\n<h2 id=\"Js\"><a href=\"#Js\" class=\"headerlink\" title=\"Js\"></a>Js</h2><p>僅僅用來查看</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">document</span>.characterSet</span><br></pre></td></tr></table></figure>\n<h2 id=\"Firefox\"><a href=\"#Firefox\" class=\"headerlink\" title=\"Firefox\"></a>Firefox</h2><p>按下<code>Alt</code>鍵。 <code>查看</code> 》 <code>文字编码</code></p>\n<h2 id=\"Chrome\"><a href=\"#Chrome\" class=\"headerlink\" title=\"Chrome\"></a>Chrome</h2><p>无</p>\n","tags":["other"]},{"title":"Jquery prop vs attr","url":"/2017-07/jquery-prop-attr/","content":"<p>如果是用於判斷 盡量使用 <code>$( elem ).prop( &quot;checked&quot; )</code>。 適用於 <code>checked</code>, <code>selected</code>, or <code>disabled</code></p>\n<h2 id=\"elem-checked\"><a href=\"#elem-checked\" class=\"headerlink\" title=\"elem.checked\"></a>elem.checked</h2><p><code>true</code> (Boolean) Will change with checkbox state</p>\n<h2 id=\"elem-prop-“checked”\"><a href=\"#elem-prop-“checked”\" class=\"headerlink\" title=\"$( elem ).prop( “checked” )\"></a>$( elem ).prop( “checked” )</h2><p><code>true</code> (Boolean) Will change with checkbox state</p>\n<h2 id=\"elem-getAttribute-“checked”\"><a href=\"#elem-getAttribute-“checked”\" class=\"headerlink\" title=\"elem.getAttribute( “checked” )\"></a>elem.getAttribute( “checked” )</h2><p><code>&quot;checked&quot;</code> (String) Initial state of the checkbox; does not change</p>\n<h2 id=\"elem-attr-“checked”-1-6-1\"><a href=\"#elem-attr-“checked”-1-6-1\" class=\"headerlink\" title=\"$( elem ).attr( “checked” ) (1.6.1+)\"></a>$( elem ).attr( “checked” ) (1.6.1+)</h2><p><code>&quot;checked&quot;</code> (String) Will change with checkbox state</p>\n<h2 id=\"elem-attr-“checked”-pre-1-6\"><a href=\"#elem-attr-“checked”-pre-1-6\" class=\"headerlink\" title=\"$( elem ).attr( “checked” ) (pre-1.6)\"></a>$( elem ).attr( “checked” ) (pre-1.6)</h2><p><code>true</code> (Boolean) Changed with checkbox state</p>\n","tags":["jquery"]},{"title":"Curl命令","url":"/2017-07/curl/","content":"<h2 id=\"下載文檔\"><a href=\"#下載文檔\" class=\"headerlink\" title=\"下載文檔\"></a>下載文檔</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 下載并保存為 api.pdf</span></span><br><span class=\"line\">curl -o api.pdf https://r.webnic.cc/NewAPIDocument_eng.pdf</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 下載并保存為 NewAPIDocument_eng.pdf</span></span><br><span class=\"line\">curl -O https://r.webnic.cc/NewAPIDocument_eng.pdf</span><br></pre></td></tr></table></figure>\n<h2 id=\"GET-amp-POST\"><a href=\"#GET-amp-POST\" class=\"headerlink\" title=\"GET &amp; POST\"></a>GET &amp; POST</h2><p>用GET方式 传递参数时，多个参数需要加上引号 (<code>&#39;</code>)</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> GET</span></span><br><span class=\"line\">curl https://api.github.com/user</span><br><span class=\"line\">curl 'https://api.github.com/user?access_token=XXXXXXXXXX&amp;nc=ss'</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> POST</span></span><br><span class=\"line\">curl -d \"param1=value1&amp;param2=value\" https://api.github.com</span><br><span class=\"line\">curl --data \"param1=value1&amp;param2=value\" https://api.github.com</span><br></pre></td></tr></table></figure>","tags":["linux"]},{"title":"Doctrine 2","url":"/2017-06/doctrine2/","content":"<h1 id=\"关联\"><a href=\"#关联\" class=\"headerlink\" title=\"关联\"></a>关联</h1><p>非主键，不能设定关联，<br>查询只能用嵌套Sql。例如  </p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\">a.no in (<span class=\"keyword\">select</span> n.no <span class=\"keyword\">from</span> AppBundle:AccountNo n <span class=\"keyword\">where</span> n.id = <span class=\"number\">2</span>)</span><br></pre></td></tr></table></figure>\n<h1 id=\"搜索\"><a href=\"#搜索\" class=\"headerlink\" title=\"搜索\"></a>搜索</h1><h2 id=\"setFirstResult\"><a href=\"#setFirstResult\" class=\"headerlink\" title=\"setFirstResult\"></a>setFirstResult</h2><p>偏移 相當於 offset </p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> * <span class=\"keyword\">form</span> <span class=\"keyword\">user</span> <span class=\"keyword\">offset</span> <span class=\"number\">5</span> <span class=\"keyword\">limit</span> <span class=\"number\">2</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"setMaxResults\"><a href=\"#setMaxResults\" class=\"headerlink\" title=\"setMaxResults\"></a>setMaxResults</h2><p>相當於 limit</p>\n<h1 id=\"getFirstResult\"><a href=\"#getFirstResult\" class=\"headerlink\" title=\"getFirstResult\"></a>getFirstResult</h1><p><strong>不是</strong>返回結果， 和 setFirstResult (偏移) 對應</p>\n<h1 id=\"结果\"><a href=\"#结果\" class=\"headerlink\" title=\"结果\"></a>结果</h1><p><a href=\"http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/dql-doctrine-query-language.html#query-result-formats\" target=\"_blank\" rel=\"noopener\">http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/dql-doctrine-query-language.html#query-result-formats</a></p>\n<h2 id=\"getResult\"><a href=\"#getResult\" class=\"headerlink\" title=\"getResult\"></a>getResult</h2><p>所有結果</p>\n<h2 id=\"getOneOrNullResult\"><a href=\"#getOneOrNullResult\" class=\"headerlink\" title=\"getOneOrNullResult\"></a>getOneOrNullResult</h2><p>如果不是唯一則 拋出錯誤，<br>需要和 setMaxResults(1) 搭配使用<br>如果結果不存在 返回Null</p>\n<h2 id=\"getSingleResult\"><a href=\"#getSingleResult\" class=\"headerlink\" title=\"getSingleResult\"></a>getSingleResult</h2><p>如果不是唯一則 拋出錯誤，<br>需要和 setMaxResults(1) 搭配使用<br>如果結果不存在 拋出錯誤</p>\n<h2 id=\"getArrayResult\"><a href=\"#getArrayResult\" class=\"headerlink\" title=\"getArrayResult\"></a>getArrayResult</h2><p>所有結果，返回數組<br>key 為Entity中定義的變量名稱</p>\n<h2 id=\"getScalarResult\"><a href=\"#getScalarResult\" class=\"headerlink\" title=\"getScalarResult\"></a>getScalarResult</h2><p>key 為資料庫中定義的變量名稱</p>\n","tags":["symfony","doctrine"]},{"title":"osk 屏幕鍵盤","url":"/2017-05/osk/","content":"<h2 id=\"調出\"><a href=\"#調出\" class=\"headerlink\" title=\"調出\"></a>調出</h2><p><code>windows键+R</code> 然後輸入 <code>osk</code>， 就會調出屏幕鍵盤。 </p>\n<h2 id=\"目的\"><a href=\"#目的\" class=\"headerlink\" title=\"目的\"></a>目的</h2><p>有一些筆記本或者找不到特殊按鍵，譬如 <code>scroll lock</code>。 可以用這個方法來解決。</p>\n","tags":["windows"]},{"title":"shadowsocks","url":"/2017-05/shadowsocks/","content":"<h1 id=\"shadowsocks-rss\"><a href=\"#shadowsocks-rss\" class=\"headerlink\" title=\"shadowsocks-rss\"></a>shadowsocks-rss</h1><p>是 shadowsocks 加強版， 增加了混淆協議。<br>下載地址：</p>\n<p><a href=\"https://github.com/breakwa11/shadowsocks-rss\" target=\"_blank\" rel=\"noopener\">https://github.com/breakwa11/shadowsocks-rss</a></p>\n<p><code>绕过大陆常见域名PAC</code>或<code>绕过大陆IP的PAC</code> 此PAC会对IP地址判断是否为国内。</p>\n","tags":["linux","windows"]},{"title":"sqlserver-drives","url":"/2017-05/sqlserver-drives/","content":"<h2 id=\"php\"><a href=\"#php\" class=\"headerlink\" title=\"php\"></a>php</h2><p>php7.0 以后下載的windows不在提供 sqlserver的驅動下載。<br>而是到SqlServer官網下載</p>\n<p><a href=\"https://docs.microsoft.com/en-us/sql/connect/sql-server-drivers\" target=\"_blank\" rel=\"noopener\">https://docs.microsoft.com/en-us/sql/connect/sql-server-drivers</a></p>\n<p>最新的下載鏈接</p>\n<p><a href=\"https://github.com/Microsoft/msphpsql/releases\" target=\"_blank\" rel=\"noopener\">https://github.com/Microsoft/msphpsql/releases</a></p>\n<h3 id=\"安裝odbc\"><a href=\"#安裝odbc\" class=\"headerlink\" title=\"安裝odbc\"></a>安裝odbc</h3><p>Pdo_SqlSrv 還需要 安裝 odbc driver<br><a href=\"https://docs.microsoft.com/en-us/sql/connect/odbc/download-odbc-driver-for-sql-server\" target=\"_blank\" rel=\"noopener\">Microsoft® ODBC Driver 13.1 for SQL Server</a></p>\n<h2 id=\"other\"><a href=\"#other\" class=\"headerlink\" title=\"other\"></a>other</h2><p>其他語言可以到這裡下載</p>\n<p><a href=\"https://docs.microsoft.com/en-us/sql/connect/sql-server-drivers\" target=\"_blank\" rel=\"noopener\">https://docs.microsoft.com/en-us/sql/connect/sql-server-drivers</a></p>\n","tags":["php","sqlserver"]},{"title":"dig 命令","url":"/2017-05/dig/","content":"<h2 id=\"基本查詢\"><a href=\"#基本查詢\" class=\"headerlink\" title=\"基本查詢\"></a>基本查詢</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">dig 080.net mx</span><br><span class=\"line\">dig 080.net txt</span><br><span class=\"line\">dig 080.net any # 查詢所有的080.net的記錄。（不含subdomain）</span><br></pre></td></tr></table></figure>\n<h2 id=\"參數\"><a href=\"#參數\" class=\"headerlink\" title=\"參數\"></a>參數</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">dig 080.net +short abc.com abc.net</span><br><span class=\"line\">dig 080.net +noall +answer abc.com abc.net</span><br><span class=\"line\">dig +nocmd +multiline +noall +answer abc.com abc.net any</span><br></pre></td></tr></table></figure>\n<h2 id=\"反向解析\"><a href=\"#反向解析\" class=\"headerlink\" title=\"反向解析\"></a>反向解析</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">dig -x 119.81.172.50</span><br><span class=\"line\"></span><br><span class=\"line\">nslookup -qt=ptr 119.81.172.50</span><br></pre></td></tr></table></figure>\n","tags":["linux"]},{"title":"iotop命令","url":"/2017-05/iotop/","content":"<h2 id=\"实际应用\"><a href=\"#实际应用\" class=\"headerlink\" title=\"实际应用\"></a>实际应用</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">iotop -o -d 2 # 只顯示有做I/O動作的進程 每隔2秒刷新一下</span><br><span class=\"line\">iotop -o -P -b -k -n 3 -d 2 # 打印3次，時間間隔2秒。</span><br><span class=\"line\">iotop -p 2655 #顯示該進程的io情況</span><br></pre></td></tr></table></figure>\n<h2 id=\"参数说明\"><a href=\"#参数说明\" class=\"headerlink\" title=\"参数说明\"></a>参数说明</h2><ul>\n<li>-o, –only #显示进程或者线程实际上正在做的I/O，而不是全部的，可以随时切换按o</li>\n<li>-b, –batch #运行在非交互式的模式</li>\n<li>-n NUM, –iter=NUM #在非交互式模式下，设置显示的次数，</li>\n<li>-d SEC, –delay=SEC #设置显示的间隔秒数，支持非整数值</li>\n<li>-k, –kilobytes #以千字节显示</li>\n<li>-p PID, –pid=PID #只显示指定PID的信息</li>\n<li>-P, –processes Only show processes. Normally iotop shows all threads.</li>\n</ul>\n<h2 id=\"操作\"><a href=\"#操作\" class=\"headerlink\" title=\"操作\"></a>操作</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">方向鍵：切換排序</span><br><span class=\"line\">r：反向排序，</span><br><span class=\"line\">o：切换至选项--only，</span><br><span class=\"line\">p：切换至--processes选项，</span><br></pre></td></tr></table></figure>","tags":["linux","iotop"]},{"title":"Golang 編譯其他系統下運行","url":"/2017-03/git-build/","content":"<h3 id=\"命令\"><a href=\"#命令\" class=\"headerlink\" title=\"命令\"></a>命令</h3><p>在windows命令行下一次執行：</p>\n<figure class=\"highlight bat\"><table><tr><td class=\"code\"><pre><span class=\"line\"># 忽略 c文檔</span><br><span class=\"line\"><span class=\"built_in\">SET</span> CGO_ENABLED=<span class=\"number\">0</span></span><br><span class=\"line\">#設定為linux</span><br><span class=\"line\"><span class=\"built_in\">SET</span> GOOS=linux</span><br><span class=\"line\"><span class=\"built_in\">SET</span> GOARCH=amd64</span><br></pre></td></tr></table></figure>\n<p>然後就可以執行 <code>go build</code> 來生成linux運行的程序。</p>\n<p>在 <code>git shell</code> 下执行</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> GOOS=linux</span><br><span class=\"line\"><span class=\"built_in\">export</span> GOARCH=amd64</span><br></pre></td></tr></table></figure>\n<h3 id=\"說明\"><a href=\"#說明\" class=\"headerlink\" title=\"說明\"></a>說明</h3><ul>\n<li>交叉编译不支持 CGO 所以要禁用它</li>\n<li>GOOS：目标平台的操作系统（darwin、freebsd、linux、windows</li>\n<li>GOARCH：目标平台的体系架构（386、amd64、arm)</li>\n</ul>\n","tags":["golang"]},{"title":"Spring Boot Jdbc练习","url":"/2017-03/spring-boot-jdbc/","content":"<p>零散的记录， 不是很系统的内容。</p>\n<h2 id=\"spring-boot\"><a href=\"#spring-boot\" class=\"headerlink\" title=\"spring boot\"></a>spring boot</h2><p>用注解代替了XML配置。上手比较简单。</p>\n<p>类似一个执行容器。用注解的方式指定Bean，将Bean映射到具体变量。扫描所有类的注解后，开始分配。并执行指定函数。</p>\n<h3 id=\"开始\"><a href=\"#开始\" class=\"headerlink\" title=\"开始\"></a>开始</h3><p><a href=\"http://start.spring.io/\" target=\"_blank\" rel=\"noopener\">http://start.spring.io/</a> 可以下载一个空的含有配置文档以及pom.xml文档。</p>\n<p><code>~\\src\\main\\resources\\application.properties</code>文档是spring的配置文档。</p>\n<h3 id=\"注解\"><a href=\"#注解\" class=\"headerlink\" title=\"注解\"></a>注解</h3><ul>\n<li><p><code>@SpringBootApplication</code> 从这里开始</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">GncApplication</span> <span class=\"keyword\">implements</span> <span class=\"title\">CommandLineRunner</span> </span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String args[])</span> </span>&#123;</span><br><span class=\"line\">        SpringApplication.run(GncApplication.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">(String... strings)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><code>@Autowired</code> 自动映射。</p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Autowired</span></span><br><span class=\"line\"><span class=\"meta\">@Qualifier</span>(<span class=\"string\">\"jdbcMysqlTemplate\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">private</span> JdbcTemplate jdbcMysqlTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 如果名稱變量名稱 沒有對應的 <span class=\"doctag\">@Bean</span>。 可以用 <span class=\"doctag\">@Qualifier</span>(\"jdbcMysqlTemplate\") 指定</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"meta\">@Autowired</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> JdbcTemplate jdbcSqlServerTemplate;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>@Configuration</code> 配置注解</li>\n<li><code>@Bean</code> Bean名称，返回一个Bean</li>\n<li><code>@ConfigurationProperties</code> 指定读取文档<code>application.properties</code>中的特殊内容 </li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ApplicationConfig</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> JdbcTemplate <span class=\"title\">jdbcMysqlTemplate</span><span class=\"params\">(@Qualifier(value = <span class=\"string\">\"mysqlDataSource\"</span>)</span> DataSource mysqlDataSource) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> JdbcTemplate(mysqlDataSource);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span>(name = <span class=\"string\">\"jdbcSqlServerTemplate\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> JdbcTemplate <span class=\"title\">jdbcSqlServerTemplate</span><span class=\"params\">(@Qualifier(value = <span class=\"string\">\"sqlServerDataSource\"</span>)</span> DataSource sqlServerDataSource) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> JdbcTemplate(sqlServerDataSource);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 使用 <span class=\"doctag\">@Bean</span> 時，如果沒有名稱，則默認為function的名稱 <span class=\"doctag\">@Bean</span>(name = \"jdbcSqlServerTemplate\")</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"meta\">@Primary</span></span><br><span class=\"line\">    <span class=\"meta\">@ConfigurationProperties</span>(prefix=<span class=\"string\">\"spring.datasource.mysql\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> DataSource <span class=\"title\">mysqlDataSource</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> DataSourceBuilder.create().build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"meta\">@ConfigurationProperties</span>(prefix=<span class=\"string\">\"spring.datasource.mssql\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> DataSource <span class=\"title\">sqlServerDataSource</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> DataSourceBuilder.create().build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"mvn\"><a href=\"#mvn\" class=\"headerlink\" title=\"mvn\"></a>mvn</h2><p>mvn 打包并运行。<br>打包会把所有需要的jar包一起打包。<code>pring-boot-app-0.1.jar</code> 按照实际情况替换。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">mvn package</span><br><span class=\"line\">java -jar target\\spring-boot-app-0.1.jar</span><br></pre></td></tr></table></figure>\n","tags":["spring","java"]},{"title":"R1soft 備份失敗","url":"/2017-02/r1soft/","content":"<h2 id=\"安裝錯誤\"><a href=\"#安裝錯誤\" class=\"headerlink\" title=\"安裝錯誤\"></a>安裝錯誤</h2><p>錯誤訊息提示要執行<code>r1soft-setup --get-module</code>.<br>但是報錯：kernel的版本信息和kernel-devel 版本對不上。</p>\n<p>所以一次執行：</p>\n<ul>\n<li>yum install kernel-devel-$(uname -r)</li>\n<li>r1soft-setup –get-module –no-binary</li>\n<li>/etc/init.d/cdp-agent restart</li>\n</ul>\n<p><a href=\"http://www.mickgenie.com/r1soft-replication-driver-missing/\" target=\"_blank\" rel=\"noopener\">參考</a></p>\n<h2 id=\"更新Server-Key\"><a href=\"#更新Server-Key\" class=\"headerlink\" title=\"更新Server Key\"></a>更新Server Key</h2><p>都安裝好之後，要記得在 Agent 端將 Server 端的 Key 複製</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">serverbackup-setup --get-key [Manager_URL]</span><br></pre></td></tr></table></figure>\n<p>例如：<br><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span> 執行</span><br><span class=\"line\">serverbackup-setup --get-key http://r1back.abc.com/public_info</span><br><span class=\"line\"><span class=\"meta\">#</span> 會顯示</span><br><span class=\"line\">Key ‘r1back.abc.com’ successfully installed</span><br></pre></td></tr></table></figure></p>\n<p><a href=\"http://wiki.r1soft.com/display/ServerBackup/Add+key+to+Linux+Backup+Agent\" target=\"_blank\" rel=\"noopener\">參考</a></p>\n","tags":["linux"]},{"title":"Cpanel ClamAV 殺毒軟件","url":"/2017-02/Cpanel-ClamAV/","content":"<p>通過Capnel安裝的ClamAV程序在/usr/local/cpanel/3rdparty/bin下面。</p>\n<ul>\n<li>/usr/local/cpanel/3rdparty/bin/clamscan</li>\n<li>/usr/local/cpanel/3rdparty/bin/freshclam</li>\n</ul>\n<h2 id=\"clamscan-命令\"><a href=\"#clamscan-命令\" class=\"headerlink\" title=\"clamscan 命令\"></a>clamscan 命令</h2><p>檢查（殺毒）文檔</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span> 檢查一個目錄</span><br><span class=\"line\">/usr/local/cpanel/3rdparty/bin/clamscan -ri /home/iconbuil/public_html</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span> 檢查多個目錄</span><br><span class=\"line\">/usr/local/cpanel/3rdparty/bin/clamscan -ri /home/*/public_html</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span> 檢查并刪除</span><br><span class=\"line\">/usr/local/cpanel/3rdparty/bin/clamscan -ri --remove /home/*/public_html</span><br></pre></td></tr></table></figure>\n<h2 id=\"freshclam-命令\"><a href=\"#freshclam-命令\" class=\"headerlink\" title=\"freshclam 命令\"></a>freshclam 命令</h2><p>升級病毒庫</p>\n","tags":["cpanel","ClamAV"]},{"title":"doctrine 1.2","url":"/2017-02/doctrine1-2/","content":"<p>Doctrine 1.2 的一些操作</p>\n<h2 id=\"Delete-批量刪除\"><a href=\"#Delete-批量刪除\" class=\"headerlink\" title=\"Delete 批量刪除\"></a>Delete 批量刪除</h2><figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">Doctrine_Query::create()</span><br><span class=\"line\">    -&gt;delete(<span class=\"string\">'User'</span>)</span><br><span class=\"line\">    -&gt;where(<span class=\"string\">'address_id = ?'</span>, <span class=\"number\">11</span>)</span><br><span class=\"line\">    -&gt;execute();</span><br></pre></td></tr></table></figure>\n<h2 id=\"Insert-批量增加\"><a href=\"#Insert-批量增加\" class=\"headerlink\" title=\"Insert 批量增加\"></a>Insert 批量增加</h2><figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">$i = <span class=\"number\">0</span>;</span><br><span class=\"line\">$p = <span class=\"keyword\">new</span> Doctrine_Collection(<span class=\"string\">'User'</span>);</span><br><span class=\"line\"><span class=\"keyword\">foreach</span> ($ids <span class=\"keyword\">as</span> $id) &#123;</span><br><span class=\"line\">    $p[$i]-&gt;product_id = $id;</span><br><span class=\"line\">    $p[$i]-&gt;download_id = <span class=\"keyword\">$this</span>-&gt;id;</span><br><span class=\"line\"></span><br><span class=\"line\">    $i++;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">$p-&gt;save();</span><br></pre></td></tr></table></figure>\n<h2 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h2><p><a href=\"http://doctrine.readthedocs.io/en/latest/en/index.html\" target=\"_blank\" rel=\"noopener\">http://doctrine.readthedocs.io/en/latest/en/index.html</a></p>\n","tags":["php","orm"]},{"title":"Exim Allow MX TO IP","url":"/2017-02/exim/","content":"<p>如果Mail To的郵箱域名設定不規範（域名mx記錄對應的是一個IP）。默認exim發送mail無法送達mail。 </p>\n<blockquote>\n<p>“WHM Home » Service Configuration » Exim Configuration Manager » Advanced Editor”<br>Scroll down to “Add Additional Configuration Setting” and “allow_mx_ip_ip” is selectable as a new entry. Set to ‘yes’</p>\n</blockquote>\n<p>參照 <a href=\"https://forums.cpanel.net/threads/allow_mx_to_ip-true-where-do-i-add.399061/\" target=\"_blank\" rel=\"noopener\">https://forums.cpanel.net/threads/allow_mx_to_ip-true-where-do-i-add.399061/</a></p>\n","tags":["exim"]},{"title":"php configuration 文檔","url":"/2017-02/php-configuration-file/","content":"<p>有些情況下需要讀取不同的php config file。譬如： compoer 不需要xdebug， 但是web端卻需要。 </p>\n<p>針對這種情況可以在php的目錄下把 <code>php.ini</code> 複製一份新的 <code>php-cli.ini</code> 文檔。這樣在 cli（命令行）下面就會自動調用該文件。 </p>\n<p>詳細參照 <a href=\"http://php.net/manual/zh/configuration.file.php\" target=\"_blank\" rel=\"noopener\">http://php.net/manual/zh/configuration.file.php</a><br>SAPI名稱參照 <a href=\"http://php.net/manual/zh/function.php-sapi-name.php\" target=\"_blank\" rel=\"noopener\">http://php.net/manual/zh/function.php-sapi-name.php</a></p>\n","tags":["php"]},{"title":"頁面分享","url":"/2017-01/share/","content":"<h2 id=\"LinkedIn\"><a href=\"#LinkedIn\" class=\"headerlink\" title=\"LinkedIn\"></a>LinkedIn</h2><p><a href=\"https://developer.linkedin.com/docs/share-on-linkedin\" target=\"_blank\" rel=\"noopener\">https://developer.linkedin.com/docs/share-on-linkedin</a><br>Customized URL 可以很快的實現share</p>\n"},{"title":"Cpanel 操作","url":"/2017-01/cpanel/","content":"<h2 id=\"限制每小時發送mail數量\"><a href=\"#限制每小時發送mail數量\" class=\"headerlink\" title=\"限制每小時發送mail數量\"></a>限制每小時發送mail數量</h2><p>在 <code>Server Configuration » Tweak Settings</code> 中 <code>mail</code> 設定 <code>Max hourly emails per domain</code></p>\n<h2 id=\"限制Mail夾檔大小\"><a href=\"#限制Mail夾檔大小\" class=\"headerlink\" title=\"限制Mail夾檔大小\"></a>限制Mail夾檔大小</h2><p>在 <code>Exim Configuration Manager » Advanced Editor</code> 中 <code>Add additional configuration setting</code> 添加 <code>message_size_limit</code> = <code>50M</code></p>\n<h2 id=\"限制密碼強度\"><a href=\"#限制密碼強度\" class=\"headerlink\" title=\"限制密碼強度\"></a>限制密碼強度</h2><p>在 <code>Security Center » Password Strength Configuration</code> 設定</p>\n<h2 id=\"程序發送密碼限定\"><a href=\"#程序發送密碼限定\" class=\"headerlink\" title=\"程序發送密碼限定\"></a>程序發送密碼限定</h2><p>在 <code>ConfigServer Security &amp; Firewall</code> 中可以限制php程序發送mail的數量，如果超過設定值則將目錄權限修改為0</p>\n<ul>\n<li>LF_SCRIPT_ALERT = On   開啟通知</li>\n<li>LF_SCRIPT_LIMIT = 100  上限設定</li>\n<li>LF_SCRIPT_PERM = On 如果超過上限則修改執行文件權限</li>\n</ul>\n<h2 id=\"Cpanel-每小時Mail-數量\"><a href=\"#Cpanel-每小時Mail-數量\" class=\"headerlink\" title=\"Cpanel 每小時Mail 數量\"></a>Cpanel 每小時Mail 數量</h2><ul>\n<li>MAX_EMAIL_PER_HOUR-$domain=300 in /var/cpanel/users/$account</li>\n<li><p>Run the <code>/usr/local/cpanel/scripts/updateuserdomains</code> script.</p>\n<h2 id=\"更新使用空間\"><a href=\"#更新使用空間\" class=\"headerlink\" title=\"更新使用空間\"></a>更新使用空間</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">/scripts/fixquotas</span><br></pre></td></tr></table></figure>\n<h2 id=\"park-domain-失敗\"><a href=\"#park-domain-失敗\" class=\"headerlink\" title=\"park domain 失敗\"></a>park domain 失敗</h2></li>\n</ul>\n<p><code>WHM &gt; Tweak Settings &gt; Domains &gt; Allow Remote Domains</code> 設定為 <code>On</code></p>\n<h2 id=\"修改mail通知\"><a href=\"#修改mail通知\" class=\"headerlink\" title=\"修改mail通知\"></a>修改mail通知</h2><p>修改一下2個地方，並查看 /root/.forward</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">Home » Server Configuration » Basic WebHost Manager® Setup  &gt; Enter one or more email addresses to contact in case a problem arises with this server.</span><br><span class=\"line\"></span><br><span class=\"line\">Home » Server Contacts » Edit System Mail Preferences</span><br></pre></td></tr></table></figure>","tags":["cpanel"]},{"title":"google map api","url":"/2017-01/google-map-api/","content":"<p>目前需要對Map Api 設定 key。</p>\n<p>需要到 <a href=\"https://console.developers.google.com/apis\" target=\"_blank\" rel=\"noopener\">https://console.developers.google.com/apis</a>  <code>凭据</code> 中添加并设定key</p>\n<h2 id=\"相关程序\"><a href=\"#相关程序\" class=\"headerlink\" title=\"相关程序\"></a>相关程序</h2><figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\">$keys = <span class=\"string\">''</span>;</span><br><span class=\"line\"><span class=\"keyword\">if</span>($_SERVER[<span class=\"string\">'SERVER_NAME'</span>]==<span class=\"string\">'aaa.com.tw'</span>||$_SERVER[<span class=\"string\">'SERVER_NAME'</span>]==<span class=\"string\">'www.aaa.com.tw'</span>) &#123;</span><br><span class=\"line\">\t$keys = <span class=\"string\">'&amp;key=AIzaSyCYWg75ZNxn9b8iO6UTY-Ldax'</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br><span class=\"line\">&lt;script type=<span class=\"string\">\"text/javascript\"</span> src=<span class=\"string\">\"http://maps.google.com.tw/maps/api/js?sensor=false&lt;?=$keys?&gt;\"</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"语系和地区设定\"><a href=\"#语系和地区设定\" class=\"headerlink\" title=\"语系和地区设定\"></a>语系和地区设定</h2><p>language 和 region 设定</p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">dir</span>=<span class=\"string\">\"rtl\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&amp;language=en&amp;region=TW\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>","tags":["google"]},{"title":"go python php sql查询基础比较","url":"/2017-01/sql-select-go-php-python/","content":"<h2 id=\"php\"><a href=\"#php\" class=\"headerlink\" title=\"php\"></a>php</h2><p>自帶的Pdo查詢可以很簡單的返回以字段名稱為key值得數組</p>\n<figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getFruit</span><span class=\"params\">($conn)</span> </span>&#123;</span><br><span class=\"line\">    $sql = <span class=\"string\">'SELECT name, color, calories FROM fruit ORDER BY name'</span>;</span><br><span class=\"line\">    <span class=\"keyword\">foreach</span> ($conn-&gt;query($sql) <span class=\"keyword\">as</span> $row) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">print</span> $row[<span class=\"string\">'name'</span>] . <span class=\"string\">\"\\t\"</span>;</span><br><span class=\"line\">        <span class=\"keyword\">print</span> $row[<span class=\"string\">'color'</span>] . <span class=\"string\">\"\\t\"</span>;</span><br><span class=\"line\">        <span class=\"keyword\">print</span> $row[<span class=\"string\">'calories'</span>] . <span class=\"string\">\"\\n\"</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"go\"><a href=\"#go\" class=\"headerlink\" title=\"go\"></a>go</h2><p>自帶的查詢只能通過<code>rows.Scan()</code>方法逐個對應变量。所以推荐使用ORM (gorm)。</p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\">rows, err := db.Query(<span class=\"string\">\"SELECT id, area, area_detail FROM zip limit 2\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">defer</span> rows.Close()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> rows.Next() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> id <span class=\"keyword\">int</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> area <span class=\"keyword\">string</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> area_detail <span class=\"keyword\">string</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> err := rows.Scan(&amp;id, &amp;area, &amp;area_detail); err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%d \\t %s \\t %s\\n\"</span>, id, area, area_detail)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"python\"><a href=\"#python\" class=\"headerlink\" title=\"python\"></a>python</h2><p>自带功能只能获取<code>tuple</code>列表（只有数字为key）。所以推荐使用ORM (sqlalchemy)。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">cursor.execute(<span class=\"string\">'select * from t1'</span>)</span><br><span class=\"line\">value = cursor.fetchall()</span><br><span class=\"line\"><span class=\"keyword\">for</span> n <span class=\"keyword\">in</span> value:</span><br><span class=\"line\">    print(n, <span class=\"string\">\"\\n\"</span>)</span><br></pre></td></tr></table></figure>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>如果是简单的使用， php用自带的就能满足。 go和python如果不用orm就很麻烦。</p>\n"},{"title":"go学习笔记 -- ORM(gorm)","url":"/2017-01/golang-orm/","content":"<h2 id=\"加載包\"><a href=\"#加載包\" class=\"headerlink\" title=\"加載包\"></a>加載包</h2><figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"github.com/jinzhu/gorm\"</span></span><br><span class=\"line\">\t_ <span class=\"string\">\"github.com/jinzhu/gorm/dialects/mysql\"</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n<p><code>github.com/jinzhu/gorm/dialects/mysql</code> 是為了方便記憶的，實際自動引用第三方的插件<code>github.com/go-sql-driver/mysql</code></p>\n<h2 id=\"定義表對應的數據\"><a href=\"#定義表對應的數據\" class=\"headerlink\" title=\"定義表對應的數據\"></a>定義表對應的數據</h2><figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Zip <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tID         <span class=\"keyword\">uint</span> <span class=\"string\">`gorm:\"primary_key\"`</span></span><br><span class=\"line\">\tArea       <span class=\"keyword\">string</span></span><br><span class=\"line\">\tAreaDetail <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(Zip)</span> <span class=\"title\">TableName</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"string\">\"zip\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>重新定義表的名字為 zip， 否則默認為 zips 。</li>\n<li>如果定義類型中加入 <code>gorm.Model</code> 自動回引入 <code>CreatedAt</code>等</li>\n</ul>\n<h2 id=\"連接數據庫\"><a href=\"#連接數據庫\" class=\"headerlink\" title=\"連接數據庫\"></a>連接數據庫</h2><figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\">db, err := gorm.Open(<span class=\"string\">\"mysql\"</span>, <span class=\"string\">\"root:123@/test?charset=utf8\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">defer</span> db.Close()</span><br></pre></td></tr></table></figure>\n<h2 id=\"查詢\"><a href=\"#查詢\" class=\"headerlink\" title=\"查詢\"></a>查詢</h2><figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 是否顯示log記錄</span></span><br><span class=\"line\"><span class=\"comment\">// db.LogMode(true)</span></span><br><span class=\"line\"></span><br><span class=\"line\">zip := Zip&#123;&#125;</span><br><span class=\"line\">db.Order(<span class=\"string\">\"id desc\"</span>).Last(&amp;zip)</span><br><span class=\"line\">log.Print(zip.ID, <span class=\"string\">\"\\n\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> zips = []Zip&#123;&#125;</span><br><span class=\"line\">db.Where(<span class=\"string\">\"language = ?\"</span>, <span class=\"string\">\"tw\"</span>).Order(<span class=\"string\">\"id desc\"</span>).Limit(<span class=\"number\">10</span>).Find(&amp;zips)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> _, z := <span class=\"keyword\">range</span> zips &#123;</span><br><span class=\"line\">    log.Printf(<span class=\"string\">\"%d, %s\\n\"</span>, z.ID, z.AreaDetail)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","tags":["golang"]},{"title":"go学习笔记 -- mysql基本操作","url":"/2017-01/golang-mysql/","content":"<h2 id=\"加载包\"><a href=\"#加载包\" class=\"headerlink\" title=\"加载包\"></a>加载包</h2><figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"database/sql\"</span></span><br><span class=\"line\">\t_ <span class=\"string\">\"github.com/go-sql-driver/mysql\"</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n<p><code>_ &quot;github.com/go-sql-driver/mysql&quot;</code>表示只加载 “github.com/go-sql-driver/mysql” 包的 init。<br>然后统一有 标准的 <code>database/sql</code>调用</p>\n<h2 id=\"连接Mysql\"><a href=\"#连接Mysql\" class=\"headerlink\" title=\"连接Mysql\"></a>连接Mysql</h2><figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\">db, err := sql.Open(<span class=\"string\">\"mysql\"</span>, <span class=\"string\">\"root:xxx@/test\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">defer</span> db.Close()</span><br></pre></td></tr></table></figure>\n<ul>\n<li>连接本地的test资料库</li>\n<li>如果连接识别抛出异常</li>\n<li><code>defer db.Close()</code> 当程序结束时，执行关闭mysql连接。</li>\n</ul>\n<h2 id=\"查询\"><a href=\"#查询\" class=\"headerlink\" title=\"查询\"></a>查询</h2><figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\">rows, err := db.Query(<span class=\"string\">\"SELECT id, area FROM zip limit 3\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">defer</span> rows.Close()</span><br></pre></td></tr></table></figure>\n<h2 id=\"处理查询结果\"><a href=\"#处理查询结果\" class=\"headerlink\" title=\"处理查询结果\"></a>处理查询结果</h2><figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> rows.Next() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> id <span class=\"keyword\">int</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> area <span class=\"keyword\">string</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> err := rows.Scan(&amp;id, &amp;area); err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    fmt.Printf(<span class=\"string\">\"%d \\t %s\\n\"</span>, id, area)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>必须通过 <code>rows.Scan()</code> 读取到对应变量</p>\n","tags":["golang"]},{"title":"go学习笔记 -- 标准库 log","url":"/2017-01/golang-log/","content":"<p>简单的例子：<br><figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">\"log\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    log.Fatal(<span class=\"string\">\"Come with fatal,exit with 1 \\n\"</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"常用函数\"><a href=\"#常用函数\" class=\"headerlink\" title=\"常用函数\"></a>常用函数</h2><ul>\n<li><code>log.Print[f|ln]</code> 等同与 fmt.Print[f|ln]</li>\n<li><code>log.Fatal[f|ln]</code> 等同与 fmt.Print[f|ln] 后 执行 os.Exit(1)</li>\n<li><code>log.Panic[f|ln]</code> 等同与 fmt.Print[f|ln] 的内容由 panic 抛出异常</li>\n</ul>\n","tags":["golang"]},{"title":"Google recaptcha 認證","url":"/2017-01/google-recaptcha/","content":"<p>home url : <a href=\"https://www.google.com/recaptcha/intro/index.html\" target=\"_blank\" rel=\"noopener\">https://www.google.com/recaptcha/intro/index.html</a></p>\n<h2 id=\"靜態頁面\"><a href=\"#靜態頁面\" class=\"headerlink\" title=\"靜態頁面\"></a>靜態頁面</h2><figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">'https://www.google.com/recaptcha/api.js'</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"g-recaptcha\"</span> <span class=\"attr\">data-sitekey</span>=<span class=\"string\">\"6LdLzxAUAAAAAJZaKQay2F59UX_Sd-Y-nLmJvEcX\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"PHP程序\"><a href=\"#PHP程序\" class=\"headerlink\" title=\"PHP程序\"></a>PHP程序</h2><figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">checkReCaptcha</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"keyword\">empty</span>($_POST[<span class=\"string\">'g-recaptcha-response'</span>])) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    $url = <span class=\"string\">'https://www.google.com/recaptcha/api/siteverify'</span>;</span><br><span class=\"line\">    $data = <span class=\"keyword\">array</span>(</span><br><span class=\"line\">        <span class=\"string\">'secret'</span> =&gt; <span class=\"string\">'6Lc-zxAUAAAAAONavoAygsBZVK2lBX4kszax8PRq'</span>,</span><br><span class=\"line\">        <span class=\"string\">'response'</span> =&gt; $_POST[<span class=\"string\">'g-recaptcha-response'</span>],</span><br><span class=\"line\">        <span class=\"string\">'remoteip'</span> =&gt; $_SERVER[<span class=\"string\">'REMOTE_ADDR'</span>],</span><br><span class=\"line\">    );</span><br><span class=\"line\"></span><br><span class=\"line\">    $ch = curl_init();</span><br><span class=\"line\">    curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class=\"line\">    curl_setopt($ch, CURLOPT_HEADER, <span class=\"number\">0</span>);  <span class=\"comment\">// 启用时会将头文件的信息作为数据流输出。</span></span><br><span class=\"line\">    curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class=\"number\">1</span>); <span class=\"comment\">// 在启用CURLOPT_RETURNTRANSFER的时候，返回原生的（Raw）输出。</span></span><br><span class=\"line\">    curl_setopt($ch, CURLOPT_TIMEOUT, <span class=\"number\">30</span>);</span><br><span class=\"line\">    curl_setopt($ch, CURLOPT_POST, <span class=\"number\">1</span>);</span><br><span class=\"line\">    curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($data)); <span class=\"comment\">// http_build_query 可以避免一些不兼容問題</span></span><br><span class=\"line\"></span><br><span class=\"line\">    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class=\"keyword\">FALSE</span>); </span><br><span class=\"line\">    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, <span class=\"keyword\">FALSE</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    $str = curl_exec($ch);</span><br><span class=\"line\">    curl_close($ch);</span><br><span class=\"line\"></span><br><span class=\"line\">    $arr = json_decode($str, <span class=\"keyword\">true</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>($arr[<span class=\"string\">'success'</span>]==<span class=\"string\">'true'</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","tags":["php","google"]},{"title":"bitbucket.org ssh 无验证码登录","url":"/2017-01/bitbucket-org-ssh-login/","content":"<h2 id=\"单用户\"><a href=\"#单用户\" class=\"headerlink\" title=\"单用户\"></a>单用户</h2><h3 id=\"一般的git-ssh登录\"><a href=\"#一般的git-ssh登录\" class=\"headerlink\" title=\"一般的git ssh登录\"></a>一般的git ssh登录</h3><ul>\n<li>生成 rsa key。</li>\n<li>把public key 上传到网站上 <code>https://bitbucket.org/account/user/&lt;username&gt;/ssh-keys/</code></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C &quot;username&quot;</span><br></pre></td></tr></table></figure>\n<h3 id=\"特殊设定\"><a href=\"#特殊设定\" class=\"headerlink\" title=\"特殊设定\"></a>特殊设定</h3><p>git remote url 必须是 <a href=\"mailto:`git@bitbucket.org\" target=\"_blank\" rel=\"noopener\">`git@bitbucket.org</a>:<accountname>/<reponame>.git`</reponame></accountname></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">git remote set-url origin git@bitbucket.org:&lt;accountname&gt;/&lt;reponame&gt;.git</span><br><span class=\"line\">git remote -v</span><br></pre></td></tr></table></figure>\n<h2 id=\"多用户\"><a href=\"#多用户\" class=\"headerlink\" title=\"多用户\"></a>多用户</h2><p>如果你有多个帐号， 就需要用到 <code>IdentitiesOnly yes</code>选项。</p>\n<p>例如在 .ssh/config 中增加第二个用户</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">Host bitbucket.org-user2</span><br><span class=\"line\">     HostName bitbucket.org</span><br><span class=\"line\">     User git</span><br><span class=\"line\">     IdentityFile ~/.ssh/user2_rsa</span><br><span class=\"line\">     IdentitiesOnly yes</span><br></pre></td></tr></table></figure>\n<p>注意，同样的remote url也要设定为 <a href=\"mailto:`git@bitbucket.org-user2\" target=\"_blank\" rel=\"noopener\">`git@bitbucket.org-user2</a>:user2/blog.git`</p>\n","tags":["git"]},{"title":"cpanel ftpquota 問題","url":"/2017-01/cpanel-ftpquota/","content":"<p>今天遇到奇怪的现象， FTP客户端 总是提示 <code>quota exceeded</code>，无法上次文档。 但是查看cpanel的磁盘空间并没有满。</p>\n<p>网上查到的解决办法，删除 <code>ftpquota</code> 文档：<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">cd /home/user/etc</span><br><span class=\"line\">mv ftpquota ftpquota_old</span><br><span class=\"line\">touch ftpquota</span><br></pre></td></tr></table></figure></p>\n","tags":["cpanel"]},{"title":"PHP常用函数","url":"/2017-01/php/","content":"<h2 id=\"pathinfo\"><a href=\"#pathinfo\" class=\"headerlink\" title=\"pathinfo\"></a>pathinfo</h2><p>返回文件路径的信息</p>\n<figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">echo</span> pathinfo(<span class=\"string\">'php.ini'</span>, PATHINFO_EXTENSION);</span><br><span class=\"line\"><span class=\"comment\">// 输出 ini</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"array-chunk\"><a href=\"#array-chunk\" class=\"headerlink\" title=\"array_chunk\"></a>array_chunk</h2><p>将一个数组分割成多个</p>\n<figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">$input_array = <span class=\"keyword\">array</span>(<span class=\"string\">'a'</span>, <span class=\"string\">'b'</span>, <span class=\"string\">'c'</span>, <span class=\"string\">'d'</span>, <span class=\"string\">'e'</span>);</span><br><span class=\"line\">print_r(array_chunk($input_array, <span class=\"number\">2</span>));</span><br></pre></td></tr></table></figure>","tags":["php"]},{"title":"利用fontlink解決consoles中文字體","url":"/2016-12/windows-fontlink/","content":"<p>有些編輯器不能定義多個字體。默認的又是宋體（簡體）。 所以只能FontLink給Consolas設定中文。</p>\n<h2 id=\"註冊表位置\"><a href=\"#註冊表位置\" class=\"headerlink\" title=\"註冊表位置\"></a>註冊表位置</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\FontLink\\SystemLink</span><br></pre></td></tr></table></figure>\n<h2 id=\"新增-Consolas\"><a href=\"#新增-Consolas\" class=\"headerlink\" title=\"新增 Consolas\"></a>新增 Consolas</h2><p>新增 <code>多字符串值</code> 名稱為 <code>Consolas</code></p>\n<p>對應的內容為<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">MSYH.TTC,Microsoft YaHei,128,96</span><br><span class=\"line\">MSYH.TTC,Microsoft YaHei</span><br><span class=\"line\">MEIRYO.TTC,Meiryo UI,128,96</span><br><span class=\"line\">MEIRYO.TTC,Meiryo UI</span><br></pre></td></tr></table></figure></p>\n<p>這裡的內容是系統自帶的 <code>Segoe UI</code> 的內容。用網絡上提供的內容，反而不美觀。</p>\n","tags":["windows"]},{"title":"Linux高负载","url":"/2016-12/linux-top-load/","content":"<ol>\n<li><p>top<br>查看基本情況</p>\n</li>\n<li><p>iotop<br>查看磁盤情況</p>\n</li>\n<li><p>iftop<br>查看流量情況</p>\n</li>\n<li><p>iostat<br>查看磁盤 CPU使用情況</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">iostat -x 1 10</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>sar<br>查看歷史情況</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">sar -p</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>1.htop<br>top的替代產品， 需要yum install。</p>\n<h2 id=\"多核心CPU-負載\"><a href=\"#多核心CPU-負載\" class=\"headerlink\" title=\"多核心CPU 負載\"></a>多核心CPU 負載</h2><p>【在多处理器系统中，负载均值是基于内核的数量决定的。以 100% 负载计算，1.00 表示单个处理器，而 2.00 则说明有两个双处理器，那么 4.00 就说明主机具有四个处理器。】<br>polo 有8個核心。 所以負載 在8以下就算正常。保守一點則是 8*0.7=5.6 左右比較ok。</p>\n<h2 id=\"HTOP\"><a href=\"#HTOP\" class=\"headerlink\" title=\"HTOP\"></a>HTOP</h2><p>在cmder使用htop的時候，F3 F4按鍵有時候不管用， 只用弄 <code>\\</code> 等按鍵</p>\n<ul>\n<li><code>/</code> <code>F3</code> 搜索进程</li>\n<li><code>\\</code> <code>F4</code> 增量进程过滤器</li>\n<li><code>t</code> <code>F5</code> 显示树形结构</li>\n<li><code>&lt;, &gt;</code> <code>F6</code> 选择排序方式</li>\n</ul>\n"},{"title":"iftop安裝","url":"/2016-12/linux-iftop/","content":"<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">#安裝依賴軟件</span><br><span class=\"line\">yum install flex byacc  libpcap ncurses ncurses-devel libpcap-devel</span><br><span class=\"line\">#下載解壓</span><br><span class=\"line\">wget http://www.ex-parrot.com/pdw/iftop/download/iftop-0.17.tar.gz</span><br><span class=\"line\">tar zxvf iftop-0.17.tar.gz</span><br><span class=\"line\">cd iftop-0.17</span><br><span class=\"line\">#安裝</span><br><span class=\"line\">./configure</span><br><span class=\"line\">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>","tags":["linux"]},{"title":"命令行操作","url":"/2016-12/linux-shell/","content":"<p>shell 下命令行的一下快捷操作</p>\n<ul>\n<li>Ctrl-R: 搜尋過去的命令 </li>\n<li>Ctrl-L: 清畫面</li>\n</ul>\n","tags":["linux"]},{"title":"linux創建大文檔","url":"/2016-12/linux-dd/","content":"<p>創建一個沒有意義的 很大的文檔。 站位中。<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">dd if=/dev/zero of=tmp.5G bs=1G count=5</span><br></pre></td></tr></table></figure></p>\n","tags":["linux"]},{"title":"linux awk","url":"/2016-12/linux-awk/","content":"<p>awk是一个强大的文本分析工具，相对于grep的查找，sed的编辑，awk在其对数据分析并生成报告时，显得尤为强大。<br>简单来说awk就是把文件逐行的读入，以空格为默认分隔符将每行切片，切开的部分再进行各种分析处理。</p>\n<h3 id=\"Usage\"><a href=\"#Usage\" class=\"headerlink\" title=\"Usage\"></a>Usage</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">awk [-W option] [-F value] [-v var=value] [--] &apos;program text&apos; [file ...]</span><br></pre></td></tr></table></figure>\n<p>假设last -n 5的输出如下<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\"># last -n 5 &lt;==仅取出前五行</span><br><span class=\"line\">root     pts/1   192.168.1.100  Tue Feb 10 11:21   still logged in</span><br><span class=\"line\">root     pts/1   192.168.1.100  Tue Feb 10 00:46 - 02:28  (01:41)</span><br><span class=\"line\">root     pts/1   192.168.1.100  Mon Feb  9 11:41 - 18:30  (06:48)</span><br><span class=\"line\">dmtsai   pts/1   192.168.1.100  Mon Feb  9 11:41 - 11:41  (00:00)</span><br><span class=\"line\">root     tty1                   Fri Sep  5 14:09 - 14:10  (00:01)</span><br></pre></td></tr></table></figure></p>\n<p>如果只是显示最近登录的5个帐号<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">#last -n 5 | awk  &apos;&#123;print $1&#125;&apos;</span><br><span class=\"line\">root</span><br><span class=\"line\">root</span><br><span class=\"line\">root</span><br><span class=\"line\">dmtsai</span><br><span class=\"line\">root</span><br></pre></td></tr></table></figure></p>\n","tags":["linux"]},{"title":"grep命令","url":"/2016-12/linux-grep/","content":"<p>用于查找</p>\n<h2 id=\"Usage：\"><a href=\"#Usage：\" class=\"headerlink\" title=\"Usage：\"></a>Usage：</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">grep [OPTION]... PATTERN [FILE]...</span><br></pre></td></tr></table></figure>\n<h2 id=\"递归查找\"><a href=\"#递归查找\" class=\"headerlink\" title=\"递归查找\"></a>递归查找</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">grep -irn &quot;*-1&quot; .</span><br></pre></td></tr></table></figure>\n<ul>\n<li>i 不区分大小写</li>\n<li>r 递归</li>\n<li>n 显示行号</li>\n</ul>\n<h2 id=\"只搜索htm結尾的文檔，\"><a href=\"#只搜索htm結尾的文檔，\" class=\"headerlink\" title=\"只搜索htm結尾的文檔，\"></a>只搜索htm結尾的文檔，</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">grep -rl &quot;*-1&quot; --include=&quot;*.htm&quot; ./</span><br></pre></td></tr></table></figure>\n<ul>\n<li>l 只顯示名稱</li>\n</ul>\n","tags":["linux"]},{"title":"添加磁盤 disk","url":"/2016-12/linux-add-disk/","content":"<p>先看磁盤名稱，獲得名稱為 /dev/sdb<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">fdisk -l</span><br></pre></td></tr></table></figure></p>\n<p>設定分區</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">fdisk /dev/sdb</span><br><span class=\"line\">// 一次輸入 </span><br><span class=\"line\">n 回車 // 創建新分區</span><br><span class=\"line\">p 回車 // 創建第一個主分區</span><br><span class=\"line\">w 回車 // 保存</span><br></pre></td></tr></table></figure>\n<p>查看創建<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">ls /dev/sdb*</span><br><span class=\"line\">// 會看到 /dev/sdb1</span><br></pre></td></tr></table></figure></p>\n<p>格式化分區<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">mkfs -t ext4 /dev/sdb1</span><br></pre></td></tr></table></figure></p>\n<p>創建掛在位置（一定要有此步驟）<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">mkdir /home2</span><br></pre></td></tr></table></figure></p>\n<p>嘗試掛在<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">mount /dev/sdb1 /home2</span><br></pre></td></tr></table></figure></p>\n<p>開機啟動掛在， 修改 /etc/fstab<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">vi /etc/fstab</span><br><span class=\"line\">// 新增內容如下：</span><br><span class=\"line\">/dev/sdb1\t/home2\text4\tdefaults\t1\t2</span><br></pre></td></tr></table></figure></p>\n","tags":["linux"]},{"title":"Mail Queue管理。","url":"/2016-12/exim/","content":"<h2 id=\"綜合使用\"><a href=\"#綜合使用\" class=\"headerlink\" title=\"綜合使用\"></a>綜合使用</h2><p>删除所有被冻结的邮件<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">exiqgrep -z -i | xargs exim -Mrm</span><br></pre></td></tr></table></figure></p>\n<p>删除所有5天前的队列邮件<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">exiqgrep -o 432000 -i | xargs exim -Mrm</span><br></pre></td></tr></table></figure></p>\n<p>冻结所有来自某一发件人的邮件<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">exiqgrep -i -f 发件人@zeknet.com | xargs exim -Mf</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"exim基礎命令\"><a href=\"#exim基礎命令\" class=\"headerlink\" title=\"exim基礎命令\"></a>exim基礎命令</h2><p>删除邮件<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">exim Mrm Message-id</span><br></pre></td></tr></table></figure></p>\n<p>冻结邮件<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">exim Mf Message-id</span><br></pre></td></tr></table></figure></p>\n<p>解冻邮件<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">exim -Mt Message-id</span><br></pre></td></tr></table></figure></p>\n<p>查看邮件头<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">exim -Mvh Message-id</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"exiqgrep-隊列查詢\"><a href=\"#exiqgrep-隊列查詢\" class=\"headerlink\" title=\"exiqgrep 隊列查詢\"></a>exiqgrep 隊列查詢</h2><p>查看来自指定发件人的所有队列邮件<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">exiqgrep -f [发件人]@domain</span><br></pre></td></tr></table></figure></p>\n<p>查看发给指定收件人的所有队列邮件<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">exiqgrep -r [收件人]@domain</span><br></pre></td></tr></table></figure></p>\n<p>查看1天前的队列邮件 (以秒为单位)<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">exiqgrep -o 86400</span><br></pre></td></tr></table></figure></p>\n<p>其他常用参数：</p>\n<ul>\n<li>-z 只查看被冻结的队列邮件</li>\n<li>-i 只显示邮件ID</li>\n<li>-c 只显示查找到的邮件数量</li>\n</ul>\n<h2 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h2><p>查看全部信息<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">exiqgrep -a</span><br></pre></td></tr></table></figure></p>\n<p>查看exim队列中所有邮件信息<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">exim -bp</span><br></pre></td></tr></table></figure></p>\n<p>汇总邮件队列信息<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">exim -bp | exiqsumm</span><br></pre></td></tr></table></figure></p>\n<p>查看exim服务的当前工作情况<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">exiwhat</span><br></pre></td></tr></table></figure></p>\n<p>删除所有<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">exim -bp | awk &apos;/^ *[0-9]+[mhd]/&#123;print &quot;exim -Mrm &quot; $3&#125;&apos; | bash</span><br></pre></td></tr></table></figure></p>\n<p>以上內容 參考網絡文章 <a href=\"http://cn.hostease.com/xueyuan/381/\" target=\"_blank\" rel=\"noopener\">http://cn.hostease.com/xueyuan/381/</a></p>\n","tags":["linux","exim"]},{"title":"Nodejs NPM 簡介","url":"/2016-12/npm/","content":"<h2 id=\"基本原理\"><a href=\"#基本原理\" class=\"headerlink\" title=\"基本原理\"></a>基本原理</h2><p>npm 是javascript包的管理工具。<br>可以把包安装成为全局（系统全局），从而可以作为系统命令来使用。<br>也可以把包安装成为某个项目目录下的模块<br>常见命令参照 <a href=\"http://dreamerslab.com/blog/tw/npm-basic-commands/\" target=\"_blank\" rel=\"noopener\">http://dreamerslab.com/blog/tw/npm-basic-commands/</a></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span> 安装某个包成为全局包</span><br><span class=\"line\">sudo npm install &lt;package name&gt; -g</span><br><span class=\"line\"><span class=\"meta\">#</span> 安装到某个目录</span><br><span class=\"line\">npm install &lt;package name&gt;</span><br></pre></td></tr></table></figure>\n<p>基本命令</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">npm ls # 查看</span><br><span class=\"line\">npm install # 安装</span><br><span class=\"line\">npm uninstall #卸载</span><br><span class=\"line\">npm update  #更新 </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span>加入 -g 来声明是全局操作</span><br><span class=\"line\">sudo npm update -g</span><br></pre></td></tr></table></figure>\n","tags":["javascript"]},{"title":"Windows PHP","url":"/2016-12/windows-php/","content":"<h2 id=\"nginx-php\"><a href=\"#nginx-php\" class=\"headerlink\" title=\"nginx + php\"></a>nginx + php</h2><p>php5.4 之前必须配合 nginx。 使用cgi模式</p>\n<figure class=\"highlight bat\"><table><tr><td class=\"code\"><pre><span class=\"line\">#启动nginx</span><br><span class=\"line\">\"D:\\Program Files\\nginx\\nginx.exe\" -p \"D:\\Program Files\\nginx\"</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bat\"><table><tr><td class=\"code\"><pre><span class=\"line\"># 启动php5.<span class=\"number\">2</span> cgi</span><br><span class=\"line\">\"D:\\Program Files\\php52\\php-cgi.exe\" -b <span class=\"number\">127</span>.<span class=\"number\">0</span>.<span class=\"number\">0</span>.<span class=\"number\">1</span>:<span class=\"number\">9000</span> -c \"D:\\Program Files\\php52\\php.ini\"</span><br><span class=\"line\"># 或者php5.<span class=\"number\">3</span> cgi</span><br><span class=\"line\">\"D:\\Program Files\\php53\\php-cgi.exe\" -b <span class=\"number\">127</span>.<span class=\"number\">0</span>.<span class=\"number\">0</span>.<span class=\"number\">1</span>:<span class=\"number\">9000</span> -c \"D:\\Program Files\\php53\\php.ini\"</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bat\"><table><tr><td class=\"code\"><pre><span class=\"line\">#php <span class=\"number\">5</span>.<span class=\"number\">6</span></span><br><span class=\"line\">\"D:\\Program Files\\php56\\php-cgi.exe\" -b <span class=\"number\">127</span>.<span class=\"number\">0</span>.<span class=\"number\">0</span>.<span class=\"number\">1</span>:<span class=\"number\">9000</span> -c \"D:\\Program Files\\php56\\php.ini\"</span><br><span class=\"line\">#php <span class=\"number\">7</span>.<span class=\"number\">0</span></span><br><span class=\"line\">\"D:\\Program Files\\php70\\php-cgi.exe\" -b <span class=\"number\">127</span>.<span class=\"number\">0</span>.<span class=\"number\">0</span>.<span class=\"number\">1</span>:<span class=\"number\">9000</span> -c \"D:\\Program Files\\php70\\php-web.ini\"</span><br></pre></td></tr></table></figure>\n<h2 id=\"php自带WEB\"><a href=\"#php自带WEB\" class=\"headerlink\" title=\"php自带WEB\"></a>php自带WEB</h2><p>php5.4 之后php自带web<br><figure class=\"highlight bat\"><table><tr><td class=\"code\"><pre><span class=\"line\">\"D:\\Program Files\\php56\\php.exe\" -S <span class=\"number\">127</span>.<span class=\"number\">0</span>.<span class=\"number\">0</span>.<span class=\"number\">1</span>:<span class=\"number\">80</span> -t \"D:\\Htdocs\"</span><br><span class=\"line\"># 或者</span><br><span class=\"line\">\"D:\\Program Files\\php70\\php.exe\" -S <span class=\"number\">127</span>.<span class=\"number\">0</span>.<span class=\"number\">0</span>.<span class=\"number\">1</span>:<span class=\"number\">80</span> -t \"D:\\Htdocs\"</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"symfony-start\"><a href=\"#symfony-start\" class=\"headerlink\" title=\"symfony start\"></a>symfony start</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">php app/console server:run</span><br></pre></td></tr></table></figure>\n<p>使用RunHiddenConsole参考。<br>RunHiddenConsole 已经下载到nginx目录<br>参考 <a href=\"https://www.nginx.com/resources/wiki/start/topics/examples/phpfastcgionwindows/\" target=\"_blank\" rel=\"noopener\">https://www.nginx.com/resources/wiki/start/topics/examples/phpfastcgionwindows/</a></p>\n<h2 id=\"web-bat\"><a href=\"#web-bat\" class=\"headerlink\" title=\"web.bat\"></a>web.bat</h2><p>All in one file </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">@echo off</span><br><span class=\"line\"></span><br><span class=\"line\">IF &quot;%1&quot; == &quot;start&quot; (</span><br><span class=\"line\"></span><br><span class=\"line\">    IF &quot;%2&quot; == &quot;52&quot; (</span><br><span class=\"line\">        echo Start PHP 52 ...</span><br><span class=\"line\">        RunHiddenConsole.exe &quot;D:\\Program Files\\php52\\php-cgi.exe&quot; -b 127.0.0.1:9000 -c &quot;D:\\Program Files\\php52\\php.ini&quot;</span><br><span class=\"line\">    ) ELSE IF &quot;%2&quot; == &quot;53&quot; (</span><br><span class=\"line\">        echo Start PHP 53 ...</span><br><span class=\"line\">        RunHiddenConsole.exe &quot;D:\\Program Files\\php53\\php-cgi.exe&quot; -b 127.0.0.1:9000 -c &quot;D:\\Program Files\\php53\\php.ini&quot;</span><br><span class=\"line\">    ) ELSE IF &quot;%2&quot; == &quot;54&quot; (</span><br><span class=\"line\">        echo Start PHP 54 ...</span><br><span class=\"line\">        RunHiddenConsole.exe &quot;D:\\Program Files\\php54\\php-cgi.exe&quot; -b 127.0.0.1:9000 -c &quot;D:\\Program Files\\php54\\php.ini&quot;</span><br><span class=\"line\">    ) ELSE IF &quot;%2&quot; == &quot;56&quot; (</span><br><span class=\"line\">        echo Start PHP 56 ...</span><br><span class=\"line\">        RunHiddenConsole.exe &quot;D:\\Program Files\\php56\\php-cgi.exe&quot; -b 127.0.0.1:9000 -c &quot;D:\\Program Files\\php56\\php.ini&quot;</span><br><span class=\"line\">    ) ELSE (</span><br><span class=\"line\">        echo Start PHP 70 ...</span><br><span class=\"line\">        RunHiddenConsole.exe &quot;D:\\Program Files\\php70\\php-cgi.exe&quot; -b 127.0.0.1:9000 -c &quot;D:\\Program Files\\php70\\php.ini&quot;</span><br><span class=\"line\">    )</span><br><span class=\"line\"></span><br><span class=\"line\">    echo Start Nginx ...</span><br><span class=\"line\">    RunHiddenConsole.exe &quot;D:\\Program Files\\nginx\\nginx.exe&quot; -p &quot;D:\\Program Files\\nginx&quot;</span><br><span class=\"line\">) ELSE IF &quot;%1&quot; == &quot;stop&quot; (</span><br><span class=\"line\">    echo Stopping nginx...</span><br><span class=\"line\">    taskkill /F /IM nginx.exe &gt; nul</span><br><span class=\"line\">    echo Stopping PHP FastCGI...</span><br><span class=\"line\">    taskkill /F /IM php-cgi.exe &gt; nul</span><br><span class=\"line\">) ELSE (</span><br><span class=\"line\">    echo Ex. web stop, web start 70|56|54|53|52</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n<p>Nginx 配置<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen       80;</span><br><span class=\"line\">        server_name  localhost;</span><br><span class=\"line\">        #charset koi8-r;</span><br><span class=\"line\">        #access_log  logs/host.access.log  main;</span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">            root   D:/Htdocs;</span><br><span class=\"line\">            index  index.php index.html index.htm;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        #error_page  404              /404.html;</span><br><span class=\"line\">        # redirect server error pages to the static page /50x.html</span><br><span class=\"line\">        #</span><br><span class=\"line\">        error_page   500 502 503 504  /50x.html;</span><br><span class=\"line\">        location = /50x.html &#123;</span><br><span class=\"line\">            root   html;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class=\"line\">        #</span><br><span class=\"line\">        #location ~ \\.php$ &#123;</span><br><span class=\"line\">        #    proxy_pass   http://127.0.0.1;</span><br><span class=\"line\">        #&#125;</span><br><span class=\"line\">        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class=\"line\">        #</span><br><span class=\"line\">        location ~ \\.php(/|$) &#123;</span><br><span class=\"line\">            root           D:/Htdocs;</span><br><span class=\"line\">            fastcgi_pass   127.0.0.1:9000;</span><br><span class=\"line\">\t    fastcgi_split_path_info ^(.+\\.php)(/.*)$;</span><br><span class=\"line\">            fastcgi_index  index.php;</span><br><span class=\"line\">            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;</span><br><span class=\"line\">            include        fastcgi_params;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        # deny access to .htaccess files, if Apache&apos;s document root</span><br><span class=\"line\">        # concurs with nginx&apos;s one</span><br><span class=\"line\">        #</span><br><span class=\"line\">        #location ~ /\\.ht &#123;</span><br><span class=\"line\">        #    deny  all;</span><br><span class=\"line\">        #&#125;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"PHP开发环境（不同版本）-在-Windows\"><a href=\"#PHP开发环境（不同版本）-在-Windows\" class=\"headerlink\" title=\"PHP开发环境（不同版本） 在 Windows\"></a>PHP开发环境（不同版本） 在 Windows</h2><h3 id=\"vc11\"><a href=\"#vc11\" class=\"headerlink\" title=\"vc11\"></a>vc11</h3><p>對應 Visual C++ Redistributable for Visual Studio 2012 Update 4<br><a href=\"https://www.microsoft.com/zh-cn/download/confirmation.aspx?id=30679\" target=\"_blank\" rel=\"noopener\">https://www.microsoft.com/zh-cn/download/confirmation.aspx?id=30679</a></p>\n<h3 id=\"vc14\"><a href=\"#vc14\" class=\"headerlink\" title=\"vc14\"></a>vc14</h3><p>對應 Visual C++ Redistributable for Visual Studio 2015<br><a href=\"https://www.microsoft.com/zh-cn/download/confirmation.aspx?id=48145\" target=\"_blank\" rel=\"noopener\">https://www.microsoft.com/zh-cn/download/confirmation.aspx?id=48145</a></p>\n","tags":["php"]},{"title":"Supervisord 進程管理","url":"/2016-12/supervisor/","content":"<h2 id=\"安裝\"><a href=\"#安裝\" class=\"headerlink\" title=\"安裝\"></a>安裝</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">#Debian Ubuntu</span><br><span class=\"line\">apt-get install supervisor</span><br><span class=\"line\">#other</span><br><span class=\"line\">easy_install supervisor</span><br></pre></td></tr></table></figure>\n<p>配置可以參照<br><a href=\"https://rayed.com/wordpress/?p=1496\" target=\"_blank\" rel=\"noopener\">https://rayed.com/wordpress/?p=1496</a><br>官網 <a href=\"http://supervisord.org/\" target=\"_blank\" rel=\"noopener\">http://supervisord.org/</a><br>ubuntu 的配置文檔 /etc/supervisor/supervisord.conf<br>log文檔 /var/log/supervisor/ 目錄下</p>\n<h2 id=\"啟動\"><a href=\"#啟動\" class=\"headerlink\" title=\"啟動\"></a>啟動</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">service supervisor start</span><br></pre></td></tr></table></figure>\n<h2 id=\"管理\"><a href=\"#管理\" class=\"headerlink\" title=\"管理\"></a>管理</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">supervisorctl stop all #停止全部进程，注：start、restart、stop都不会载入最新的配置文件。</span><br><span class=\"line\">supervisorctl reload #载入最新的配置文件，停止原有进程并按新的配置启动、管理所有进程。</span><br><span class=\"line\">supervisorctl update #根据最新的配置文件，启动新配置或有改动的进程，配置没有改动的进程不会受影响而重启。</span><br><span class=\"line\"><span class=\"meta\">#</span>注意：显示用stop停止掉的进程，用reload或者update都不会自动重启。</span><br></pre></td></tr></table></figure>"},{"title":"less","url":"/2016-12/less/","content":"<h2 id=\"Ubuntu-系統\"><a href=\"#Ubuntu-系統\" class=\"headerlink\" title=\"Ubuntu 系統.\"></a>Ubuntu 系統.</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo apt-get install node nodejs-legacy</span><br><span class=\"line\">sudo npm install -g less</span><br></pre></td></tr></table></figure>\n<h2 id=\"執行\"><a href=\"#執行\" class=\"headerlink\" title=\"執行\"></a>執行</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">lessc style.less style.css</span><br></pre></td></tr></table></figure>"},{"title":"shadowsocks manyuser 安裝","url":"/2016-12/shadowsocks-manyuser-server/","content":"<p>安裝 <a href=\"https://github.com/mengskysama/shadowsocks-rm.git\" target=\"_blank\" rel=\"noopener\">https://github.com/mengskysama/shadowsocks-rm.git</a> 需要用到 cymysql 插件鏈接mysql。</p>\n<h2 id=\"Ubuntu安裝\"><a href=\"#Ubuntu安裝\" class=\"headerlink\" title=\"Ubuntu安裝\"></a>Ubuntu安裝</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span>mysql</span><br><span class=\"line\">apt-get install mysql-server mysql-client </span><br><span class=\"line\"><span class=\"meta\">#</span>git</span><br><span class=\"line\">apt-get install git</span><br><span class=\"line\"><span class=\"meta\">#</span>進程管理</span><br><span class=\"line\">apt-get install supervisor</span><br><span class=\"line\"><span class=\"meta\">#</span>python</span><br><span class=\"line\">apt-get install python-pip python-m2crypto</span><br><span class=\"line\">pip install cymysql</span><br></pre></td></tr></table></figure>\n<h2 id=\"Centos安裝\"><a href=\"#Centos安裝\" class=\"headerlink\" title=\"Centos安裝\"></a>Centos安裝</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span>python</span><br><span class=\"line\">yum install m2crypto python-setuptools</span><br><span class=\"line\">easy_install pip</span><br><span class=\"line\">pip install cymysql</span><br><span class=\"line\"><span class=\"meta\">#</span>git</span><br><span class=\"line\">yum -y install git</span><br></pre></td></tr></table></figure>\n<h2 id=\"supervisor參考\"><a href=\"#supervisor參考\" class=\"headerlink\" title=\"supervisor參考\"></a>supervisor參考</h2><p><a href=\"https://rayed.com/wordpress/?p=1496\" target=\"_blank\" rel=\"noopener\">https://rayed.com/wordpress/?p=1496</a></p>\n<h2 id=\"shadowsocks安裝\"><a href=\"#shadowsocks安裝\" class=\"headerlink\" title=\"shadowsocks安裝\"></a>shadowsocks安裝</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span>下載源代碼</span><br><span class=\"line\">git clone -b manyuser https://github.com/mengskysama/shadowsocks-rm.git</span><br><span class=\"line\"><span class=\"meta\">#</span> 登錄MySQL 創建數據庫&amp;導入</span><br><span class=\"line\">mysql -u root -p</span><br><span class=\"line\">create database shadowsocks;</span><br><span class=\"line\">use shadowsocks;</span><br><span class=\"line\">source shadowsocks.sql;</span><br></pre></td></tr></table></figure>\n<p>守護進程管理<br>創建文件 /etc/supervisor/conf.d/shadowsocks.conf （Ubuntu）<br>內容如下：<br><figure class=\"highlight ini\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">[program:shadowsocks]</span></span><br><span class=\"line\"><span class=\"attr\">command</span>=python /root/shadowsocks/shadowsocks/servers.py</span><br><span class=\"line\"><span class=\"attr\">autorestart</span>=<span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">user</span>=root</span><br></pre></td></tr></table></figure></p>\n<p>// centos 參照<br><a href=\"http://www.cmsky.com/shadowsocks-manyuser-sspanel/\" target=\"_blank\" rel=\"noopener\">http://www.cmsky.com/shadowsocks-manyuser-sspanel/</a><br><a href=\"https://rayed.com/wordpress/?p=1496\" target=\"_blank\" rel=\"noopener\">https://rayed.com/wordpress/?p=1496</a></p>\n<p>自定義用戶類型<br>編輯 shadowsocks/dbtransfer.py 約 91行<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">cur.execute(&quot;SELECT port, u, d, transfer_enable, passwd, switch, enable FROM user&quot;)</span><br></pre></td></tr></table></figure></p>\n<p>設定為想要的Sql語句</p>\n","tags":["linux"]},{"title":"字体","url":"/2016-12/font/","content":"<p>Verdana 非等宽字体。总体可读性好些<br>Console  是等宽字体</p>\n<p>serif 字体通常不同笔顺的粗细有别，且起笔落笔处有多余的小折线。<br>sans-serif 字体笔画不论方向粗细相同，且起笔落笔没有多余折线。<br>中文字体中，可以与此类比：宋体相当于 serif 字体，黑体相当于 sans-serif 字体。</p>\n"},{"title":"VPS FTP 被动模式 (windows)","url":"/2016-12/FileZilla-Server/","content":"<p>安裝 FileZilla Server<br>安裝好以後，添加用戶以及對應目錄<br>設置 》 被動模式　，　設定改好　允許端口範圍　（5000-6000）<br>在防火牆中 打開端口， 21,5000-6000 </p>\n"},{"title":"Javascript 重新生成URL Search","url":"/2016-12/js-url/","content":"<p>需要 url.min.js 插件 <a href=\"https://github.com/websanova/js-url\" target=\"_blank\" rel=\"noopener\">https://github.com/websanova/js-url</a></p>\n<p>根据当前url重新生成URL对应的search   (window.location.search)<br>调用方法：<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">makeUrl(&apos;sort&apos;, &apos;price_asc&apos;);</span><br><span class=\"line\">makeUrl(&apos;sort&apos;, &apos;price_asc&apos;, &apos;pn&apos;, 2);</span><br></pre></td></tr></table></figure></p>\n<p>url 插件简单例子：<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">$.url(&apos;?&apos;) // 返回所有get变量</span><br><span class=\"line\">$.url(&apos;?pn&apos;) // 返回 get变量中 pn 对应的值， 如果没有则返回 undefined</span><br></pre></td></tr></table></figure></p>\n<p>函数代码：<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">function makeUrl(key, value)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    var s = $.url(&apos;?&apos;);</span><br><span class=\"line\">    s[key] = value;</span><br><span class=\"line\">    </span><br><span class=\"line\">    var k1 =  arguments[2] ? arguments[2] : &apos;&apos;;</span><br><span class=\"line\">    var v1 =   arguments[3] ? arguments[3] : &apos;&apos;;</span><br><span class=\"line\">    if(k1!=&apos;&apos;) &#123;</span><br><span class=\"line\">        s[k1] = v1;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    var url = window.location.pathname+&quot;?&quot;</span><br><span class=\"line\">    for(var v in s) &#123;</span><br><span class=\"line\">        url += v+&apos;=&apos;+s[v]+&apos;&amp;&apos;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    url = url.substr(0, url.length-1);</span><br><span class=\"line\">    return url;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n","tags":["javascript"]},{"title":"Linux文件統計","url":"/2016-12/linux-wc/","content":"<p>统计某文件夹下文件的个数<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">ls -l |grep &quot;^-&quot;|wc -l</span><br></pre></td></tr></table></figure></p>\n<p>统计某文件夹下目录的个数<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">ls -l |grep &quot;^d&quot;|wc -l</span><br></pre></td></tr></table></figure></p>\n<p>统计文件夹下文件的个数，包括子文件夹里的<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">ls -lR|grep &quot;^-&quot;|wc -l</span><br></pre></td></tr></table></figure></p>\n","tags":["linux"]},{"title":"find 命令","url":"/2016-12/linux-find/","content":"<h2 id=\"Usage\"><a href=\"#Usage\" class=\"headerlink\" title=\"Usage\"></a>Usage</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">find [path...] [expression]</span><br></pre></td></tr></table></figure>\n<h2 id=\"查找某兩個目錄，\"><a href=\"#查找某兩個目錄，\" class=\"headerlink\" title=\"查找某兩個目錄，\"></a>查找某兩個目錄，</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">find &#123;name080,090.net&#125;/application/&#123;config,helpers&#125;/ -type f</span><br></pre></td></tr></table></figure>\n<h2 id=\"修改30分鐘前的-刪除\"><a href=\"#修改30分鐘前的-刪除\" class=\"headerlink\" title=\"修改30分鐘前的 刪除\"></a>修改30分鐘前的 刪除</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">find &#123;name080,090.net&#125;/application/&#123;config,helpers&#125;/ -type f -mtime +30  -delete</span><br></pre></td></tr></table></figure>\n<h2 id=\"查詢并修改權限\"><a href=\"#查詢并修改權限\" class=\"headerlink\" title=\"查詢并修改權限\"></a>查詢并修改權限</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">find . -name &quot;*.php&quot; | xargs chmod 640</span><br></pre></td></tr></table></figure>\n<h2 id=\"查询权限是777的文档\"><a href=\"#查询权限是777的文档\" class=\"headerlink\" title=\"查询权限是777的文档\"></a>查询权限是777的文档</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">find ./ -type d -perm 777</span><br></pre></td></tr></table></figure>\n<h2 id=\"刪除亂碼或特殊文字命名的文檔\"><a href=\"#刪除亂碼或特殊文字命名的文檔\" class=\"headerlink\" title=\"刪除亂碼或特殊文字命名的文檔\"></a>刪除亂碼或特殊文字命名的文檔</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span> 獲取 inode number</span><br><span class=\"line\">ls -il</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span> 刪除文檔</span><br><span class=\"line\">find . -inum 2890693 -delete</span><br><span class=\"line\"><span class=\"meta\">#</span> 刪除目錄</span><br><span class=\"line\">find . -inum 1367 -exec rm -rf &#123;&#125; \\;</span><br></pre></td></tr></table></figure>\n","tags":["linux"]},{"title":"gzip bzip2 zip 压缩解压","url":"/2016-12/gzip-bzip2-zip/","content":"<h2 id=\"压缩\"><a href=\"#压缩\" class=\"headerlink\" title=\"压缩\"></a>压缩</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> gzip filename.txt</span><br><span class=\"line\"><span class=\"meta\">#</span> 将filename变成filename.txt.gz</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">$</span> bzip2 filename.txt</span><br><span class=\"line\"><span class=\"meta\">#</span> 将filename变成filename.txt.bz2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">$</span> zip filename</span><br><span class=\"line\"><span class=\"meta\">#</span> 将filename变成filename.txt.zip</span><br></pre></td></tr></table></figure>\n<h2 id=\"解压\"><a href=\"#解压\" class=\"headerlink\" title=\"解压\"></a>解压</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> gunzip filename.gz</span><br><span class=\"line\"><span class=\"meta\">$</span> bunzip2 filename.bz2</span><br><span class=\"line\"><span class=\"meta\">$</span> unzip filename.zip</span><br></pre></td></tr></table></figure>","tags":["linux"]},{"title":"Tar打包","url":"/2016-12/tar/","content":"<h2 id=\"排除某個目錄\"><a href=\"#排除某個目錄\" class=\"headerlink\" title=\"排除某個目錄\"></a>排除某個目錄</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">tar -czf www.tar.gz public_html/ --exclude=public_html/upload --exclude=public_html/pmd --exclude=public_html/_back_20101010</span><br><span class=\"line\">tar -czf www.tar.gz /home/abc/public_html --exclude=/home/abc/public_html/upload</span><br></pre></td></tr></table></figure>\n<p>生成 <a href=\"http://www.tar.gz\" target=\"_blank\" rel=\"noopener\">www.tar.gz</a> 文档， 压缩源目录为 public_html/</p>\n<p>–exclude=public_html/upload 是指 排除这个目录或文档。</p>\n<p>注意： 要排除的目录（文档）名称必须与源目录的名称相对应。如果是相对目录必须都是相对目录。 如果是绝对目录必须全是绝对目录。</p>\n<h2 id=\"查看tar包中的文檔\"><a href=\"#查看tar包中的文檔\" class=\"headerlink\" title=\"查看tar包中的文檔\"></a>查看tar包中的文檔</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">tar tvf test.tar.gz</span><br></pre></td></tr></table></figure>\n<h2 id=\"解壓其中的某個文檔\"><a href=\"#解壓其中的某個文檔\" class=\"headerlink\" title=\"解壓其中的某個文檔\"></a>解壓其中的某個文檔</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">tar zxfv test.tar.gz home/oracle/xiaoming/bbed/bbed.par</span><br></pre></td></tr></table></figure>\n","tags":["linux"]},{"title":"chattr和lsattr命令 linux鎖定","url":"/2016-12/chattr-lsattr/","content":"<p>lsattr 显示文件的属性<br><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">[root]#</span>lsattr</span><br><span class=\"line\">----i-------- ./ff</span><br></pre></td></tr></table></figure></p>\n<p>chattr 命令 修改文件（目錄）属性能够提高系统的安全性  (只有超级权限的用户才具有使用该命令的权限)<br><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">[root]#</span>lsattr  # 默認情況下</span><br><span class=\"line\">------------- ./ff</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"meta\">[root]#</span>chattr +i ff</span><br><span class=\"line\"><span class=\"meta\">[root]#</span>lsattr</span><br><span class=\"line\">----i-------- ./ff</span><br></pre></td></tr></table></figure></p>\n<p>chattr命令的用法：<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">chattr [ -RV ] [ -v version ] [ mode ] files...</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><ul>\n<li>：在原有参数设定基础上，追加参数。</li>\n</ul>\n</li>\n<li><ul>\n<li>：在原有参数设定基础上，移除参数。</li>\n</ul>\n</li>\n<li><p>i ：设定文件不能被删除、改名、设定链接关系，同时不能写入或新增内容。i参数对于文件 系统的安全设置有很大帮助。</p>\n</li>\n<li>a：即append，设定该参数后，只能向文件中添加数据，而不能删除，多用于服务器日志文 件安全，只有root才能设定这个属性。</li>\n<li>j：即journal，设定此参数使得当通过mount参数：data=ordered 或者 data=writeback 挂 载的文件系统，文件在写入时会先被记录(在journal中)。如果filesystem被设定参数为 data=journal，则该参数自动失效。</li>\n</ul>\n","tags":["linux"]},{"title":"PHP加速 OpCache+APCu","url":"/2016-12/php-APCu/","content":"<p>PHP5.5或者更高版本 自动加入了 opcache 缓存程序代码的功能。  但是不能缓存用户资料。<br>原本的 apc 和 opcache 部分功能冲突了， 又没有 opcache 效率高。<br>所以 APCu 出现了。 只能缓存用户自定义的资料。 接口和 apc 一样。 代码缓存 交给 opcache。</p>\n<p>所以有了<code>OpCache+APCu</code>或者<code>OpCache + Memcached( 或 Redis)</code></p>\n","tags":["php"]},{"title":"Sql Server 2008 远程连接配置","url":"/2016-12/sqlserver-2008/","content":"<p>参考</p>\n<p><a href=\"http://jingyan.baidu.com/article/6c67b1d6ca06f02787bb1ed1.html\" target=\"_blank\" rel=\"noopener\">http://jingyan.baidu.com/article/6c67b1d6ca06f02787bb1ed1.html</a></p>\n<p>注意：</p>\n<ul>\n<li>设置完后必须重新启动Sql Server 服务</li>\n<li>打开防火墙1433端口</li>\n<li>第12步中， 【选择“IP 地址”选项卡，设置TCP的端口为“1433”】  最好把最下方的 “IPAll”设定：【TCP 动态端口 0，TCP 端口 1433】</li>\n</ul>\n","tags":["windows"]},{"title":".htaccess","url":"/2016-12/htaccess/","content":"<p>.htaccess 文档</p>\n<h2 id=\"一般\"><a href=\"#一般\" class=\"headerlink\" title=\"一般\"></a>一般</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">Options +FollowSymLinks</span><br><span class=\"line\">RewriteEngine On</span><br><span class=\"line\"> </span><br><span class=\"line\">RewriteCond %&#123;REQUEST_FILENAME&#125; !-d</span><br><span class=\"line\">RewriteRule ^(.+)/$ http://%&#123;HTTP_HOST&#125;/$1 [R=301,L]</span><br><span class=\"line\"> </span><br><span class=\"line\">RewriteCond %&#123;REQUEST_FILENAME&#125; !-f</span><br><span class=\"line\">RewriteRule ^ index.php [L]</span><br></pre></td></tr></table></figure>\n<p><code>Options +FollowSymLinks</code></p>\n<p>在 某些服务器配置中，mod_rewrite要求有followsymlinks，否则会显示500内部服务器错误。</p>\n<h2 id=\"禁止所有请求\"><a href=\"#禁止所有请求\" class=\"headerlink\" title=\"禁止所有请求\"></a>禁止所有请求</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">deny from all</span><br></pre></td></tr></table></figure>\n<p>一般用于 <code>vendor</code> <code>application</code> 目录</p>\n<h2 id=\"禁止列出目錄\"><a href=\"#禁止列出目錄\" class=\"headerlink\" title=\"禁止列出目錄\"></a>禁止列出目錄</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">Options -Indexes</span><br></pre></td></tr></table></figure>\n<h2 id=\"強制-www\"><a href=\"#強制-www\" class=\"headerlink\" title=\"強制 www\"></a>強制 www</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">RewriteCond %&#123;HTTP_HOST&#125; !^www\\. [NC]</span><br><span class=\"line\">RewriteCond %&#123;REQUEST_URI&#125; !(\\.well\\-known) # 排除url</span><br><span class=\"line\">RewriteRule ^(.*)$ https://www.%&#123;HTTP_HOST&#125;/$1 [R=301,L]</span><br></pre></td></tr></table></figure>\n<h2 id=\"強制HTTPS\"><a href=\"#強制HTTPS\" class=\"headerlink\" title=\"強制HTTPS\"></a>強制HTTPS</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">RewriteCond %&#123;HTTPS&#125; off</span><br><span class=\"line\">RewriteCond %&#123;REQUEST_URI&#125; !(\\.well\\-known) # 排除url</span><br><span class=\"line\">RewriteRule ^(.*)$ https://%&#123;SERVER_NAME&#125;%&#123;REQUEST_URI&#125; [L,R]</span><br></pre></td></tr></table></figure>\n","tags":["linux","apache"]},{"title":"ftp & wget 下载","url":"/2016-12/ftp-wget/","content":"<h2 id=\"ftp\"><a href=\"#ftp\" class=\"headerlink\" title=\"ftp\"></a>ftp</h2><p>登陸ftp<br><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span>ftp    //shell下输入ftp命令,进入到ftp提示符</span><br><span class=\"line\"><span class=\"meta\">&gt;</span>open IP</span><br></pre></td></tr></table></figure></p>\n<p>接下來自動提示 輸入 賬號&amp;密碼<br><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">// get和mget命令用于从远程机上获取文件。get命令的一般格式为：</span><br><span class=\"line\"><span class=\"meta\">&gt;</span>get 文件名</span><br><span class=\"line\">//mget命令一次获取多个远程文件。mget命令的一般格式为：</span><br><span class=\"line\"><span class=\"meta\">&gt;</span>mget 文件名列表</span><br><span class=\"line\">//put和mput命令用于向远程机发送文件。Put命令的一般格式为：</span><br><span class=\"line\"><span class=\"meta\">&gt;</span>put 文件名</span><br><span class=\"line\">//mput命令一次发送多个本地文件，mput命令的一般格式为：</span><br><span class=\"line\"><span class=\"meta\">&gt;</span>mput 文件名列表</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"wget\"><a href=\"#wget\" class=\"headerlink\" title=\"wget\"></a>wget</h2><p>ftp 命令不支持目录下载. 通过wget得到解决<br><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">wget ftp://IP:PORT/www/* --ftp-user=xxx --ftp-password=xxx -r</span><br></pre></td></tr></table></figure></p>\n","tags":["linux"]},{"title":"Linux 快速删除大量小文件","url":"/2016-12/linux-rsync/","content":"<h2 id=\"快速删除大量小文件\"><a href=\"#快速删除大量小文件\" class=\"headerlink\" title=\"快速删除大量小文件\"></a>快速删除大量小文件</h2><ol>\n<li>先建立一个空目录</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">mkdir /data/blank</span><br></pre></td></tr></table></figure>\n<ol>\n<li>用rsync删除目标目录</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">rsync --delete-before -d -a -H -v --progress --stats /data/blank/ /var/edatacache/</span><br><span class=\"line\"><span class=\"meta\">#</span> or </span><br><span class=\"line\">rsync --delete-before -d /data/blank/ /var/edatacache/</span><br></pre></td></tr></table></figure>\n<h2 id=\"同步某个目录\"><a href=\"#同步某个目录\" class=\"headerlink\" title=\"同步某个目录\"></a>同步某个目录</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">/bin/rsync -a -v -P /home/hk/public_html/uploads/ hk@s1.ace.com:/home/hk/public_html/uploads/</span><br></pre></td></tr></table></figure>\n<h3 id=\"免密码-使用-key\"><a href=\"#免密码-使用-key\" class=\"headerlink\" title=\"免密码 使用 key\"></a>免密码 使用 key</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">1. 生成key</span><br><span class=\"line\">ssh-keygen -t rsa      //  （一路回车键）</span><br><span class=\"line\"></span><br><span class=\"line\">2. 拷贝到远程主机上</span><br><span class=\"line\">ssh-copy-id -i  ~/.ssh/id_rsa.pub  root@IP   //原理就是把自己的公钥 添加到 对方的 au*** 那个文件里面   </span><br><span class=\"line\"><span class=\"meta\">#</span>ssh-copy-id -i ~/.ssh/id_rsa.pub “-p 2022 root@ip”  //如果不是默认22端口</span><br><span class=\"line\"></span><br><span class=\"line\">3. 验证：</span><br><span class=\"line\">ssh root@ip            //不需要密码，说明成功！</span><br></pre></td></tr></table></figure>\n<h2 id=\"参数说明\"><a href=\"#参数说明\" class=\"headerlink\" title=\"参数说明\"></a>参数说明</h2><ol>\n<li>–delete-before 接收者在传输之前进行删除操作</li>\n<li>–progress 在传输时显示传输过程</li>\n<li>-a 归档模式，表示以递归方式传输文件，并保持所有文件属性</li>\n<li>-H 保持硬连接的文件</li>\n<li>-v 详细输出模式</li>\n<li>–stats 给出某些文件的传输状态</li>\n</ol>\n","tags":["linux"]},{"title":"PHP CURL","url":"/2016-12/php-curl/","content":"<h2 id=\"POST\"><a href=\"#POST\" class=\"headerlink\" title=\"POST\"></a>POST</h2><figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">$data = <span class=\"keyword\">array</span>(<span class=\"string\">'name'</span> =&gt; <span class=\"string\">'Foo'</span>, <span class=\"string\">'Email'</span> =&gt; <span class=\"string\">'abc@example.com'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">$ch = curl_init();</span><br><span class=\"line\">curl_setopt($ch, CURLOPT_URL, <span class=\"string\">'http://localhost/tmp/a.php'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">curl_setopt($ch, CURLOPT_HEADER, <span class=\"number\">0</span>);  <span class=\"comment\">// 启用时会将头文件的信息作为数据流输出。</span></span><br><span class=\"line\">curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class=\"number\">1</span>); <span class=\"comment\">// 在启用CURLOPT_RETURNTRANSFER的时候，返回原生的（Raw）输出。</span></span><br><span class=\"line\">curl_setopt($ch, CURLOPT_TIMEOUT, <span class=\"number\">30</span>);</span><br><span class=\"line\">curl_setopt($ch, CURLOPT_POST, <span class=\"number\">1</span>);</span><br><span class=\"line\">curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($data)); <span class=\"comment\">// http_build_query 可以避免一些不兼容問題</span></span><br><span class=\"line\"></span><br><span class=\"line\">$s = curl_exec($ch);</span><br><span class=\"line\">curl_close($ch);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">echo</span> $s;</span><br></pre></td></tr></table></figure>\n<h2 id=\"GET\"><a href=\"#GET\" class=\"headerlink\" title=\"GET\"></a>GET</h2><figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">$url = <span class=\"string\">'http://bac.com'</span></span><br><span class=\"line\">$url .= <span class=\"string\">'?'</span>.http_build_query($postField);</span><br><span class=\"line\">$ch = curl_init();</span><br><span class=\"line\">curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class=\"line\">curl_setopt($ch, CURLOPT_HEADER, <span class=\"number\">0</span>);</span><br><span class=\"line\">curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class=\"number\">1</span>);</span><br><span class=\"line\">curl_setopt($ch, CURLOPT_TIMEOUT, <span class=\"number\">30</span>);</span><br><span class=\"line\">$data = curl_exec($ch);</span><br><span class=\"line\">curl_close($ch);</span><br></pre></td></tr></table></figure>\n<h2 id=\"强制声明字符-charset\"><a href=\"#强制声明字符-charset\" class=\"headerlink\" title=\"强制声明字符 charset\"></a>强制声明字符 charset</h2><figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">curl_setopt($ch, CURLOPT_HTTPHEADER, <span class=\"keyword\">array</span>(<span class=\"string\">'Content-Type:application/x-www-form-urlencoded; charset=utf-8'</span>));</span><br></pre></td></tr></table></figure>\n<h2 id=\"JSON格式传递数据\"><a href=\"#JSON格式传递数据\" class=\"headerlink\" title=\"JSON格式传递数据\"></a>JSON格式传递数据</h2><figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">$header[] = <span class=\"string\">'Content-Type: application/json'</span>;</span><br><span class=\"line\">$header[] = <span class=\"string\">'Accept: application/json'</span>;</span><br><span class=\"line\">curl_setopt($ch, CURLOPT_HTTPHEADER, $header);</span><br><span class=\"line\">curl_setopt($ch, CURLOPT_POST, <span class=\"number\">1</span>);</span><br><span class=\"line\">curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($param));</span><br></pre></td></tr></table></figure>\n<h2 id=\"SSL\"><a href=\"#SSL\" class=\"headerlink\" title=\"SSL\"></a>SSL</h2><figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class=\"keyword\">FALSE</span>); </span><br><span class=\"line\">curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, <span class=\"keyword\">FALSE</span>);</span><br></pre></td></tr></table></figure>\n<ul>\n<li><p>CURLOPT_SSL_VERIFYPEER<br>禁用后cURL将终止从服务端进行验证。<br>使用CURLOPT_CAINFO选项设置证书使用CURLOPT_CAPATH选项设置证书目录<br>如果CURLOPT_SSL_VERIFYPEER(默认值为2)被启用，CURLOPT_SSL_VERIFYHOST需要被设置成TRUE否则设置为FALSE。</p>\n</li>\n<li><p>CURLOPT_SSL_VERIFYHOST<br>1 检查服务器SSL证书中是否存在一个公用名(common name)。<br>2 检查公用名是否存在，并且是否与提供的主机名匹配。    </p>\n</li>\n</ul>\n<p>译者注：公用名(Common Name)一般来讲就是填写你将要申请SSL证书的域名 (domain)或子域名(sub domain)。</p>\n<h2 id=\"HTTP-basic-authentication\"><a href=\"#HTTP-basic-authentication\" class=\"headerlink\" title=\"HTTP basic authentication\"></a>HTTP basic authentication</h2><p>連接一個url， 需要提供用戶名和密碼的時候用到。</p>\n<figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">curl_setopt($curl, CURLOPT_USERPWD, <span class=\"string\">\"username:password\"</span>);</span><br></pre></td></tr></table></figure>","tags":["php"]},{"title":"Vritualizer VNC","url":"/2016-12/Vritualizer-VNC/","content":"<p>vnc ip 端口查找<br>在 【Launch VPS VNC】中查找ip和端口。<br>在 vps 編輯頁面 點擊 【VNC】然後查看源代碼， 查看對應的密碼。</p>\n<p>使用VNC Viewer</p>\n"},{"title":"Cpanel CloudLinux","url":"/2016-12/Cpanel-CloudLinux/","content":"<h2 id=\"更新lincense\"><a href=\"#更新lincense\" class=\"headerlink\" title=\"更新lincense\"></a>更新lincense</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span> cpanel update</span><br><span class=\"line\">/usr/local/cpanel/cpkeyclt</span><br><span class=\"line\"><span class=\"meta\">#</span> cloudlinux check</span><br><span class=\"line\">/usr/sbin/clnreg_ks --force</span><br></pre></td></tr></table></figure>\n<p><a href=\"https://verify.cpanel.net/\" target=\"_blank\" rel=\"noopener\">https://verify.cpanel.net/</a><br><a href=\"https://cln.cloudlinux.com/clweb/public/license-lookup.xhtml\" target=\"_blank\" rel=\"noopener\">https://cln.cloudlinux.com/clweb/public/license-lookup.xhtml</a></p>\n<h2 id=\"Cpanel-一个IP對應多個ssl\"><a href=\"#Cpanel-一个IP對應多個ssl\" class=\"headerlink\" title=\"Cpanel 一个IP對應多個ssl\"></a>Cpanel 一个IP對應多個ssl</h2><p>要有SNI支援<br>必須要是 CentOS 6.x 以及 Cpanel 11.38以後</p>\n<h2 id=\"Cpanel-關閉-Analog\"><a href=\"#Cpanel-關閉-Analog\" class=\"headerlink\" title=\"Cpanel 關閉 Analog\"></a>Cpanel 關閉 Analog</h2><p>訪問量很大的時候 Analog 統計佔用很大的空間。 所以 考慮暫停。 </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">WHM Home » Server Configuration » Tweak Settings</span><br><span class=\"line\">Analog set to off</span><br></pre></td></tr></table></figure>\n<h2 id=\"Cpanel-Apache-log-file\"><a href=\"#Cpanel-Apache-log-file\" class=\"headerlink\" title=\"Cpanel Apache log file\"></a>Cpanel Apache log file</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">tail -500 /usr/local/</span><br><span class=\"line\">/logs/error_log</span><br></pre></td></tr></table></figure>\n<h2 id=\"CloudLinux-安裝配置\"><a href=\"#CloudLinux-安裝配置\" class=\"headerlink\" title=\"CloudLinux 安裝配置\"></a>CloudLinux 安裝配置</h2><h3 id=\"安裝-CageFS\"><a href=\"#安裝-CageFS\" class=\"headerlink\" title=\"安裝 CageFS\"></a>安裝 CageFS</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ yum install cagefs</span><br><span class=\"line\">$ /usr/sbin/cagefsctl --init</span><br><span class=\"line\">$ mkdir /home/cagefs-skeleton</span><br><span class=\"line\">$ ln -s /home/cagefs-skeleton /usr/share/cagefs-skeleton</span><br></pre></td></tr></table></figure>\n<h3 id=\"安裝-PHP-Selector\"><a href=\"#安裝-PHP-Selector\" class=\"headerlink\" title=\"安裝 PHP Selector\"></a>安裝 PHP Selector</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">yum groupinstall alt-php</span><br><span class=\"line\">yum update cagefs lvemanager</span><br></pre></td></tr></table></figure>\n","tags":["cpanel"]},{"title":"Lumen","url":"/2016-12/Lumen/","content":"<p>必須把public/index.php 修改為：<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">$app-&gt;run($app[&apos;request&apos;]);</span><br></pre></td></tr></table></figure></p>\n<p>否則在二級目錄提示404錯誤。</p>\n<p>除去 url 中的 public 。 （只適用于web站點的根目錄，二級目錄沒測試）<br>在web站點根目錄下創建 .htaccess 文件。<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">RewriteEngine On</span><br><span class=\"line\">RewriteRule ^(.*)$ public/$1 [L]</span><br></pre></td></tr></table></figure></p>\n","tags":["php"]},{"title":"KVM virt 复制管理","url":"/2016-12/KVM-virt/","content":"<p>指定一个镜像文档， 並把里面的内容copy出来。<br>先登录宿主主机</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">virt-copy-out -a /dev/vpsg/vsv1157-0eq3-znowggzhyixfdvnz &apos;win:c:\\windows\\system32\\config&apos; /root/</span><br></pre></td></tr></table></figure>"},{"title":"CSF设置","url":"/2016-12/CSF/","content":"<h2 id=\"攔截登陸失敗的設定\"><a href=\"#攔截登陸失敗的設定\" class=\"headerlink\" title=\"攔截登陸失敗的設定\"></a>攔截登陸失敗的設定</h2><p>Login Failure Blocking and Alerts</p>\n<figure class=\"highlight ini\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">LF_SELECT</span> = <span class=\"number\">1</span> <span class=\"comment\">#表示僅僅屏蔽某個ip訪問server的端口 ， 端口設定見 PORTS_*</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">LF_SSHD</span> = <span class=\"number\">5</span> <span class=\"comment\">#失敗幾次？</span></span><br><span class=\"line\"><span class=\"attr\">LF_SSHD_PERM</span> = <span class=\"number\">1</span> <span class=\"comment\">#屏蔽時間長度 0 不屏蔽， 1 永久屏蔽， 900(非1、0其他數字)表示屏蔽900秒，屏蔽900秒属于临时屏蔽（Temporary IP blocking）</span></span><br><span class=\"line\"><span class=\"attr\">LF_SSHD_PERM</span> = <span class=\"number\">900</span> <span class=\"comment\"># 代表临时屏蔽</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">LF_INTERVAL</span> = <span class=\"number\">3600</span> <span class=\"comment\"># 統計刷新週期， 按照上面的例子是 3600秒內登陸失敗5次。 就永久屏蔽</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## Temp to Perm/Netblock Settings</span></span><br></pre></td></tr></table></figure>\n<p>Temporary to Permanent IP blocking<br>意思是临时屏蔽IP 设定为 永久屏蔽IP</p>\n<figure class=\"highlight ini\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">LF_PERMBLOCK_INTERVAL</span> = <span class=\"number\">86400</span></span><br><span class=\"line\"><span class=\"attr\">LF_PERMBLOCK_COUNT</span> = <span class=\"number\">4</span></span><br><span class=\"line\"><span class=\"comment\"># 表示 86400 秒内 被例如临时屏蔽名单 4次 则转换为 永久屏蔽</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"停止發送alerts-Mail到Root\"><a href=\"#停止發送alerts-Mail到Root\" class=\"headerlink\" title=\"停止發送alerts Mail到Root\"></a>停止發送alerts Mail到Root</h2><p>增加自動清除，每週一執行</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">0 0 * * 1 /usr/bin/rsync --delete-before -a -H -v --progress --stats /root/Maildir/empty/ /root/Maildir/new/  &gt;/dev/null 2&gt;&amp;1</span><br></pre></td></tr></table></figure>\n<h2 id=\"修改-High-5-minute-load-average-alert-Mail\"><a href=\"#修改-High-5-minute-load-average-alert-Mail\" class=\"headerlink\" title=\"修改 [High 5 minute load average alert] Mail\"></a>修改 [High 5 minute load average alert] Mail</h2><p><a href=\"https://forum.configserver.com/viewtopic.php?t=3221\" target=\"_blank\" rel=\"noopener\">參考1</a><br><a href=\"https://www.grandmstramrod.co.uk/lfd-high-5-minute-load-average-alert/\" target=\"_blank\" rel=\"noopener\">參考2</a></p>\n<h3 id=\"etc-csf-load-sh\"><a href=\"#etc-csf-load-sh\" class=\"headerlink\" title=\"/etc/csf/load.sh\"></a>/etc/csf/load.sh</h3><p>創建 <code>/etc/csf/load.sh</code> 。並 修改權限 <code>chmod +x /etc/csf/load.sh</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span>!/bin/sh</span><br><span class=\"line\"><span class=\"meta\">&gt;</span>/etc/csf/csf.report</span><br><span class=\"line\">iostat -d 1 5 &gt;&gt; /etc/csf/csf.report</span><br><span class=\"line\">iostat -x -d 1 5 &gt;&gt; /etc/csf/csf.report</span><br><span class=\"line\">iotop -o -P -b -k -n 3 -d 2 &gt;&gt; /etc/csf/csf.report</span><br><span class=\"line\">mpstat -P ALL &gt;&gt; /etc/csf/csf.report</span><br><span class=\"line\">top -b -n 1 &gt;&gt; /etc/csf/csf.report</span><br><span class=\"line\">netstat -autpn</span><br><span class=\"line\">echo \"report on $(date +\"%Y-%m-%d %T\")\" | mailx -s \"polo - Load Report\" -a /etc/csf/csf.report root</span><br></pre></td></tr></table></figure>\n<p>以上內容將發生給 root。 記得設定 <code>/root/.forward</code></p>\n<h3 id=\"設定-csf-conf\"><a href=\"#設定-csf-conf\" class=\"headerlink\" title=\"設定 csf.conf\"></a>設定 csf.conf</h3><p>修改 文檔 <code>/etc/csf/csf.conf</code> 設定 <code>PT_LOAD_ACTION = &quot;/etc/csf/load.sh&quot;</code></p>\n<h3 id=\"設定-root-forward\"><a href=\"#設定-root-forward\" class=\"headerlink\" title=\"設定 root .forward\"></a>設定 root .forward</h3><p>修改 <code>/root/.forward</code> 文檔。因為</p>\n<h2 id=\"常用命令\"><a href=\"#常用命令\" class=\"headerlink\" title=\"常用命令\"></a>常用命令</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">csf -r # 重啟 csf</span><br><span class=\"line\">csf -ra  # 重啟 csf lfd  #  Restart firewall rules (csf) and then restart lfd  daemon.</span><br><span class=\"line\">csf --lfd [stop|start|restart|status] # lfd 操作</span><br><span class=\"line\"></span><br><span class=\"line\">csf -g,  --grep ip # 搜索 Search the iptables and ip6tables rules for a  match</span><br><span class=\"line\"></span><br><span class=\"line\">csf -t # Displays temporary allow and deny IP</span><br><span class=\"line\">csf -tr ip # Remove an IP from the temporary IP ban or allow list</span><br><span class=\"line\"></span><br><span class=\"line\">csf -d,  --deny ip [comment] # Deny an IP and add to /etc/csf/csf.deny</span><br><span class=\"line\">csf -dr, --denyrm ip # Unblock an IP and remove from /etc/csf/csf.deny</span><br></pre></td></tr></table></figure>","tags":["linux"]},{"title":"composer命令","url":"/2016-12/composer/","content":"<h2 id=\"常用命令\"><a href=\"#常用命令\" class=\"headerlink\" title=\"常用命令\"></a>常用命令</h2><h3 id=\"安裝某個項目\"><a href=\"#安裝某個項目\" class=\"headerlink\" title=\"安裝某個項目\"></a>安裝某個項目</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">composer create-project laravel/laravel path --prefer-dist</span><br></pre></td></tr></table></figure>\n<p>安裝 larave 到 path 目錄。<code>--prefer-dist</code> 为了强制使用压缩包，而不是克隆源代码。</p>\n<h3 id=\"更新软件包\"><a href=\"#更新软件包\" class=\"headerlink\" title=\"更新软件包\"></a>更新软件包</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">composer update</span><br></pre></td></tr></table></figure>\n<h3 id=\"只更新-Calss\"><a href=\"#只更新-Calss\" class=\"headerlink\" title=\"只更新 Calss\"></a>只更新 Calss</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">composer dump-autoload</span><br></pre></td></tr></table></figure>\n<h3 id=\"为生产环境作准备\"><a href=\"#为生产环境作准备\" class=\"headerlink\" title=\"为生产环境作准备\"></a>为生产环境作准备</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">composer dump-autoload --optimize</span><br></pre></td></tr></table></figure>\n<p>或者</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">composer update --no-dev --optimize-autoloader</span><br><span class=\"line\"><span class=\"meta\">#</span> or</span><br><span class=\"line\">composer update --optimize-autoloader</span><br></pre></td></tr></table></figure>\n<h2 id=\"更改镜像源-repo\"><a href=\"#更改镜像源-repo\" class=\"headerlink\" title=\"更改镜像源 repo\"></a>更改镜像源 repo</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span> 显示配置</span><br><span class=\"line\">composer config -g  -l</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span> 取消全局配置</span><br><span class=\"line\">composer config -g --unset repos.packagist</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span> 全局使用 huawei 镜像源</span><br><span class=\"line\">composer config -g repo.packagist composer https://mirrors.huaweicloud.com/repository/php</span><br></pre></td></tr></table></figure>\n<h3 id=\"CRM-Composer源管理工具\"><a href=\"#CRM-Composer源管理工具\" class=\"headerlink\" title=\"CRM - Composer源管理工具\"></a>CRM - Composer源管理工具</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span> 安装</span><br><span class=\"line\">composer global require slince/composer-registry-manager</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span>列出所有可使用的镜像</span><br><span class=\"line\">composer repo:ls</span><br><span class=\"line\"><span class=\"meta\">#</span>切换镜像</span><br><span class=\"line\">composer repo:use</span><br></pre></td></tr></table></figure>\n<h3 id=\"Composer源\"><a href=\"#Composer源\" class=\"headerlink\" title=\"Composer源\"></a>Composer源</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ composer repo:ls</span><br><span class=\"line\"></span><br><span class=\"line\"> --- --------------- ------------------------------------------------</span><br><span class=\"line\">      composer        https://packagist.org</span><br><span class=\"line\">      phpcomposer     https://packagist.phpcomposer.com</span><br><span class=\"line\">      aliyun          https://mirrors.aliyun.com/composer</span><br><span class=\"line\">      tencent         https://mirrors.cloud.tencent.com/composer</span><br><span class=\"line\">      huawei          https://mirrors.huaweicloud.com/repository/php</span><br><span class=\"line\">      laravel-china   https://packagist.laravel-china.org</span><br><span class=\"line\">  *   cnpkg           https://php.cnpkg.org</span><br><span class=\"line\">      sjtug           https://packagist.mirrors.sjtug.sjtu.edu.cn</span><br><span class=\"line\"> --- --------------- ------------------------------------------------</span><br></pre></td></tr></table></figure>","tags":["php"]},{"title":"go学习笔记 -- 杂记","url":"/2016-12/golang/","content":"<h2 id=\"go-get\"><a href=\"#go-get\" class=\"headerlink\" title=\"go get\"></a>go get</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span> 下載并安裝到 GOPATH目錄</span><br><span class=\"line\">go get github.com/go-sql-driver/mysql</span><br><span class=\"line\"><span class=\"meta\">#</span> 更新</span><br><span class=\"line\">go get -u github.com/go-sql-driver/mysql</span><br></pre></td></tr></table></figure>\n<h2 id=\"struct-tag\"><a href=\"#struct-tag\" class=\"headerlink\" title=\"struct  tag\"></a>struct  tag</h2><p>用双引号(double quote)或重音(backquote/grave accent)表示的字符串</p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"reflect\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">type</span> S <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\t\tF <span class=\"keyword\">string</span> <span class=\"string\">`species:\"gopher\" color:\"blue\"`</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\ts := S&#123;&#125;</span><br><span class=\"line\">\tst := reflect.TypeOf(s)</span><br><span class=\"line\">\tfield := st.Field(<span class=\"number\">0</span>)</span><br><span class=\"line\">\tfmt.Println(field.Tag.Get(<span class=\"string\">\"color\"</span>), field.Tag.Get(<span class=\"string\">\"species\"</span>))</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"exec\"><a href=\"#exec\" class=\"headerlink\" title=\"exec\"></a>exec</h2><figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\">cmd := exec.Command(<span class=\"string\">\"ruby\"</span>, whois_app_path, u)</span><br><span class=\"line\"><span class=\"keyword\">var</span> out bytes.Buffer</span><br><span class=\"line\">cmd.Stdout = &amp;out</span><br><span class=\"line\">cmd.Run()</span><br></pre></td></tr></table></figure>\n<p>注意<br><figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\">exec.Command(<span class=\"string\">\"ruby\"</span>, whois_app_path, u)</span><br><span class=\"line\"># 第一个参数 是程序， 第二个参数为参数， 第三个参数为参数， 不用额外添加 引号</span><br></pre></td></tr></table></figure></p>\n<p>例如<br><figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\">exec.Command(<span class=\"string\">\"ruby\"</span>, <span class=\"string\">\"/root/whois/whois_api\"</span>, <span class=\"string\">\"baidu.com 080.tw 080.net\"</span>)</span><br></pre></td></tr></table></figure></p>\n<p>如果參數過多可以使用<br><figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\">exec.Command(<span class=\"string\">\"/bin/sh\"</span>, <span class=\"string\">\"-c\"</span>, <span class=\"string\">\"aaa -a a -b b -c c -d d -e d\"</span>)</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"cli-fromework\"><a href=\"#cli-fromework\" class=\"headerlink\" title=\"cli fromework\"></a>cli fromework</h2><p><a href=\"https://carlosbecker.com/posts/golang-cli-apps/\" target=\"_blank\" rel=\"noopener\">https://carlosbecker.com/posts/golang-cli-apps/</a></p>\n<p><a href=\"https://github.com/spf13/cobra\" target=\"_blank\" rel=\"noopener\">https://github.com/spf13/cobra</a></p>\n","tags":["golang"]},{"title":"SPF記錄","url":"/2016-12/SPF/","content":"<h2 id=\"什么是SPF\"><a href=\"#什么是SPF\" class=\"headerlink\" title=\"什么是SPF\"></a>什么是SPF</h2><p>是 Sender Policy Framework 的缩写，一种以IP地址认证电子邮件发件人身份的技术。 接收邮件方会首先检查域名的SPF记录，来确定发件人的IP地址是否被包含在SPF记录里面，如果在，就认为是一封正确的邮件，否则会认为是一封伪造的邮件进行退回。</p>\n<p>中文参考 <a href=\"http://www.renfei.org/blog/introduction-to-spf.html\" target=\"_blank\" rel=\"noopener\">http://www.renfei.org/blog/introduction-to-spf.html</a><br>生成工具 <a href=\"http://www.spfwizard.net/\" target=\"_blank\" rel=\"noopener\">http://www.spfwizard.net/</a></p>\n"},{"title":"Mysql整理","url":"/2016-12/Mysql/","content":"<h2 id=\"存储引擎选择\"><a href=\"#存储引擎选择\" class=\"headerlink\" title=\"存储引擎选择\"></a>存储引擎选择</h2><ul>\n<li>MyISAM管理非事务表。它提供高速存储和检索，以及全文搜索能力。如果应用中需要执行大量的SELECT查询，那么MyISAM是更好的选择。</li>\n<li>InnoDB用于事务处理应用程序，具有众多特性，包括ACID事务支持。如果应用中需要执行大量的INSERT或UPDATE操作，则应该使用InnoDB，这样可以提高多用户并发操作的性能。</li>\n</ul>\n<h2 id=\"字段-char-vs-varchar-類型\"><a href=\"#字段-char-vs-varchar-類型\" class=\"headerlink\" title=\"字段 char vs varchar 類型\"></a>字段 char vs varchar 類型</h2><h3 id=\"char\"><a href=\"#char\" class=\"headerlink\" title=\"char\"></a>char</h3><ul>\n<li>固定长度，最大长度255字节。</li>\n<li>(一定情况下)占用空间比较大，但是索引查询比较快</li>\n<li>推荐固定长度字段 或者 很短且需要索引的使用</li>\n</ul>\n<p>注意： PAD_CHAR_TO_FULL_LENGTH 时，在取数据时让尾部的空格保留</p>\n<h3 id=\"varchar\"><a href=\"#varchar\" class=\"headerlink\" title=\"varchar\"></a>varchar</h3><ul>\n<li>根据实际存储，可变长度，最大长度是65,532字节</li>\n<li>(一定情况下)占用空间比较大小，但是索引查询比较慢</li>\n</ul>\n<h3 id=\"存储类型区别\"><a href=\"#存储类型区别\" class=\"headerlink\" title=\"存储类型区别\"></a>存储类型区别</h3><p>对于MyISAM表，尽量使用Char，对于那些经常需要修改而容易形成碎片的myisam和isam数据表就更是如此，它的缺点就是<em>占用磁盘空间</em>； </p>\n<p>对于InnoDB表，尽量使用varchar，因为它的数据行内部存储格式对固定长度的数据行和可变长度的数据行不加区分（所有数据行共用一个表头部分，这个标头部分存放着指向各有关数据列的指针），所以使用char类型不见得会比使用varchar类型好。事实上，因为char类型通常要比varchar类型占用更多的空间，所以从减少空间占用量和减少磁盘i/o的角度，使用varchar类型反而更有利. </p>\n<h3 id=\"实例\"><a href=\"#实例\" class=\"headerlink\" title=\"实例\"></a>实例</h3><p>在 cpanel 中的 <code>eximstats</code> 表用的是 MyISAM表。 <code>email</code> <code>ip</code> <code>domain</code> 等字段用的是char字段。这样统计查询比较快。</p>\n<h2 id=\"命令行查詢\"><a href=\"#命令行查詢\" class=\"headerlink\" title=\"命令行查詢\"></a>命令行查詢</h2><h3 id=\"G-列表顯示具體內容\"><a href=\"#G-列表顯示具體內容\" class=\"headerlink\" title=\"\\G 列表顯示具體內容\"></a>\\G 列表顯示具體內容</h3><figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> * <span class=\"keyword\">from</span> gnc_order <span class=\"keyword\">where</span> order_no <span class=\"keyword\">like</span> <span class=\"string\">'E005244'</span> <span class=\"keyword\">limit</span> <span class=\"number\">1</span> \\G;</span><br></pre></td></tr></table></figure>\n<h2 id=\"导出-amp-導入\"><a href=\"#导出-amp-導入\" class=\"headerlink\" title=\"导出&amp;導入\"></a>导出&amp;導入</h2><h3 id=\"导出整个数据库\"><a href=\"#导出整个数据库\" class=\"headerlink\" title=\"导出整个数据库\"></a>导出整个数据库</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">mysqldump -u 用户名 -p 数据库名 &gt; 导出的文件名</span><br><span class=\"line\">mysqldump -u wcnc -p smgp_apps_wcnc &gt; wcnc.sql</span><br></pre></td></tr></table></figure>\n<h3 id=\"忽略某個表\"><a href=\"#忽略某個表\" class=\"headerlink\" title=\"忽略某個表\"></a>忽略某個表</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">mysqldump -u root -p 数据库名 --ignore-table=数据库名.表名 &gt; db.sql</span><br><span class=\"line\">mysqldump -u root -p 数据库名 --ignore-table=数据库名.表名1 --ignore-table=数据库名.表名2 &gt; db.sql</span><br></pre></td></tr></table></figure>\n<h3 id=\"导出一个表\"><a href=\"#导出一个表\" class=\"headerlink\" title=\"导出一个表\"></a>导出一个表</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">mysqldump -u 用户名 -p 数据库名 表名&gt; 导出的文件名</span><br><span class=\"line\">mysqldump -u wcnc -p smgp_apps_wcnc users&gt; wcnc_users.sql</span><br></pre></td></tr></table></figure>\n<h3 id=\"导出一个数据库结构\"><a href=\"#导出一个数据库结构\" class=\"headerlink\" title=\"导出一个数据库结构\"></a>导出一个数据库结构</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">mysqldump -u wcnc -p -d --add-drop-table smgp_apps_wcnc &gt;d:wcnc_db.sql</span><br><span class=\"line\"><span class=\"meta\">#</span>-d 没有数据 --add-drop-table 在每个create语句之前增加一个drop table</span><br></pre></td></tr></table></figure>\n<h3 id=\"导入数据库\"><a href=\"#导入数据库\" class=\"headerlink\" title=\"导入数据库\"></a>导入数据库</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span>常用source 命令</span><br><span class=\"line\"><span class=\"meta\">#</span>进入mysql数据库控制台，</span><br><span class=\"line\">mysql -u root -p</span><br><span class=\"line\"><span class=\"meta\">mysql&gt;</span>use 数据库</span><br><span class=\"line\"><span class=\"meta\">#</span>然后使用source命令，后面参数为脚本文件(如这里用到的.sql)</span><br><span class=\"line\"><span class=\"meta\">mysql&gt;</span>source d:wcnc_db.sql</span><br></pre></td></tr></table></figure>\n<p>mysql导入建表sql语句时中文注释的乱码问题的解决办法如下：<br>在sql文件开头加上 <code>SET NAMES &#39;utf8&#39;;</code></p>\n<h2 id=\"用戶管理\"><a href=\"#用戶管理\" class=\"headerlink\" title=\"用戶管理\"></a>用戶管理</h2><h3 id=\"創建\"><a href=\"#創建\" class=\"headerlink\" title=\"創建\"></a>創建</h3><figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 創建一個用戶&amp;權限</span></span><br><span class=\"line\"><span class=\"keyword\">GRANT</span> <span class=\"keyword\">ALL</span> <span class=\"keyword\">PRIVILEGES</span> <span class=\"keyword\">ON</span> *.* <span class=\"keyword\">TO</span> <span class=\"string\">'dns2'</span>@<span class=\"string\">'localhost'</span> <span class=\"keyword\">IDENTIFIED</span> <span class=\"keyword\">BY</span> <span class=\"string\">'15***'</span>;</span><br><span class=\"line\"><span class=\"comment\"># 創建一個用戶&amp;權限 (只能訪問dns2資料庫，只允許某個ip訪問)</span></span><br><span class=\"line\"><span class=\"keyword\">GRANT</span> <span class=\"keyword\">ALL</span> <span class=\"keyword\">PRIVILEGES</span> <span class=\"keyword\">ON</span> dns2.* <span class=\"keyword\">TO</span> <span class=\"string\">'dns2'</span>@<span class=\"string\">'119.81.172.50'</span> <span class=\"keyword\">IDENTIFIED</span> <span class=\"keyword\">BY</span> <span class=\"string\">'16******'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 更新權限</span></span><br><span class=\"line\"><span class=\"keyword\">FLUSH</span> <span class=\"keyword\">PRIVILEGES</span>;</span><br></pre></td></tr></table></figure>\n<h3 id=\"修改密碼\"><a href=\"#修改密碼\" class=\"headerlink\" title=\"修改密碼\"></a>修改密碼</h3><figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">password</span> <span class=\"keyword\">for</span> root@localhost = <span class=\"keyword\">password</span>(<span class=\"string\">'16***'</span>)</span><br></pre></td></tr></table></figure>\n<h2 id=\"查看表佔用空間大小\"><a href=\"#查看表佔用空間大小\" class=\"headerlink\" title=\"查看表佔用空間大小\"></a>查看表佔用空間大小</h2><figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#檢查 eximstats 資料庫下所有的表磁盤大小</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> TABLE_NAME, <span class=\"keyword\">round</span>((DATA_LENGTH+INDEX_LENGTH)/<span class=\"number\">1024</span>/<span class=\"number\">1024</span>,<span class=\"number\">2</span>) <span class=\"keyword\">AS</span> Size_MB, TABLE_ROWS <span class=\"keyword\">FROM</span> information_schema.TABLES </span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> TABLE_SCHEMA=<span class=\"string\">'eximstats'</span>;</span><br><span class=\"line\"><span class=\"comment\">#檢查某個表，增加判斷條件</span></span><br><span class=\"line\">AND TABLE_NAME='smtp'</span><br></pre></td></tr></table></figure>\n<h2 id=\"兼容性\"><a href=\"#兼容性\" class=\"headerlink\" title=\"兼容性\"></a>兼容性</h2><p>Mysql執行Sql語句時出現不兼容的問題一般情況下是 默認的 <code>sql-mode</code> 不一樣了。</p>\n<p>詳見 <a href=\"/2018-10/mysql-sql-mode/\">sql-mode</a></p>\n","tags":["mysql"]},{"title":"PHP读取Excel","url":"/2016-12/PHP-Excel/","content":"<figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\">$PHPReader = <span class=\"keyword\">new</span> PHPExcel_Reader_Excel2007();</span><br><span class=\"line\">   <span class=\"keyword\">if</span>(!$PHPReader-&gt;canRead($filePath))&#123;</span><br><span class=\"line\">       $PHPReader = <span class=\"keyword\">new</span> PHPExcel_Reader_Excel5();</span><br><span class=\"line\">       <span class=\"keyword\">if</span>(!$PHPReader-&gt;canRead($filePath))&#123;</span><br><span class=\"line\">           delMyFile($filePath);</span><br><span class=\"line\">           <span class=\"keyword\">echo</span> <span class=\"string\">'上傳文檔錯誤'</span>;</span><br><span class=\"line\">           <span class=\"keyword\">exit</span>;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"comment\">//建立excel对象，此时你即可以通过excel对象读取文件，也可以通过它写入文件</span></span><br><span class=\"line\">   $PHPExcel = $PHPReader-&gt;load($filePath);</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"comment\">/**读取excel文件中的第一个工作表*/</span></span><br><span class=\"line\">   $currentSheet = $PHPExcel-&gt;getSheet(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"comment\">/**取得最大的列号*/</span></span><br><span class=\"line\">   $allColumn = <span class=\"string\">'K'</span>;<span class=\"comment\">// $currentSheet-&gt;getHighestColumn();</span></span><br><span class=\"line\">   <span class=\"comment\">/**取得一共有多少行*/</span></span><br><span class=\"line\">   $allRow = <span class=\"number\">17</span>;<span class=\"comment\">//$currentSheet-&gt;getHighestRow();</span></span><br><span class=\"line\"></span><br><span class=\"line\">   $arr = <span class=\"keyword\">array</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"comment\">//循环读取每个单元格的内容。注意行从1开始，列从A开始</span></span><br><span class=\"line\">   <span class=\"keyword\">for</span>($rowIndex=<span class=\"number\">1</span>; $rowIndex&lt;=$allRow; $rowIndex++)&#123;</span><br><span class=\"line\">       <span class=\"keyword\">for</span>($colIndex=<span class=\"string\">'A'</span>;$colIndex&lt;=$allColumn;$colIndex++)&#123;</span><br><span class=\"line\">           $addr = $colIndex.$rowIndex;</span><br><span class=\"line\">           $cell = $currentSheet-&gt;getCell($addr)-&gt;getValue();</span><br><span class=\"line\">           <span class=\"keyword\">if</span>($cell <span class=\"keyword\">instanceof</span> PHPExcel_RichText)     <span class=\"comment\">//富文本转换字符串</span></span><br><span class=\"line\">               $cell = $cell-&gt;__toString();</span><br><span class=\"line\"></span><br><span class=\"line\">           $arr[$addr] = $cell;</span><br><span class=\"line\"></span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>","tags":["php"]},{"title":"VritualBox 安裝 Ubuntu","url":"/2016-12/VritualBox-Install-Ubuntu/","content":"<p>後來不再使用VirtualBox直接在Windows上使用Cmder+Git</p>\n<h2 id=\"基本安裝\"><a href=\"#基本安裝\" class=\"headerlink\" title=\"基本安裝\"></a>基本安裝</h2><ul>\n<li>检查操作系统 cpu 虚拟化已经打开。</li>\n<li>如果使用无线网络（PCI），必须安装官方驱动 </li>\n</ul>\n<p>创建虚拟主机、安装操作系统</p>\n<h2 id=\"端口映射\"><a href=\"#端口映射\" class=\"headerlink\" title=\"端口映射\"></a>端口映射</h2><p>“设置”》“网络”》“网卡1”》“高级”》“端口转发”添加</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">Apache,    TCP,    127.0.0.1,    80,    ,    80</span><br><span class=\"line\">SSH,    TCP,    127.0.0.1,    2222,    ,    22</span><br><span class=\"line\">Mysql,    TCP,    127.0.0.1,    3306,    ,    3306</span><br></pre></td></tr></table></figure>\n<p>注意</p>\n<p>用xshell链接时，不能用命令行 ssh <a href=\"mailto:root@127.0.0.1\" target=\"_blank\" rel=\"noopener\">root@127.0.0.1</a>:2222 鏈接。 必須新創建一個“会话”</p>\n<h2 id=\"共享文件\"><a href=\"#共享文件\" class=\"headerlink\" title=\"共享文件\"></a>共享文件</h2><ul>\n<li>“设置”》“共享文件夹” 中添加 ‘vagrant’ ‘D:\\Htodcs’ 。 注意 不能勾选开机自动挂载</li>\n<li>开启虚拟主机，“设备”》“安装增强功能”会自动挂载iso到cdrom</li>\n<li>登录到操作页面， 执行</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">#安装相关软件</span><br><span class=\"line\">sudo apt-get install gcc </span><br><span class=\"line\">sudo apt-get install build-essential linux-headers-$(uname -r)</span><br><span class=\"line\">#挂载</span><br><span class=\"line\">sudo mount /dev/cdrom /mnt</span><br><span class=\"line\">#执行</span><br><span class=\"line\">sudo ./VBoxLinuxAdditions.run</span><br><span class=\"line\">mkdir -p /vagrant</span><br><span class=\"line\">mount -t vboxsf vagrant /vagrant</span><br></pre></td></tr></table></figure>\n<h3 id=\"开机自动挂载\"><a href=\"#开机自动挂载\" class=\"headerlink\" title=\"开机自动挂载\"></a>开机自动挂载</h3><h4 id=\"rc-loacl\"><a href=\"#rc-loacl\" class=\"headerlink\" title=\"rc.loacl\"></a>rc.loacl</h4><p>在/etc/rc.loal 加入  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">mount -t vboxsf vagrant /vagrant</span><br></pre></td></tr></table></figure>\n<h4 id=\"crontab\"><a href=\"#crontab\" class=\"headerlink\" title=\"crontab\"></a>crontab</h4><p>一些比较新的系统没有 rc.local 所以使用 crontab <code>@reboot</code> 设定</p>\n<p>在 crontab 中加入：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">@reboot mount -t vboxsf vagrant /vagrant</span><br></pre></td></tr></table></figure>\n<h2 id=\"命令行启动\"><a href=\"#命令行启动\" class=\"headerlink\" title=\"命令行启动\"></a>命令行启动</h2><p>创建 vbox_up.bat<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">cd C:\\Program Files\\Oracle\\VirtualBox</span><br><span class=\"line\">VBoxManage startvm &quot;ubuntu&quot; -type headless</span><br></pre></td></tr></table></figure></p>\n<p>创建 vbox_down.bat<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">cd C:\\Program Files\\Oracle\\VirtualBox</span><br><span class=\"line\">VBoxManage controlvm &quot;ubuntu&quot; acpipowerbutton</span><br></pre></td></tr></table></figure></p>\n<p>并将这两个文件加入到 环境变量 PATH 中。 这样执行 vbox_up 开启虚拟主机 。vbox_down 关闭虚拟主机<br>说明 “ubuntu” 必须有 引号， ubuntu 是创建的虚拟主机的名称</p>\n<h2 id=\"Ubuntu-設定\"><a href=\"#Ubuntu-設定\" class=\"headerlink\" title=\"Ubuntu 設定\"></a>Ubuntu 設定</h2><h3 id=\"Apache设定\"><a href=\"#Apache设定\" class=\"headerlink\" title=\"Apache设定\"></a>Apache设定</h3><p>由于使用 virtualbox 共享文件，有时候出现缓存。</p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">### Apache 配置添加:</span></span><br><span class=\"line\">EnableSendfile off</span><br></pre></td></tr></table></figure>\n<p>在 /etc/apache2/sites-available/000-default.conf 中加入</p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><span class=\"line\">&lt;Directory \"/vagrant\"&gt;  </span><br><span class=\"line\">\tOptions Indexes FollowSymLinks  </span><br><span class=\"line\">\tAllowOverride All  </span><br><span class=\"line\">\tRequire all granted  </span><br><span class=\"line\">&lt;/Directory&gt;</span><br></pre></td></tr></table></figure>\n<p>啟動mod_rewrite，執行以下命令 <code>sudo a2enmod rewrite</code></p>\n<h3 id=\"PHP设定\"><a href=\"#PHP设定\" class=\"headerlink\" title=\"PHP设定\"></a>PHP设定</h3><p>安装&amp;开启 mcrypt</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo apt-get install php-mcrypt</span><br><span class=\"line\">sudo phpenmod mcrypt</span><br></pre></td></tr></table></figure>\n<h3 id=\"Mysql\"><a href=\"#Mysql\" class=\"headerlink\" title=\"Mysql\"></a>Mysql</h3><p>必须要设定权限，以及允许远程访问。 my.cnf 修改：<br><figure class=\"highlight ini\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">bind-address</span>  = <span class=\"number\">0.0</span>.<span class=\"number\">0.0</span></span><br></pre></td></tr></table></figure></p>\n"},{"title":"sed命令","url":"/2016-12/linux-sed/","content":"<p>sed 是一种编辑器，它一次处理一行内容。</p>\n<h2 id=\"Usage\"><a href=\"#Usage\" class=\"headerlink\" title=\"Usage\"></a>Usage</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sed [OPTION]... &#123;script-only-if-no-other-script&#125; [input-file]...</span><br></pre></td></tr></table></figure>\n<p>以下是常用到的实例说明。</p>\n<h2 id=\"打印\"><a href=\"#打印\" class=\"headerlink\" title=\"打印\"></a>打印</h2><p>读取某行並打印</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">//读取277000 到 302006 行</span><br><span class=\"line\">sed -n '277000,302006p' exim_mainlog-20160904</span><br></pre></td></tr></table></figure>\n<ul>\n<li>-n 使用安静(silent)模式。</li>\n<li>p  列印，亦即将某个选择的资料印出。通常 p 会与参数 sed -n 一起运作～</li>\n</ul>\n<h2 id=\"替換\"><a href=\"#替換\" class=\"headerlink\" title=\"替換\"></a>替換</h2><p>替换，如果没有g标记，则只有每行第一个匹配的test被替换成mytest。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span>在整行范围内把test替换为mytest。</span><br><span class=\"line\">sed -i 's/test/mytest/g' example</span><br></pre></td></tr></table></figure>\n<ul>\n<li>-i 直接修改读取的文件内容，而不是由屏幕输出</li>\n</ul>\n<p>通過grep搜索然後替換</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sed -i 's/*-1//g' `grep \"*-1\" -rl .`</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sed -i 's/*-1//g' `grep -rl \"*-1\" --include=\"*.php\" .`</span><br><span class=\"line\">sed -i 's/*-1//g' `grep -rl \"*-1\" --include=\"*.htm\" .`</span><br></pre></td></tr></table></figure>\n<ul>\n<li>–include=”*.php” 只搜素包含php結尾的文檔</li>\n</ul>\n<h2 id=\"刪除\"><a href=\"#刪除\" class=\"headerlink\" title=\"刪除\"></a>刪除</h2><p>刪除 含有 <code>TCP_IN Blocked</code> 的行</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sed -i '/TCP_IN Blocked/d' messages</span><br></pre></td></tr></table></figure>\n","tags":["linux"]},{"title":"exigrep命令","url":"/2016-12/exigrep/","content":"<h2 id=\"說明\"><a href=\"#說明\" class=\"headerlink\" title=\"說明\"></a>說明</h2><p>exigrep 命令， 罗列相关日志</p>\n<p>必须安装 exim4</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">exigrep chris.su@zytronic.co.uk /var/log/exim_mainlog</span><br></pre></td></tr></table></figure>\n<p>列出log日志中所有关于 <a href=\"mailto:chris.su@zytronic.co.uk\" target=\"_blank\" rel=\"noopener\">chris.su@zytronic.co.uk</a> 的完成mail记录</p>\n","tags":["exim"]},{"title":"国别码 Country Code","url":"/2016-12/country-code/","content":"<h2 id=\"兩位國別碼-ISO-3166\"><a href=\"#兩位國別碼-ISO-3166\" class=\"headerlink\" title=\"兩位國別碼 (ISO 3166)\"></a>兩位國別碼 (ISO 3166)</h2><p>詳細的查看:</p>\n<ul>\n<li><a href=\"https://zh.wikipedia.org/wiki/%E5%9C%8B%E5%AE%B6%E5%9C%B0%E5%8D%80%E4%BB%A3%E7%A2%BC\" target=\"_blank\" rel=\"noopener\">国家地区代码</a></li>\n<li><a href=\"https://zh.wikipedia.org/wiki/ISO_3166-1\" target=\"_blank\" rel=\"noopener\">ISO 3166</a></li>\n</ul>\n<p>英國為 GB , 并為其保留 UK</p>\n","tags":["iso"]},{"title":"windows10","url":"/2016-12/windows10/","content":"<h1 id=\"下載最新的ISO\"><a href=\"#下載最新的ISO\" class=\"headerlink\" title=\"下載最新的ISO\"></a>下載最新的ISO</h1><p>打開頁面 <a href=\"https://www.microsoft.com/zh-cn/software-download/windows10\" target=\"_blank\" rel=\"noopener\">https://www.microsoft.com/zh-cn/software-download/windows10</a></p>\n<p>直接回檢查到使用的是win10， 提示更新程序 Windows10Upgrade9252.exe 下載</p>\n<h2 id=\"Windows-選擇默認程序\"><a href=\"#Windows-選擇默認程序\" class=\"headerlink\" title=\"Windows 選擇默認程序\"></a>Windows 選擇默認程序</h2><p>今天Windows 10的选择默认程序失效了。<br>只能切换到老版的默认程序设定。 打开一下路径。 在“我的电脑”，右键，属性， 中找。</p>\n<blockquote>\n<p>控制面板\\所有控制面板项\\默认程序\\设置默认程序</p>\n</blockquote>\n<p>然后再这里设定才可以。</p>\n<h2 id=\"windows-命令行启动-mysql\"><a href=\"#windows-命令行启动-mysql\" class=\"headerlink\" title=\"windows 命令行启动 mysql\"></a>windows 命令行启动 mysql</h2><p>必须以管理员身份运行命令行<br><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">net start mysql</span><br></pre></td></tr></table></figure></p>\n","tags":["windows"]},{"title":"Firefox瀏覽器","url":"/2016-12/firefox/","content":"<h1 id=\"Tehems\"><a href=\"#Tehems\" class=\"headerlink\" title=\"Tehems\"></a>Tehems</h1><ul>\n<li>esafox</li>\n<li>have a fox dream</li>\n</ul>\n"},{"title":"Chrome瀏覽器","url":"/2016-12/chrome/","content":"<p>基本上都是， </p>\n<p>默认字符：  雅黑<br>衬线字：  宋体<br>无衬线字：  雅黑<br>等宽字体：  Consolas </p>\n<p>默认16号字，最小12号字</p>\n"},{"title":"GIT 常用命令","url":"/2016-12/git/","content":"<h2 id=\"設置\"><a href=\"#設置\" class=\"headerlink\" title=\"設置\"></a>設置</h2><p>设定 用户名 邮箱</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git config --global user.name Howard</span><br><span class=\"line\">git config --global user.email xxxx@gmail.com</span><br></pre></td></tr></table></figure>\n<p>设定代理</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git config --global http.proxy 'socks5://127.0.0.1:1080'</span><br><span class=\"line\">git config --global https.proxy 'socks5://127.0.0.1:1080'</span><br></pre></td></tr></table></figure>\n<h2 id=\"常用設定\"><a href=\"#常用設定\" class=\"headerlink\" title=\"常用設定\"></a>常用設定</h2><p>參照 <a href=\"https://github.com/tiimgreen/github-cheat-sheet/blob/master/README.zh-cn.md#git-配置\" target=\"_blank\" rel=\"noopener\">https://github.com/tiimgreen/github-cheat-sheet/blob/master/README.zh-cn.md#git-配置</a></p>\n<h2 id=\"针对现有目录，-添加到远程\"><a href=\"#针对现有目录，-添加到远程\" class=\"headerlink\" title=\"针对现有目录， 添加到远程\"></a>针对现有目录， 添加到远程</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git init</span><br><span class=\"line\">git add .</span><br><span class=\"line\">git commit</span><br></pre></td></tr></table></figure>\n<p>必須保證全部已經提交</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git remote add origin https://xxxx@bitbucket.org/intergroup/xxxx.com.git</span><br><span class=\"line\"><span class=\"meta\">#</span> pushes up the repo and its refs for the first time</span><br><span class=\"line\">git push -u origin --all </span><br><span class=\"line\"><span class=\"meta\">#</span> pushes up any tags</span><br><span class=\"line\">git push origin --tags</span><br></pre></td></tr></table></figure>\n<h2 id=\"查看log\"><a href=\"#查看log\" class=\"headerlink\" title=\"查看log\"></a>查看log</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git log --name-status -n 5  # 顯示前5條 新增、修改、删除的文件清单</span><br><span class=\"line\"></span><br><span class=\"line\">git log --name-only --pretty=format:\"%cd %s\" -6 # 顯示前6個提交，值顯示文檔，日期，說明</span><br><span class=\"line\">git diff --name-only HEAD~6 HEAD # 顯示前6個提交， 修改的所有文檔</span><br></pre></td></tr></table></figure>\n<ul>\n<li>name-only 仅在提交信息后显示已修改的文件清单。</li>\n<li>name-status 显示新增、修改、删除的文件清单。</li>\n</ul>\n<h2 id=\"撤销-commit\"><a href=\"#撤销-commit\" class=\"headerlink\" title=\"撤销 commit\"></a>撤销 commit</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git log # 找到想要撤销到版本的id</span><br><span class=\"line\">git reset id # 完成Commit命令的撤销，但是不对代码修改进行撤销</span><br><span class=\"line\">git reset –hard id #完成撤销,同时将代码恢复到前一commit_id 对应的版本</span><br></pre></td></tr></table></figure>\n<h2 id=\"常用命令\"><a href=\"#常用命令\" class=\"headerlink\" title=\"常用命令\"></a>常用命令</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git status  # 查看當前狀態</span><br><span class=\"line\">git add ... # 添加暫存</span><br><span class=\"line\">git commit -a # 提交</span><br><span class=\"line\">git push # 上傳到網絡</span><br><span class=\"line\">git log -p -2 # 查看日誌</span><br><span class=\"line\">git log --oneline -2 # 查看日誌</span><br><span class=\"line\">git log --oneline index.php # 查看某個文檔</span><br><span class=\"line\">git show 5510ed8 #查看某個文檔詳細內容</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git commit -m \"add distributed\" # 提交 後面必須是雙引號</span><br><span class=\"line\">git branch dev # 創建分支</span><br><span class=\"line\">git checkout master # 切換分支</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git merge &lt;name&gt; #合并某分支到当前分支</span><br><span class=\"line\">git branch -d &lt;name&gt; #删除分支</span><br><span class=\"line\">git branch #查看分支</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git push # 提交</span><br><span class=\"line\">git pull # 下載并合併</span><br><span class=\"line\">git fetch # 只下載</span><br></pre></td></tr></table></figure>\n<h2 id=\"gitignore-失效解决办法\"><a href=\"#gitignore-失效解决办法\" class=\"headerlink\" title=\".gitignore 失效解决办法\"></a>.gitignore 失效解决办法</h2><p>.gitignore 只能忽略那些原来没有被track的文件</p>\n<ul>\n<li>问题：.gitignore中已经标明忽略的文件目录下的文件，在git push的时候还会出现在push的目录中。</li>\n<li>原因：在git忽略目录中，新建的文件在git中会有缓存，如果某些文件已经被纳入了版本管理中，就算是在.gitignore中已经声明了忽略路径也是不起作用的</li>\n<li>解决：这时候我们就应该先把本地缓存删除，然后再进行git的push，这样就不会出现忽略的文件了。</li>\n</ul>\n<p>相關命令：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git rm -r --cached . #删除本地缓存</span><br><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m 'init'</span><br></pre></td></tr></table></figure>","tags":["git"]},{"title":"NCFTP 命令行ftp工具","url":"/2016-12/ncftp/","content":"<p>找了好久的命令行FTP</p>\n<p>链接到Server</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">ncftp -u newdemo -p demo123qwe newdemo.080.net</span><br></pre></td></tr></table></figure>\n<p>列为标签，（提示保存名称， 密码）</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">bookmark</span><br></pre></td></tr></table></figure>\n<p>设定</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">set control-timeout 900</span><br></pre></td></tr></table></figure>\n<p>链接 bookmark</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">ncftp name080</span><br></pre></td></tr></table></figure>\n","tags":["tools"]},{"title":"cput 命令行同步上傳工具","url":"/2016-12/cput/","content":"<h2 id=\"cput\"><a href=\"#cput\" class=\"headerlink\" title=\"cput\"></a>cput</h2><p>一個簡單的上傳小工具。（只能上傳，只能上傳同步目錄的文檔）</p>\n<p>一個shell腳本，使用curl命令，通過ftp協議快捷的上傳一個或多個文檔<br>shell腳本執行， bat腳本調用（最多9個文檔）</p>\n<h3 id=\"系統要求\"><a href=\"#系統要求\" class=\"headerlink\" title=\"系統要求\"></a>系統要求</h3><ul>\n<li>git</li>\n<li>cmder</li>\n</ul>\n<h2 id=\"設定\"><a href=\"#設定\" class=\"headerlink\" title=\"設定\"></a>設定</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git config git-ftp.user username</span><br><span class=\"line\">git config git-ftp.url myweb.com</span><br><span class=\"line\">git config git-ftp.password xxx</span><br><span class=\"line\">git config git-ftp.remote-root \"~/public_html/\"</span><br></pre></td></tr></table></figure>\n<h2 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">cput appliction\\views\\front\\en\\index.php</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span>子目錄下上傳多個</span><br><span class=\"line\">cd appliction\\</span><br><span class=\"line\">cput views\\front\\en\\index.php views\\front\\en\\layout\\top\\top.php</span><br></pre></td></tr></table></figure>\n<h2 id=\"源代碼\"><a href=\"#源代碼\" class=\"headerlink\" title=\"源代碼\"></a>源代碼</h2><h3 id=\"cput-bat\"><a href=\"#cput-bat\" class=\"headerlink\" title=\"cput.bat\"></a>cput.bat</h3><figure class=\"highlight bat\"><table><tr><td class=\"code\"><pre><span class=\"line\">@sh cput.sh %<span class=\"number\">1</span> %<span class=\"number\">2</span> %<span class=\"number\">3</span> %<span class=\"number\">4</span> %<span class=\"number\">5</span> %<span class=\"number\">6</span> %<span class=\"number\">7</span> %<span class=\"number\">8</span> %<span class=\"number\">9</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"cput-sh\"><a href=\"#cput-sh\" class=\"headerlink\" title=\"cput.sh\"></a>cput.sh</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span>!/bin/sh</span><br><span class=\"line\">NOW_PATH=\"$(pwd)\"</span><br><span class=\"line\">REMOTE_PATH=''</span><br><span class=\"line\">GIT_ROOT_PATH=\"$(git rev-parse --show-toplevel)\"</span><br><span class=\"line\">FTP_URL=\"$(git config --get \"git-ftp.url\")\"</span><br><span class=\"line\">FTP_USER=\"$(git config --get \"git-ftp.user\")\"</span><br><span class=\"line\">FTP_PASSWORD=\"$(git config --get \"git-ftp.password\")\"</span><br><span class=\"line\">FTP_REMOTE_ROOT=\"$(git config --get \"git-ftp.remote-root\")\"</span><br><span class=\"line\"><span class=\"meta\">#</span> base check</span><br><span class=\"line\">if [ \"$FTP_USER\" = \"\" ];then</span><br><span class=\"line\">    exit 1</span><br><span class=\"line\">fi</span><br><span class=\"line\"><span class=\"meta\">#</span> format REMOTE_ROOT</span><br><span class=\"line\"><span class=\"meta\">#</span> '~/public_html' to 'public_html/'</span><br><span class=\"line\">if [ \"$&#123;FTP_REMOTE_ROOT:0:2&#125;\" == \"~/\" ];then</span><br><span class=\"line\">    FTP_REMOTE_ROOT=$&#123;FTP_REMOTE_ROOT:1&#125;</span><br><span class=\"line\">fi</span><br><span class=\"line\">if [ \"$&#123;FTP_REMOTE_ROOT:0:1&#125;\" == \"/\" ];then</span><br><span class=\"line\">    FTP_REMOTE_ROOT=$&#123;FTP_REMOTE_ROOT:1&#125;</span><br><span class=\"line\">fi</span><br><span class=\"line\">if ! echo \"$FTP_REMOTE_ROOT\" | egrep -q \"/$\";then</span><br><span class=\"line\">    FTP_REMOTE_ROOT=\"$FTP_REMOTE_ROOT/\"</span><br><span class=\"line\">fi</span><br><span class=\"line\"><span class=\"meta\">#</span> check path</span><br><span class=\"line\"><span class=\"meta\">#</span> if in subdir fix the REMOTE_PATH, ex: 'application/'</span><br><span class=\"line\">GIT_ROOT_PATH=\"$&#123;GIT_ROOT_PATH//\\\\/\\/&#125;\"</span><br><span class=\"line\">NOW_PATH=\"$&#123;NOW_PATH//\\\\/\\/&#125;\"</span><br><span class=\"line\">GIT_ROOT_PATH=$&#123;GIT_ROOT_PATH:2&#125;</span><br><span class=\"line\">NOW_PATH=$&#123;NOW_PATH:2&#125;</span><br><span class=\"line\">if [ \"$GIT_ROOT_PATH\"x != \"$NOW_PATH\"x ];then </span><br><span class=\"line\">    STR_LEN=$&#123;#GIT_ROOT_PATH&#125;</span><br><span class=\"line\">    REMOTE_PATH=\"$&#123;NOW_PATH:STR_LEN&#125;/\"</span><br><span class=\"line\">    REMOTE_PATH=$&#123;REMOTE_PATH:1&#125;</span><br><span class=\"line\">fi</span><br><span class=\"line\"><span class=\"meta\">#</span> set curl args</span><br><span class=\"line\">declare -a CURL_ARGS</span><br><span class=\"line\">CURL_ARGS=(--globoff)</span><br><span class=\"line\"><span class=\"meta\">#</span>CURL_ARGS+=(-#)</span><br><span class=\"line\">CURL_ARGS+=(-u \"$&#123;FTP_USER&#125;:$&#123;FTP_PASSWORD&#125;\")</span><br><span class=\"line\">CURL_ARGS+=(--ftp-create-dirs)</span><br><span class=\"line\">upload_file() &#123;</span><br><span class=\"line\">    SRC_FILE=\"$&#123;1//\\\\/\\/&#125;\"</span><br><span class=\"line\">    DEST_FILE=\"$SRC_FILE\"</span><br><span class=\"line\">    CURL_ARGS+=(-T \"$&#123;SRC_FILE&#125;\")</span><br><span class=\"line\">    CURL_ARGS+=(\"ftp://$FTP_URL/$&#123;FTP_REMOTE_ROOT&#125;$&#123;REMOTE_PATH&#125;$&#123;DEST_FILE&#125;\")</span><br><span class=\"line\">    echo \"Upload ... ftp://$FTP_URL/$&#123;FTP_REMOTE_ROOT&#125;$&#123;REMOTE_PATH&#125;$&#123;DEST_FILE&#125;\"</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">#</span> run </span><br><span class=\"line\">echo \"---------\"</span><br><span class=\"line\">INT_I=0</span><br><span class=\"line\">for var in $*</span><br><span class=\"line\">do</span><br><span class=\"line\">    # check file exit</span><br><span class=\"line\">    if [ -f \"$var\" ];then</span><br><span class=\"line\">        upload_file $var</span><br><span class=\"line\">        INT_I+=1</span><br><span class=\"line\">    fi</span><br><span class=\"line\">done</span><br><span class=\"line\">echo \"---------\"</span><br><span class=\"line\">if [ $INT_I -gt 0 ];then</span><br><span class=\"line\">    #echo \"$&#123;CURL_ARGS[@]&#125;\"</span><br><span class=\"line\">    curl \"$&#123;CURL_ARGS[@]&#125;\"</span><br><span class=\"line\">else</span><br><span class=\"line\">    echo \"do nothing.\"</span><br><span class=\"line\">fi</span><br></pre></td></tr></table></figure>","tags":["tools"]},{"title":"SSH KEY 登錄","url":"/2016-12/ssh-key-login/","content":"<h2 id=\"SSH\"><a href=\"#SSH\" class=\"headerlink\" title=\"SSH\"></a>SSH</h2><p>key生成的方法</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa # 在 ~/.ssh 目录下生成  id_rsa,id_rsa.pub</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span> 将 id_rsa.pub 加入到 远端主机 ~/.ssh/authorized_keys\t</span><br><span class=\"line\">cat id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span>修改权限！！ 必须修改远端主机上 文档的权限， 否则会报错！</span><br><span class=\"line\">chmod 700 .ssh</span><br><span class=\"line\">chmod 600 authorized_keys</span><br></pre></td></tr></table></figure>\n<h3 id=\"copy-id\"><a href=\"#copy-id\" class=\"headerlink\" title=\"copy id\"></a>copy id</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">ssh-copy-id -i  ~/.ssh/id_rsa.pub  root@IP</span><br></pre></td></tr></table></figure>\n<h3 id=\"配置（連接時長）\"><a href=\"#配置（連接時長）\" class=\"headerlink\" title=\"配置（連接時長）\"></a>配置（連接時長）</h3><p>本地端（客戶端）設定 在 <code>~\\.ssh\\config</code> 中添加。 实际目录是 <code>C:\\Users\\Howard\\.ssh</code></p>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><span class=\"line\">Host *</span><br><span class=\"line\">    ServerAliveInterval 60</span><br></pre></td></tr></table></figure>\n<p>每60秒会发一个KeepAlive请求</p>\n<h3 id=\"登錄時顯示信息信息\"><a href=\"#登錄時顯示信息信息\" class=\"headerlink\" title=\"登錄時顯示信息信息\"></a>登錄時顯示信息信息</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">ssh -v root@diana.poikl.com</span><br></pre></td></tr></table></figure>\n<h3 id=\"參考\"><a href=\"#參考\" class=\"headerlink\" title=\"參考\"></a>參考</h3><ul>\n<li><a href=\"http://www.cnblogs.com/dudu/archive/2013/02/07/ssh-write-failed-broken-pipe.html\" target=\"_blank\" rel=\"noopener\">http://www.cnblogs.com/dudu/archive/2013/02/07/ssh-write-failed-broken-pipe.html</a></li>\n<li><a href=\"http://www.cyberciti.biz/faq/create-ssh-config-file-on-linux-unix/\" target=\"_blank\" rel=\"noopener\">http://www.cyberciti.biz/faq/create-ssh-config-file-on-linux-unix/</a></li>\n</ul>\n<h2 id=\"plink\"><a href=\"#plink\" class=\"headerlink\" title=\"plink\"></a>plink</h2><p>plink.exe使用private key 時，必須把通過ssh生成的private key通過 PuTTYgen.exe轉換一下</p>\n<ul>\n<li>打開 puttygen</li>\n<li>選擇  Conversions-&gt;Import key 導入 private key</li>\n<li>點擊按鈕 Save private key</li>\n</ul>\n<h2 id=\"scp\"><a href=\"#scp\" class=\"headerlink\" title=\"scp\"></a>scp</h2><p>使用private key 登錄。 </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">scp -C -i ~/.ssh/howard_rsa root@abc.com:/root/phpcs.phar ./</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>-i ~/.ssh/as_rsa</code> 對應的private key</li>\n<li><code>-C</code> 加速網絡傳輸（壓縮傳輸？）</li>\n</ul>\n","tags":["ssh"]},{"title":"Ruby Symbol（冒號）","url":"/2016-12/ruby-symbol/","content":"<p>經常看到下面</p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"code\"><pre><span class=\"line\">my_hash = [<span class=\"symbol\">:foo=&gt;</span><span class=\"number\">100</span>, <span class=\"symbol\">:aa=&gt;<span class=\"string\">\"sss\"</span></span>]</span><br></pre></td></tr></table></figure>\n<p>:foo 就是 Symbol 是一個唯一標示。 用作性能提升， 因為ruby中 string 是一個對象。 </p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">:foo</span></span><br><span class=\"line\"><span class=\"symbol\">:<span class=\"string\">\"foo\"</span></span></span><br><span class=\"line\"><span class=\"comment\">#效果一樣</span></span><br></pre></td></tr></table></figure>\n<p>還有一種情況是 快速定義</p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SomeClass</span>  </span></span><br><span class=\"line\">  <span class=\"keyword\">attr_accessor</span> <span class=\"symbol\">:whatever</span>  </span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br></pre></td></tr></table></figure>\n<p>等價于</p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SomeClass</span>  </span></span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">whatever</span>  </span></span><br><span class=\"line\">    @whatever  </span><br><span class=\"line\">  <span class=\"keyword\">end</span>  </span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">whatever=</span><span class=\"params\">(val)</span></span>  </span><br><span class=\"line\">    @whatever = val  </span><br><span class=\"line\">  <span class=\"keyword\">end</span>  </span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br></pre></td></tr></table></figure>","tags":["ruby"]},{"title":"HeidiSQL Mysql管理工具","url":"/2016-12/HeidiSQL/","content":"<h2 id=\"發現HeidiSQL\"><a href=\"#發現HeidiSQL\" class=\"headerlink\" title=\"發現HeidiSQL\"></a>發現HeidiSQL</h2><p>最近有安裝MariaDB(開源的，MySQL的替代產品)。發現自帶一個管理MySQL的軟件HeidiSQL。抱著試試看的想法， 使用了一下。開源，可以連接多個MySQL Server， SSH隧道登錄，保存密碼等，操作還不錯。</p>\n<h2 id=\"调整字體\"><a href=\"#调整字體\" class=\"headerlink\" title=\"调整字體\"></a>调整字體</h2><p>默認的字體以及字體大小不好看，我用的是Windows。 界面設定為【微軟雅黑】12號字。SQL編輯器設定為【Consoals】12號字。</p>\n<h3 id=\"做FontLink\"><a href=\"#做FontLink\" class=\"headerlink\" title=\"做FontLink\"></a>做FontLink</h3><p>但是显示中文的时候，中文字体比较丑。只能做 <a href=\"/2016-12/windows-fontlink\">FontLink</a></p>\n<h2 id=\"SSH隧道\"><a href=\"#SSH隧道\" class=\"headerlink\" title=\"SSH隧道\"></a>SSH隧道</h2><h3 id=\"SSH隧道登錄\"><a href=\"#SSH隧道登錄\" class=\"headerlink\" title=\"SSH隧道登錄\"></a>SSH隧道登錄</h3><p>要自己下載plink.exe，有提供下載地址。</p>\n<p>關於【私鑰文檔】，用linux命令下 ssh生成的普通文檔不行。 必須通過PuTTYgen.exe轉換一下。操作步驟如下：</p>\n<ol>\n<li>打開 puttygen</li>\n<li>選擇  Conversions-&gt;Import key 導入 private key</li>\n<li>點擊按鈕 Save private key</li>\n</ol>\n<h3 id=\"SSH隧道登錄，private-key-密码\"><a href=\"#SSH隧道登錄，private-key-密码\" class=\"headerlink\" title=\"SSH隧道登錄，private key 密码\"></a>SSH隧道登錄，private key 密码</h3><p>如果 private key 含有密码， 则在原本输入密码的地方输入 <code>private key 密码</code> 即可。替换掉原有账号对应的密码。</p>\n<h3 id=\"SSH隧道登錄，掉線問題\"><a href=\"#SSH隧道登錄，掉線問題\" class=\"headerlink\" title=\"SSH隧道登錄，掉線問題\"></a>SSH隧道登錄，掉線問題</h3><p>打開一段時間后沒有訪問會自動掉線的問題很麻煩。自動嘗試重新連接會很慢。解決辦法：<br>在【SSH隧道】旁邊的【高級】選項卡中，【ping間隔秒數】設定為60。（默認0，表示不進行呼叫）。這樣每隔60秒就自動和server hello 一下。就不會斷掉了。</p>\n<h3 id=\"plink-链接错误\"><a href=\"#plink-链接错误\" class=\"headerlink\" title=\"plink 链接错误\"></a>plink 链接错误</h3><p>用命令行测试 plink 命令提示<code>The server&#39;s host key is not cached in the registry ......</code>。 需要手动执行 <code>putty.exe</code> 然后添加 或更新一下 <code>ssh-ed25519 key</code> 。</p>\n","tags":["mysql"]}]